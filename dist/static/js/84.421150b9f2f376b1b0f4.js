webpackJsonp([84],{XPye:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("lHA8"),s=i.n(a),l=i("c/Tr"),n=i.n(l),o=i("Gu7T"),r=i.n(o),c=i("Dd8w"),d=i.n(c),u=i("BO1k"),h=i.n(u),m=i("ssT3"),p=i("oAV5"),v="/plateform/a/store/condition/search",f="/plateform/a/mall/storeLogistics/listPage",g="/plateform/a/mall/storeLogistics/batchUpdateDel",b="/plateform/a/mall/storeLogistics/batchUpdateSort",y="/plateform/a/mall/storeLogistics/batchUpdateDcTime",C={data:function(){return{idDisabled:!1,loading:!1,pageNum:1,pageSize:10,total:0,searchContent:{storeNo:"",dcOpenTime:"",dcCloseTime:"",logisticsCompanyId:""},tableData:[],checkedList:[],storeOptions:[],logisticsCompanyOptList:[{label:"全部",value:""},{label:"门店自配送",value:1001},{label:"美团配送",value:1002},{label:"达达配送",value:1003},{label:"顺丰同城配送",value:1004}],sortNumDialogVisible:!1,sortNum:"",sortNumOptList:[{label:"1",value:1},{label:"2",value:2},{label:"3",value:3}],dcTimeDialogVisible:!1,dcOpenTime:"",dcCloseTime:""}},created:function(){this.getStoreList()},mounted:function(){var e=m.a.get("searchContentBlxDelivery");this.$route.meta.keepAlive&&e&&(this.pageNum=e.pageNum,this.searchContent=e.searchContent),this.doSearchHandel(),m.a.remove("searchContentBlxDelivery")},methods:{goAddPage:function(){this.$router.push("/blx_delivery/add")},getStoreList:function(){var e=this;this.$http.post(v).then(function(t){if(0!==t.code)throw new Error(t.msg);if(t.data&&t.data.length){var i=[],a=!0,s=!1,l=void 0;try{for(var n,o=h()(t.data);!(a=(n=o.next()).done);a=!0){var r=n.value,c={value:r.storeNo,label:r.storeNo+"-"+r.storeName};i.push(c)}}catch(e){s=!0,l=e}finally{try{!a&&o.return&&o.return()}finally{if(s)throw l}}e.storeOptions=i}else e.storeOptions=[]}).catch(function(e){console.log("提示(获取门店列表):",e.message)})},changeSize:function(e){this.pageSize=e,this.doSearchHandel()},changeCurrent:function(e){this.pageNum=e,this.doSearchHandel()},doSearchHandel:function(e){var t=this;this.checkedList=[],this.loading=!0,!0===e&&(this.pageNum=1),this.$http.post(f,d()({},this.searchContent,{pageNum:this.pageNum,pageSize:this.pageSize})).then(function(e){if(t.loading=!1,0!==e.code)throw new Error(e.msg);if(e.data&&e.data.result&&e.data.result.length){var i=!0,a=!1,s=void 0;try{for(var l,n=h()(e.data.result);!(i=(l=n.next()).done);i=!0){var o=l.value;o.uniqueId=""+o.id+o.storeNo}}catch(e){a=!0,s=e}finally{try{!i&&n.return&&n.return()}finally{if(a)throw s}}t.tableData=e.data.result}else t.tableData=[];t.total=e.data.total}).catch(function(e){t.loading=!1,t.$notify.error({title:"提示(配送管理):",message:e.message})})},logisticsCompanyIdFormater:function(e,t,i,a){return 1001==i?"门店自配送":1002==i?"美团配送":1003==i?"达达配送":1004==i?"顺丰同城配送":"--"},editItem:function(e){var t={pageNum:this.pageNum,searchContent:this.searchContent};m.a.set("searchContentBlxDelivery",t),this.$router.push("/blx_delivery/edit/"+e.id+"/"+e.storeNo)},deleteItem:function(e){var t=this,i=[];i.push(e.id),this.$confirm("您确定要删除所选门店的配送公司吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$http.post(g,{ids:i,isDeleted:1}).then(function(e){if(0===e.code)return t.$message.success("删除成功"),void t.doSearchHandel();throw new Error(e.msg)}).catch(function(e){t.$notify.error({title:"提示",message:e.message})})}).catch(function(){})},handleSelect:function(e,t){var i={},a=[];if(p.l(t.uniqueId,this.checkedList))this.checkedList=p.q("uniqueId",t.uniqueId,this.checkedList);else{a.push(t);var s=[].concat(a,r()(this.checkedList));this.checkedList=s.reduceRight(function(e,t){return!i[t.uniqueId]&&(i[t.uniqueId]=e.push(t)),e},[])}},handleSelectAll:function(e){var t={};if(e.length>0){var i=!0,a=!1,s=void 0;try{for(var l,n=h()(e);!(i=(l=n.next()).done);i=!0){var o=l.value;this.checkedList.push(o)}}catch(e){a=!0,s=e}finally{try{!i&&n.return&&n.return()}finally{if(a)throw s}}this.checkedList=this.checkedList.reduceRight(function(e,i){return!t[i.uniqueId]&&(t[i.uniqueId]=e.push(i)),e},[])}else{var r=[],c=!0,d=!1,u=void 0;try{for(var m,v=h()(this.tableData);!(c=(m=v.next()).done);c=!0){var f=m.value;r.push(f)}}catch(e){d=!0,u=e}finally{try{!c&&v.return&&v.return()}finally{if(d)throw u}}var g=p.i(this.checkedList,r,"uniqueId");this.checkedList=g&&g.length>0?g:[]}},batchUpdateSort:function(){var e=[],t=!0,i=!1,a=void 0;try{for(var l,o=h()(this.checkedList);!(t=(l=o.next()).done);t=!0){var r=l.value;e.push(r.logisticsCompanyId)}}catch(e){i=!0,a=e}finally{try{!t&&o.return&&o.return()}finally{if(i)throw a}}1===n()(new s.a(e)).length?this.sortNumDialogVisible=!0:this.$notify.warning({title:"温馨提示",message:"请选择同一配送公司的不同门店批量设置"})},batchUpdateSortHandel:function(){var e=this;if(this.sortNum){var t=[],i=!0,a=!1,s=void 0;try{for(var l,n=h()(this.checkedList);!(i=(l=n.next()).done);i=!0){var o=l.value;t.push(o.id)}}catch(e){a=!0,s=e}finally{try{!i&&n.return&&n.return()}finally{if(a)throw s}}this.idDisabled=!0,this.$http.post(b,{ids:t,sortNum:this.sortNum}).then(function(t){if(setTimeout(function(){e.idDisabled=!1},800),0===t.code)return e.doSearchHandel(),void(e.sortNumDialogVisible=!1);throw new Error(t.msg)}).catch(function(t){e.idDisabled=!1,e.$notify.error({title:"提示:",message:t.message})})}else this.$message("请选择派单优先级")},batchUpdateDcTime:function(){var e=[],t=!0,i=!1,a=void 0;try{for(var l,o=h()(this.checkedList);!(t=(l=o.next()).done);t=!0){var r=l.value;e.push(r.logisticsCompanyId)}}catch(e){i=!0,a=e}finally{try{!t&&o.return&&o.return()}finally{if(i)throw a}}1===n()(new s.a(e)).length?this.dcTimeDialogVisible=!0:this.$notify.warning({title:"温馨提示",message:"请选择同一配送公司的不同门店批量设置"})},batchUpdateDcTimeHandel:function(){var e=this;if(this.dcOpenTime&&this.dcCloseTime)if(p.b(this.dcCloseTime)<=p.b(this.dcOpenTime))this.$message("最晚可接单时间不能早于最早可接单时间");else{var t=[],i=!0,a=!1,s=void 0;try{for(var l,n=h()(this.checkedList);!(i=(l=n.next()).done);i=!0){var o=l.value;t.push(o.id)}}catch(e){a=!0,s=e}finally{try{!i&&n.return&&n.return()}finally{if(a)throw s}}this.idDisabled=!0,this.$http.post(y,{ids:t,dcOpenTime:this.dcOpenTime,dcCloseTime:this.dcCloseTime}).then(function(t){if(setTimeout(function(){e.idDisabled=!1},800),0===t.code)return e.doSearchHandel(),void(e.dcTimeDialogVisible=!1);throw new Error(t.msg)}).catch(function(t){e.idDisabled=!1,e.$notify.error({title:"提示:",message:t.message})})}else this.$message("请选择立即送时间")}},beforeRouteLeave:function(e,t,i){t.meta.keepAlive=!1,i()}},_={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{staticClass:"handel-search-wraper"},[i("div",{staticClass:"handel-wraper"},[i("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-plus"},on:{click:e.goAddPage}},[e._v("添加门店配送")])],1),e._v(" "),i("hr",{staticClass:"s-slip"}),e._v(" "),i("div",{staticClass:"search-form-wraper"},[i("el-form",{attrs:{model:e.searchContent,"label-position":"top"}},[i("el-form-item",{attrs:{label:"门店"}},[i("el-select",{staticClass:"search-input",attrs:{filterable:"",placeholder:"请选择门店",clearable:"",size:"small"},on:{change:function(t){return e.doSearchHandel(!0)}},model:{value:e.searchContent.storeNo,callback:function(t){e.$set(e.searchContent,"storeNo",t)},expression:"searchContent.storeNo"}},e._l(e.storeOptions,function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),i("el-form-item",{attrs:{label:"配送公司"}},[i("el-select",{staticClass:"search-input",attrs:{placeholder:"请选择配送公司",size:"small"},on:{change:function(t){return e.doSearchHandel(!0)}},model:{value:e.searchContent.logisticsCompanyId,callback:function(t){e.$set(e.searchContent,"logisticsCompanyId",t)},expression:"searchContent.logisticsCompanyId"}},e._l(e.logisticsCompanyOptList,function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),i("el-form-item",{attrs:{label:"立即送时间"}},[i("el-time-picker",{staticClass:"search-input-small-width",attrs:{format:"HH:mm:ss","value-format":"HH:mm:ss",size:"small",clearable:"",placeholder:"开始时间"},on:{change:function(t){return e.doSearchHandel(!0)}},model:{value:e.searchContent.dcOpenTime,callback:function(t){e.$set(e.searchContent,"dcOpenTime",t)},expression:"searchContent.dcOpenTime"}}),e._v("\n          -\n          "),i("el-time-picker",{staticClass:"search-input-small-width",attrs:{format:"HH:mm:ss","value-format":"HH:mm:ss",size:"small",clearable:"",placeholder:"结束时间"},on:{change:function(t){return e.doSearchHandel(!0)}},model:{value:e.searchContent.dcCloseTime,callback:function(t){e.$set(e.searchContent,"dcCloseTime",t)},expression:"searchContent.dcCloseTime"}})],1),e._v(" "),i("el-form-item",[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.doSearchHandel(!0)}}},[e._v("搜索")])],1)],1)],1)]),e._v(" "),i("div",{staticClass:"table-wraper"},[i("div",{staticClass:"batch-handel-w"},[i("el-button",{staticClass:"sup-mini",attrs:{size:"mini",icon:"el-icon-edit",disabled:0===e.checkedList.length},on:{click:e.batchUpdateSort}},[e._v("修改优先级")]),e._v(" "),i("el-button",{staticClass:"sup-mini",attrs:{size:"mini",icon:"el-icon-edit",disabled:0===e.checkedList.length},on:{click:e.batchUpdateDcTime}},[e._v("修改立即送时间")])],1),e._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticClass:"fixed-height",staticStyle:{width:"100%"},attrs:{data:e.tableData,"empty-text":"没有查询到您想要的数据",size:"small"},on:{select:e.handleSelect,"select-all":e.handleSelectAll}},[i("el-table-column",{attrs:{type:"selection",align:"center"}}),e._v(" "),i("el-table-column",{attrs:{label:"门店信息","min-width":"200px"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",[i("p",[e._v("\n              "+e._s(t.row.storeNo)+"-"+e._s(t.row.storeName)+"\n            ")]),e._v(" "),i("p",{staticClass:"mh-address"},[e._v(e._s(t.row.storeAddr))])])]}}])}),e._v(" "),i("el-table-column",{attrs:{prop:"logisticsCompanyId",label:"配送公司","min-width":"120px",formatter:e.logisticsCompanyIdFormater}}),e._v(" "),i("el-table-column",{attrs:{prop:"sortNum",label:"派单优先级","min-width":"120px"}}),e._v(" "),i("el-table-column",{attrs:{label:"立即送时间","min-width":"140px"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",[e._v("\n            "+e._s(t.row.dcOpenTime||"-")+"-"+e._s(t.row.dcCloseTime||"-")+"\n          ")])]}}])}),e._v(" "),i("el-table-column",{attrs:{align:"center",fixed:"right",label:"操作",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",[i("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-edit"},on:{click:function(i){return e.editItem(t.row)}}},[e._v("编辑")])],1),e._v(" "),i("div",[i("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-delete"},on:{click:function(i){return e.deleteItem(t.row)}}},[e._v("删除")])],1)]}}])})],1),e._v(" "),e.total>0?i("el-pagination",{staticClass:"tc mt20",attrs:{background:"","current-page":e.pageNum,"page-sizes":[10,50,100,150,200],layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.changeSize,"current-change":e.changeCurrent,"update:currentPage":function(t){e.pageNum=t},"update:current-page":function(t){e.pageNum=t}}}):e._e()],1),e._v(" "),i("el-dialog",{attrs:{title:"批量修改优先级",visible:e.sortNumDialogVisible,width:"440px"},on:{"update:visible":function(t){e.sortNumDialogVisible=t}}},[i("div",[i("el-form",[i("el-form",{ref:"form",attrs:{"label-width":"100px"}},[i("el-form-item",{attrs:{label:"派单优先级",required:""}},[i("el-select",{staticClass:"search-date-picker",attrs:{placeholder:"请选择派单优先级",size:"small",clearable:""},model:{value:e.sortNum,callback:function(t){e.sortNum=t},expression:"sortNum"}},e._l(e.sortNumOptList,function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1)],1),e._v(" "),i("div",[i("p",[e._v("注意：")]),e._v(" "),i("p",[e._v("1、请选择同一配送公司的不同门店批量设置；")]),e._v(" "),i("p",[e._v("2、选择优先级保存后，会批量将门店其他配送公司优先级相应调整。")])])],1),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"mini"},on:{click:function(t){e.sortNumDialogVisible=!1}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary",size:"mini",disabled:e.idDisabled,loading:e.idDisabled},on:{click:e.batchUpdateSortHandel}},[e._v("确 定")])],1)]),e._v(" "),i("el-dialog",{attrs:{title:"批量修改立即送时间",visible:e.dcTimeDialogVisible,width:"440px"},on:{"update:visible":function(t){e.dcTimeDialogVisible=t}}},[i("div",[i("el-form",[i("el-form",{ref:"form",attrs:{"label-width":"100px"}},[i("el-form-item",{attrs:{label:"立即送时间",required:""}},[i("el-time-picker",{staticClass:"search-input-small-width",attrs:{format:"HH:mm:ss","value-format":"HH:mm:ss",size:"small",clearable:"",placeholder:"最早时间"},model:{value:e.dcOpenTime,callback:function(t){e.dcOpenTime=t},expression:"dcOpenTime"}}),e._v("\n            -\n            "),i("el-time-picker",{staticClass:"search-input-small-width",attrs:{format:"HH:mm:ss","value-format":"HH:mm:ss",size:"small",clearable:"",placeholder:"最晚时间"},model:{value:e.dcCloseTime,callback:function(t){e.dcCloseTime=t},expression:"dcCloseTime"}})],1)],1)],1),e._v(" "),i("div",[i("p",[e._v("注意：")]),e._v(" "),i("p",[e._v("1、请选择同一配送公司的不同门店批量设置；")]),e._v(" "),i("p",[e._v("2、设置保存后，会批量将门店的配送公司立即送时间改为当前时间。")])])],1),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"mini"},on:{click:function(t){e.dcTimeDialogVisible=!1}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary",size:"mini",disabled:e.idDisabled,loading:e.idDisabled},on:{click:e.batchUpdateDcTimeHandel}},[e._v("确 定")])],1)])],1)},staticRenderFns:[]};var w=i("VU/8")(C,_,!1,function(e){i("ZMql")},null,null);t.default=w.exports},ZMql:function(e,t){}});
//# sourceMappingURL=84.421150b9f2f376b1b0f4.js.map