webpackJsonp([33],{"hT/F":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("Dd8w"),n=a.n(s),o=a("t0/o"),i=a("segh"),r=a("snIt"),l={mixins:[a("4WFj").a],data:function(){return{loading:!1,userPermission:[],moduleId:"/quote_mgt",isAdvanced:!1,pageNum:1,pageSize:10,total:0,regionOptions:[],categoryList:[],searchContent:{storeGroupNo:"",goodsCategoryNo:"",goodsNo:"",vendorNo:"",paperNo:"",state:"",type:"",createTimeStart:"",createTimeEnd:""},initData:{storeGroupNo:"",goodsCategoryNo:"",goodsNo:"",vendorNo:"",paperNo:"",state:"",type:"",createTimeStart:"",createTimeEnd:""},vendors:[],statusOptions:r.a.statusOptions,typeOptions:r.a.typeOptions,tableData:[],columns:[{title:"报价单号",dataIndex:"paperNo",minWidth:120,ellipsis:!0},{title:"区域",dataIndex:"storeGroupName",minWidth:60,ellipsis:!0},{title:"商品分类",dataIndex:"goodsCategoryName",minWidth:80,ellipsis:!0},{title:"类型",dataIndex:"typeName",minWidth:80,ellipsis:!0},{title:"供应商",dataIndex:"vendorName",minWidth:140,ellipsis:!0},{title:"报价周期",dataIndex:"validTimeRange",minWidth:140,ellipsis:!0},{title:"状态",dataIndex:"stateName",minWidth:80,ellipsis:!0},{title:"报价商品",dataIndex:"quotationGoods",minWidth:80,ellipsis:!0},{title:"制单时间",dataIndex:"createTime",minWidth:110,ellipsis:!0},{title:"制单人",dataIndex:"createUserName",minWidth:80,ellipsis:!0},{title:"提交时间",dataIndex:"confirmTime",minWidth:110,ellipsis:!0},{title:"提交人",dataIndex:"confirmUserName",minWidth:80,ellipsis:!0},{title:"操作",fixed:"right",width:80,operation:[{label:"查看",icon:"el-icon-view",clickFunc:this.goDetailPage}]}]}},created:function(){this._getAreas(),this._getCategoryList(),this.doSearchHandle(!0),this.userPermission=this.$store.state.common.userPermissionMap[this.moduleId]},methods:{areaChange:function(){this.vendors=[],this._getVendors()},_getVendors:function(){var e=this;this.$http.post(i.a.getQuotableVendors,{storeGroupNo:this.searchContent.storeGroupNo}).then(function(t){t&&0===t.code?e.vendors=(t.data||[]).map(function(e){return e.label=e.vendorName,e.value=e.vendorNo,e}):e.$tip.notify(t.msg,"error")}).catch(function(t){e.$tip.notify(t.message,"error")})},taggleAdvanced:function(){this.isAdvanced=!this.isAdvanced},doSearchHandle:function(e){var t=this;if(e&&(this.pageNum=1),this.searchContent.createTimeStart&&this.searchContent.createTimeEnd&&this.searchContent.createTimeStart>this.searchContent.createTimeEnd)this.$tip.message("结束时间不可早于开始时间","warning");else{var a=n()({vendorNos:this.searchContent.vendorNo?[this.searchContent.vendorNo]:null,pageNum:this.pageNum,pageSize:this.pageSize},this.searchContent,{createTimeStart:this.searchContent.createTimeStart?this.searchContent.createTimeStart+" 00:00:00":null,createTimeEnd:this.searchContent.createTimeEnd?this.searchContent.createTimeEnd+" 23:59:59":null});this.loading=!0,this.$http.post(i.a.getQuoteList,n()({},a)).then(function(e){if(t.loading=!1,e&&0===e.code){var a=e.data&&e.data.result&&e.data.result.length&&e.data.result.map(function(e){return e.validTimeRange=e.startTime+" 至 "+e.endTime,e});t.tableData=a,t.total=e.data&&e.data.total}else t.$tip.notify(e.msg,"error")}).catch(function(e){t.loading=!1,t.$tip.notify(e.message,"error")})}},_getAreas:function(){var e=this;this.$http.get(o.a.areaStoreGroupList).then(function(t){t&&0===t.code?e.regionOptions=t.data||[]:e.$tip.notify(t.msg,"error")}).catch(function(t){e.$tip.notify(t.message,"error")})},_getCategoryList:function(){var e=this;this.$http.get(i.a.categoryList,{parentId:0}).then(function(t){t&&0===t.code?e.categoryList=t.data||[]:e.$tip.notify(t.msg,"error")}).catch(function(t){e.$tip.notify(t.message,"error")})},goDetailPage:function(e){this.$router.push("/quote_mgt/"+e.paperNo)},addQuote:function(){this.$router.push("/quote_mgt/add")},changeSize:function(e){this.pageSize=e,this.doSearchHandle()},changeCurrent:function(e){this.pageNum=e,this.doSearchHandle()}}},c={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.userPermission&&e.userPermission.includes("新增")?a("div",{staticClass:"handel-wraper nopt"},[a("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-plus"},on:{click:e.addQuote}},[e._v("新增报价单")])],1):e._e(),e._v(" "),a("div",{staticClass:"handel-search-wraper"},[a("div",{staticClass:"search-form-wraper"},[a("el-form",{attrs:{model:e.searchContent,"label-position":"top"}},[a("el-form-item",{attrs:{label:"区域"}},[a("el-select",{staticClass:"search-input",attrs:{placeholder:"选择区域","collapse-tags":"",size:"small",clearable:""},on:{change:e.areaChange},model:{value:e.searchContent.storeGroupNo,callback:function(t){e.$set(e.searchContent,"storeGroupNo",t)},expression:"searchContent.storeGroupNo"}},e._l(e.regionOptions,function(e){return a("el-option",{key:e.storeGroupNo,attrs:{label:e.storeGroupName,value:e.storeGroupNo}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"商品分类"}},[a("el-select",{staticClass:"search-input",attrs:{placeholder:"选择分类","collapse-tags":"",clearable:"",size:"small"},model:{value:e.searchContent.goodsCategoryNo,callback:function(t){e.$set(e.searchContent,"goodsCategoryNo",t)},expression:"searchContent.goodsCategoryNo"}},e._l(e.categoryList,function(e){return a("el-option",{key:e.categoryNo,attrs:{label:e.categoryName,value:e.categoryNo}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"报价单号"}},[a("el-input",{staticClass:"search-input",attrs:{size:"small",clearable:"",placeholder:"报价单号"},model:{value:e.searchContent.paperNo,callback:function(t){e.$set(e.searchContent,"paperNo","string"==typeof t?t.trim():t)},expression:"searchContent.paperNo"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"供应商"}},[a("el-select",{staticClass:"search-input",attrs:{placeholder:"选择供应商","collapse-tags":"",clearable:"",size:"small"},model:{value:e.searchContent.vendorNo,callback:function(t){e.$set(e.searchContent,"vendorNo",t)},expression:"searchContent.vendorNo"}},e._l(e.vendors,function(e){return a("el-option",{key:e.vendorNo,attrs:{label:e.vendorName,value:e.vendorNo}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"商品编码"}},[a("el-input",{staticClass:"search-input",attrs:{size:"small",placeholder:"请输入商品",clearable:""},model:{value:e.searchContent.goodsNo,callback:function(t){e.$set(e.searchContent,"goodsNo","string"==typeof t?t.trim():t)},expression:"searchContent.goodsNo"}})],1),e._v(" "),e.isAdvanced?a("el-form-item",{attrs:{label:"状态"}},[a("el-select",{staticClass:"search-input",attrs:{placeholder:"状态",filterable:"",clearable:"",size:"small"},model:{value:e.searchContent.state,callback:function(t){e.$set(e.searchContent,"state",t)},expression:"searchContent.state"}},e._l(e.statusOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1):e._e(),e._v(" "),e.isAdvanced?a("el-form-item",{attrs:{label:"单据类型"}},[a("el-select",{staticClass:"search-input",attrs:{placeholder:"单据类型",filterable:"",clearable:"",size:"small"},model:{value:e.searchContent.type,callback:function(t){e.$set(e.searchContent,"type",t)},expression:"searchContent.type"}},e._l(e.typeOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1):e._e(),e._v(" "),e.isAdvanced?a("el-form-item",{attrs:{label:"制单起始日期"}},[a("el-date-picker",{staticClass:"search-input",attrs:{clearable:"",type:"date",placeholder:"制单起始日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",size:"small"},model:{value:e.searchContent.createTimeStart,callback:function(t){e.$set(e.searchContent,"createTimeStart",t)},expression:"searchContent.createTimeStart"}})],1):e._e(),e._v(" "),e.isAdvanced?a("el-form-item",{attrs:{label:"制单终止日期"}},[a("el-date-picker",{staticClass:"search-input",attrs:{clearable:"",type:"date",placeholder:"制单终止日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",size:"small"},model:{value:e.searchContent.createTimeEnd,callback:function(t){e.$set(e.searchContent,"createTimeEnd",t)},expression:"searchContent.createTimeEnd"}})],1):e._e(),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.doSearchHandle(!0)}}},[e._v("搜索")])],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"",size:"mini"},on:{click:e.taggleAdvanced}},[e._v(e._s(e.isAdvanced?"收起高级查询":"高级查询"))])],1)],1),e._v(" "),a("div",{staticClass:"table-wraper"},[a("bl-table",{attrs:{loading:e.loading,border:!1,dataSource:e.tableData,columns:e.columns}}),e._v(" "),a("bl-pagination",{attrs:{showPagination:e.tableData.length>0,pageNum:e.pageNum,total:e.total},on:{"size-change":e.changeSize,"current-change":e.changeCurrent}})],1)],1)])])},staticRenderFns:[]},d=a("VU/8")(l,c,!1,null,null,null);t.default=d.exports}});
//# sourceMappingURL=33.8a4ea0f083cb1eeb12af.1615898974438.js.map