webpackJsonp([7],{"+H5h":function(e,t){},MZx3:function(e,t){},YDHL:function(e,t,i){"use strict";var n=i("Dd8w"),o=i.n(n),a=i("Gu7T"),s=i.n(a),l=i("t0/o"),c=i("Hixw"),r=i("oAV5"),d=i("YSQh"),m={model:{prop:"info",event:"change"},props:{cantEdit:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},info:{type:Object,default:{lineId:"",invoiceTypeCode:"",invoiceDate:"",invoiceCode:"",invoiceNo:"",netAmount:"",taxCode:"",taxAmount:""}},invoiceTypeCodeOptions:{type:Array,default:[]},taxCodeOptions:{type:Array,default:[]}},data:function(){return{invoiceTypeCode:1,taxCode:["0"],invoiceDate:"",invoiceCode:"",invoiceNo:"",netAmount:"",taxAmount:""}},computed:{amount:function(){return 1==this.info.taxCode.length&&this.info.netAmount?"0"==this.info.taxCode[0]?(this.info.taxAmount=0,Object(r.c)(this.info.netAmount)):(this.info.taxAmount=Object(r.c)(this.info.netAmount*+this.info.taxCode[0]/100),Object(r.c)((1e4*+this.info.netAmount+1e4*this.info.taxAmount)/1e4)):this.info.taxCode.length>1&&this.info.netAmount?Object(r.c)((1e4*+this.info.taxAmount+1e4*+this.info.netAmount)/1e4):(this.info.netAmount||(this.info.taxAmount=""),"--")}},methods:{deleteLine:function(){var e=this;this.$confirm("确定要删除该发票吗","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$emit("deleteInvoiceLine",e.info.lineId)})},handleChange:function(e){this.$emit("change",o()({},this.info,{amount:"--"===this.amount?0:this.amount}))}}},u={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-row",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"invoice-form",attrs:{gutter:6}},[i("el-form",{attrs:{"label-width":"40px",size:"small","label-position":"top"}},[i("el-col",{attrs:{span:1}},[i("el-button",{staticClass:"fs28 mt28",attrs:{size:"mini",icon:"el-icon-delete",circle:""},on:{click:e.deleteLine}})],1),e._v(" "),i("el-col",{attrs:{span:3}},[i("el-form-item",{attrs:{label:"发票种类:"}},[i("el-select",{attrs:{disabled:e.cantEdit,placeholder:"请选择"},on:{change:e.handleChange},model:{value:e.info.invoiceTypeCode,callback:function(t){e.$set(e.info,"invoiceTypeCode",t)},expression:"info.invoiceTypeCode"}},e._l(e.invoiceTypeCodeOptions,function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),i("el-col",{attrs:{span:3}},[i("el-form-item",{attrs:{label:"发票日期:"}},[i("el-date-picker",{staticStyle:{width:"100%"},attrs:{disabled:e.cantEdit,type:"date",placeholder:"发票日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd"},on:{change:e.handleChange},model:{value:e.info.invoiceDate,callback:function(t){e.$set(e.info,"invoiceDate",t)},expression:"info.invoiceDate"}})],1)],1),e._v(" "),i("el-col",{attrs:{span:3}},[i("el-form-item",{attrs:{label:"发票代码:"}},[i("el-input",{attrs:{disabled:e.cantEdit,placeholder:"发票代码",clearable:""},on:{change:e.handleChange},model:{value:e.info.invoiceCode,callback:function(t){e.$set(e.info,"invoiceCode",t)},expression:"info.invoiceCode"}})],1)],1),e._v(" "),i("el-col",{attrs:{span:3}},[i("el-form-item",{attrs:{label:"发票号:"}},[i("el-input",{attrs:{disabled:e.cantEdit,placeholder:"发票号",clearable:""},on:{change:e.handleChange},model:{value:e.info.invoiceNo,callback:function(t){e.$set(e.info,"invoiceNo",t)},expression:"info.invoiceNo"}})],1)],1),e._v(" "),i("el-col",{attrs:{span:3}},[i("el-form-item",{attrs:{label:"发票金额:"}},[i("el-input",{attrs:{disabled:e.cantEdit,type:"number",clearable:"",placeholder:"不含税金额"},on:{change:e.handleChange},model:{value:e.info.netAmount,callback:function(t){e.$set(e.info,"netAmount",t)},expression:"info.netAmount"}})],1)],1),e._v(" "),i("el-col",{attrs:{span:3}},[i("el-form-item",{attrs:{label:"税率:"}},[i("el-select",{attrs:{disabled:e.cantEdit,multiple:"","collapse-tags":"",placeholder:"请选择"},on:{change:e.handleChange},model:{value:e.info.taxCode,callback:function(t){e.$set(e.info,"taxCode",t)},expression:"info.taxCode"}},e._l(e.taxCodeOptions,function(e){return i("el-option",{key:e.value,attrs:{label:e.value,value:e.value}})}),1)],1)],1),e._v(" "),i("el-col",{attrs:{span:3}},[i("el-form-item",{attrs:{label:"税额:"}},[i("el-input",{attrs:{disabled:e.cantEdit,type:"number",clearable:"",placeholder:"税额"},on:{change:e.handleChange},model:{value:e.info.taxAmount,callback:function(t){e.$set(e.info,"taxAmount",t)},expression:"info.taxAmount"}})],1)],1),e._v(" "),i("el-col",{attrs:{span:2}},[i("el-form-item",{attrs:{label:"价税合计:"}},[e._v("\n          "+e._s(e.amount)+"\n        ")])],1)],1)],1)},staticRenderFns:[]};var v=i("VU/8")(m,u,!1,function(e){i("MZx3")},"data-v-eb74c71a",null).exports,h=/((^[1-9]\d*)|^0)(\.\d{0,2}){0,1}$/,p={components:{"file-upload":d.a,"invoice-line":v},data:function(){return{type:"",dialogVisible:!1,settlementNo:"",startDate:"",endDate:"",statusNameForVendor:"",invoiceAmount:"",invoicedAmount:"",invoiceTypeCodeOptions:[],taxCodeOptions:[],loading:!1,cantEdit:!1,id:"",invoiceTypeCode:1,taxCode:["0"],invoiceDate:"",invoiceCode:"",invoiceNo:"",netAmount:"",taxAmount:"",filePaths:[],invoiceBatchNumber:"",previewFileList:[],invoiceDetailList:[],totalAmount:"",uploadStyleObj:{maxHeight:"120px",overflow:"auto"}}},methods:{addLine:function(){var e=this.invoiceDetailList;e&&e.length>=20?this.$tip.message("最多可开20张发票","warning"):e.push({lineId:Date.now(),invoiceTypeCode:"",invoiceDate:"",invoiceCode:"",invoiceNo:"",netAmount:"",taxCode:"",taxAmount:""})},deleteInvoiceLine:function(e){var t=this;this.invoiceDetailList.some(function(i,n){if(e===i.lineId)return t.invoiceDetailList.splice(n,1),!0})},handleChange:function(e){var t=this.invoiceDetailList.findIndex(function(t){return t.lineId===e.lineId});this.invoiceDetailList.splice(t,1,e),this.calTotalAmount()},calTotalAmount:function(){var e=(this.invoiceDetailList||[]).reduce(function(e,t){return{amount:(e.amount||0)+(t.amount||0)}},{amount:0}).amount;this.totalAmount=Object(r.c)(e)},setDefaultMsg:function(e){this.getCommonCodes(),this.dialogVisible=!0,this.settlementNo=e.settlementNo,this.startDate=e.startDate,this.endDate=e.endDate,this.statusNameForVendor=e.statusNameForVendor,this.invoiceAmount=e.invoiceAmount,this.invoicedAmount=e.invoicedAmount,this.cantEdit=e.cantEdit||!1,this.id=e.invoiceId,this.invoiceBatchNumber=e.invoiceBatchNumber||"",this.invoiceDetailList=e.invoiceDetailList||[],this.filePaths=e.filePaths,this.previewFileList=e.filePaths,this.settlement=e.settlement,this.type=e.type,this.calTotalAmount()},getCommonCodes:function(){var e=this;this.$http.post(l.a.listByCommonCodes,["TAX","InvoiceType"]).then(function(t){if(0===t.code)return e.invoiceTypeCodeOptions=t.data&&t.data.InvoiceType&&t.data.InvoiceType.length?t.data.InvoiceType.map(function(e){return{id:e.id,value:+e.code,label:e.value}}):[],void(e.taxCodeOptions=t.data&&t.data.TAX&&t.data.TAX.length?t.data.TAX.map(function(e){return{id:e.id,value:e.value,label:e.value}}):[]);throw new Error(t.msg)}).catch(function(e){console.log("【发票种类和税率】:",e.message)})},handleCancel:function(){var e=this;this.$confirm("取消操作不保存页面任何数据，是否确定取消？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.dialogVisible=!1})},checkLine:function(e){if(e.invoiceDate)if(e.invoiceCode)if(e.invoiceNo)if(e.netAmount||0===e.netAmount)if(h.test(Math.abs(e.netAmount)))if(e.taxAmount||0===e.taxAmount)if(h.test(Math.abs(e.taxAmount))){if(!(Object(r.c)(parseFloat(e.totalAmount))+parseFloat(Object(r.c)(e.invoicedAmount))>Object(r.c)(parseFloat(e.invoiceAmount))))return!0;this.$tip.message("开票金额不可超过应开票金额","warning")}else this.$tip.message("税额是小数保留小数点后2位","warning");else this.$tip.message("请输入税额","warning");else this.$tip.message("发票（不含税）金额是小数保留小数点后2位","warning");else this.$tip.message("请输入发票（不含税）金额","warning");else this.$tip.message("请输入发票号","warning");else this.$tip.message("请输入发票代码","warning");else this.$tip.message("请选择发票日期","warning")},handleSubmit:function(){var e=this,t=this.invoiceDetailList;if(t&&t.length){for(var i=0;i<t.length;i++)if(!this.checkLine(t[i]))return;if(this.totalAmount>this.invoiceAmount-this.invoicedAmount)this.$tip.message("发票金额不可大于待开金额","warning");else{t=t.map(function(e){return{invoiceCode:e.invoiceCode,invoiceDate:e.invoiceDate,invoiceNumber:e.invoiceNo,invoiceTypeCode:e.invoiceTypeCode,inTaxs:e.taxCode.join(","),invoiceMoney:e.amount,taxMoney:e.taxAmount,noTaxMoney:e.netAmount}}),this.loading=!0;var n="",a={},l=this.filePaths&&this.filePaths.length?this.filePaths:[];"edit"===this.type?(n=c.a.editInvoice,a={filePaths:[].concat(s()(l)),invoiceDetailList:t,accountName:this.settlement.accountName,accountSet:this.settlement.accountSet,settlementNumbers:this.settlementNo,supplierName:this.settlement.supplierName,batchNumber:this.invoiceBatchNumber,supplierNumber:this.settlement.supplierNumber}):(a={filePaths:[].concat(s()(l)),settlementNumbers:this.settlementNo,batchNumber:this.invoiceBatchNumber,invoiceDetailList:t},n=c.a.addInvoice),this.$http.post(n,o()({},a)).then(function(t){if(e.loading=!1,0===t.code)return e.$tip.message("提交成功，等待本来鲜财务人员审核！","success"),e.dialogVisible=!1,void e.$emit("parentsHandel");throw new Error(t.msg)}).catch(function(t){e.loading=!1,e.$tip.notify(t.message||"","error","系统提示")})}}else this.$tip.message("发票信息不可为空","warning")},resetHandle:function(){this.invoiceTypeCode=1,this.taxCode=["0"],this.invoiceDate="",this.invoiceCode="",this.invoiceNo="",this.netAmount="",this.taxAmount="",this.filePaths=[]},getInvoiceMsg:function(e){var t=this;this.loading=!0,this.$http.post(c.a.invoiceDetails+"/"+e).then(function(e){if(t.loading=!1,0!==e.code)throw new Error(e.msg);if(e.data){e.data.invoiceMoney&&e.data.invoiceMoney;t.previewFileList=e.data.invoiceFiles&&e.data.invoiceFiles.length?e.data.invoiceFiles:[],t.invoiceTypeCode=e.data.inoviceType||"",t.invoiceDate=e.data.invoiceTimeDate||"",t.invoiceCode=e.data.invoiceCode||"",t.invoiceNo=e.data.invoiceNumber||"",t.taxCode=e.data.inTax&&e.data.inTax.split(","),t.netAmount=e.data.noTaxMoney,t.taxAmount=e.data.taxMoney}}).catch(function(e){t.loading=!1,t.$tip.notify(e.message||"","error","系统提示")})},setFileList:function(e){var t=e.filesList;e.path;this.filePaths=t}}},f={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{attrs:{title:"发票",visible:e.dialogVisible,width:"1080px","close-on-click-modal":!1,"destroy-on-close":!0,"show-close":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("el-row",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"title-box"},[i("el-col",{attrs:{span:8}},[e._v("结算单号："+e._s(e.settlementNo))]),e._v(" "),i("el-col",{attrs:{span:8}},[e._v("账期："+e._s(e.startDate)+"至"+e._s(e.endDate))]),e._v(" "),i("el-col",{attrs:{span:8}},[e._v("状态："+e._s(e.statusNameForVendor))]),e._v(" "),i("el-col",{attrs:{span:8}},[e._v("应开票金额：￥"+e._s(e.invoiceAmount))]),e._v(" "),i("el-col",{attrs:{span:8}},[e._v("已开票金额：￥"+e._s(e.invoicedAmount))]),e._v(" "),i("el-col",{attrs:{span:8}},[e._v("待开票：￥"+e._s(e.invoiceAmount-e.invoicedAmount))])],1),e._v(" "),i("el-row",{staticClass:"operation-box"},[i("el-button",{attrs:{type:"primary"},on:{click:e.addLine}},[e._v("添加发票")])],1),e._v(" "),i("div",{staticClass:"el-dialog-div"},[e.invoiceDetailList.length?e._l(e.invoiceDetailList,function(t,n){return i("invoice-line",{key:n,attrs:{cantEdit:e.cantEdit,loading:e.loading,info:t,invoiceTypeCodeOptions:e.invoiceTypeCodeOptions,taxCodeOptions:e.taxCodeOptions},on:{deleteInvoiceLine:e.deleteInvoiceLine,change:e.handleChange}})}):e._e()],2),e._v(" "),i("el-row",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"invoice-total"},[i("el-form",[i("el-col",{attrs:{span:24}},[i("el-form-item",{attrs:{label:"总金额:"}},[e._v("\n          ￥"+e._s(e.totalAmount)+"\n        ")])],1),e._v(" "),i("el-col",{attrs:{span:24}},[i("el-form-item",{attrs:{label:"附件:"}},[i("file-upload",{ref:"fileUpload",attrs:{previewFileList:e.previewFileList,fileAspectType:["jpg","doc","png","docx","pdf","jpeg"],maxFilesNum:5,styleObj:e.uploadStyleObj,tipText:"限上传5张图片或PDF，单张不可超20MB"},on:{"files-change":e.setFileList}})],1)],1)],1)],1),e._v(" "),i("span",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"mini"},on:{click:e.handleCancel}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary",size:"mini",disabled:e.cantEdit},on:{click:e.handleSubmit}},[e._v("确 定")])],1)],1)},staticRenderFns:[]};var g=i("VU/8")(p,f,!1,function(e){i("+H5h")},"data-v-045027ff",null);t.a=g.exports},"bl/J":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i("WorT"),o=i("4WFj"),a=i("Hixw"),s=i("oAV5"),l=i("YDHL"),c=i("8uth"),r={mixins:[n.a,o.a],components:{"invoice-dialog":l.a},computed:{disabledInvoice:function(){return 2!==this.settlement.status},invoiceVoDis:function(){return 0==this.invoiceVoList.length}},data:function(){return{settlementNo:this.$route.params.settlementNo||"",loading:!1,settlement:{},ioOrderTotalMoney:"",chargeAmount:"",activeTabName:"first",reconciliationColumns:[{title:"序号",dataIndex:"index",width:60},{title:"订单编号",width:160,dataIndex:"reserveField1",router:!0,newJump:function(e){return"/reconciliation/detail/detail/"+e.warehouseNumber+"/"+e.oldIoOrderNumber+"/"+(e.isDispute?"110":"001")}},{title:"进/退货单号",dataIndex:"oldIoOrderNumber",minWidth:160},{title:"类型",dataIndex:"ioTypeName",minWidth:100},{title:"结算金额",dataIndex:"totalMoney",minWidth:100},{title:"应结算日",minWidth:110,dataIndex:"inOutTimeStr"}],reconciliationVoList:[],chargeColumns:[{title:"序号",dataIndex:"index",width:60},{title:"单号",dataIndex:"feeNumber",minWidth:120},{title:"费用类型",dataIndex:"feeName",minWidth:90},{title:"收付类型",dataIndex:"settlementTypeName",minWidth:90},{title:"费用金额",dataIndex:"feeMoney",minWidth:90},{title:"类型",dataIndex:"taxReceipt",minWidth:90},{title:"应结算日",dataIndex:"happenTime",minWidth:100},{title:"备注",dataIndex:"remarks",minWidth:120}],chargeVoList:[],goodsColumns:[{title:"序号",dataIndex:"index",width:60},{title:"商品名称",dataIndex:"productName",minWidth:100},{title:"商品编码",dataIndex:"productNumber",minWidth:90},{title:"货号",dataIndex:"vendorGoodsNo",minWidth:90},{title:"商品条码",dataIndex:"barcode",minWidth:110},{title:"规格",dataIndex:"invoiceCreateMan",minWidth:80},{title:"平均单价",dataIndex:"inPrice",minWidth:90},{title:"税率",dataIndex:"inTax",minWidth:80},{title:"数量",dataIndex:"num",minWidth:80},{title:"参考结算金额",dataIndex:"productMoney",minWidth:100}],goodsList:[],storeColumns:[{title:"序号",dataIndex:"index",width:60},{title:"门店",minWidth:170,dataIndex:"storeNo"},{title:"参考结算金额",minWidth:100,dataIndex:"productMoney"}],storeList:[],invoiceColumns:[{title:"序号",dataIndex:"index",width:60},{title:"种类",dataIndex:"inoviceTypeName",minWidth:90},{title:"开票人",dataIndex:"createUserName",minWidth:80},{title:"开票日期",dataIndex:"invoiceTimeDate",minWidth:100},{title:"发票代码",dataIndex:"invoiceCode",minWidth:80},{title:"发票号",dataIndex:"invoiceNumber",minWidth:100},{title:"价税合计",dataIndex:"invoiceMoney",minWidth:100},{title:"金额（未税）",dataIndex:"noTaxMoney",minWidth:120},{title:"税额",dataIndex:"taxMoney",minWidth:90},{title:"税率汇总信息",minWidth:200,dataIndex:"inTax"},{title:"备注",dataIndex:"remark",minWidth:120}],invoiceVoList:[],cantEdit:!1,filePaths:[],storeNo:"",typeCooperationMode:"",filePopContent:""}},created:function(){this.settlementDetail()},methods:{settlementDetail:function(){var e=this;this.loading=!0,this.$http.post(a.a.settlementDetail+"/"+this.settlementNo).then(function(t){if(e.loading=!1,0===t.code&&t.data){var i=t.data,n=i.settlement,o=i.purchaseIOOrderDOList,a=i.feeList,l=i.productSummaryList,c=i.storeSummaryList,r=i.invoiceList,d=i.batchVO,m=i.ioOrderTotalMoney;e.settlement=n,e.ioOrderTotalMoney=m,e.batchVO=d;var u=d&&d.invoiceFiles||[];e.filePopContent=u.length>0?u.map(function(e,t){return"<p>附件"+(t+1)+":<a href='"+e+"' target='_block'>"+e+"</a></p>"}).join(""):"",e.typeCooperationMode=n.cooperationMode,e.reconciliationVoList=o&&o.map(function(e,t){return e.index=t+1,e})||[],e.chargeVoList=a&&a.length>0?a.map(function(e,t){return e.index=t+1,e.taxReceipt=e.taxReceipt?"票扣":"非票扣",e.happenTime=Object(s.b)("yyyy-MM-dd",e.happenTime),e}):[],e.goodsList=l&&l.length>0?l.map(function(e,t){return e.index=t+1,e.inPrice=Object(s.c)(e.inPrice),e}):[],e.storeList=c&&c.length>0?c.map(function(e,t){return e.index=t+1,e.storeNo=e.storeCode+(e.storeCode&&e.storeName?"-":"")+e.storeName,e}):[],e.invoiceVoList=r&&r.length>0?r.map(function(e,t){return e.index=t+1,e}):[];var v=d;e.cantEdit=!(!v||v&&0===v.status),e.storeNo=e.reconciliationVoList&&e.reconciliationVoList.length>0?e.reconciliationVoList[0].warehouseNumber:e.storeList&&e.storeList.length>0&&e.storeList[0].storeCode}}).catch(function(t){e.loading=!1,e.$tip.notify(t.message||"","error","系统提示")})},doExortHandel:function(e,t,i){var n=this.getConfigFromColumn(this[t]),o=Object(s.i)(n,!1),a=Object(s.i)(n,!0);c.a.ExportJsonToExcel({header:o,filterVal:a,data:this[i],filename:e})},getConfigFromColumn:function(e){for(var t={},i=0;i<e.length;i++)!t[e[i].dataIndex]&&e[i].dataIndex&&e[i].title&&(t[e[i].dataIndex]=e[i].title);return t},doCancelHandel:function(){var e=this,t=this.settlement.invoiceBatchNumber;t?this.$confirm("是否确认撤回？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$http.post(a.a.deleteInvoice+"/"+t).then(function(t){if(0===t.code)return e.$tip.message("操作成功","success"),void e.settlementDetail();throw new Error(t.msg)}).catch(function(t){e.$tip.notify(t.message||"","error","系统提示")})}):console.log("invoiceBatchNumber为空")},getSummariesOfReceipt:function(e){var t=[],i=e.data.map(function(e){return e.totalMoney});return t[4]=Object(s.c)(i.reduce(function(e,t){var i=Number(t);return isNaN(i)?e:e+t},0)),t[0]="合计",t},getSummariesOfOther:function(e){var t=[],i=e.data.map(function(e){return e.feeMoney});return t[4]=Object(s.c)(i.reduce(function(e,t){var i=Number(t);return isNaN(i)?e:e+t},0)),this.chargeAmount=t[4],t[0]="合计",t},getSummariesOfGood:function(e){var t=[],i=e.data.map(function(e){return e.productMoney});return t[9]=Object(s.c)(i.reduce(function(e,t){var i=Number(t);return isNaN(i)?e:e+t},0)),t[0]="合计",t},getSummariesOfStore:function(e){var t=[],i=e.data.map(function(e){return e.productMoney});return t[0]="合计",t[2]=Object(s.c)(i.reduce(function(e,t){var i=Number(t);return isNaN(i)?e:e+t},0)),t},getSummariesOfInvoice:function(e){var t=e.columns,i=e.data,n=[],o=["taxMoney","noTaxMoney","invoiceMoney"];return t.forEach(function(e,t){if(0!==t){var a=i.map(function(t){return Number(t[e.property])});!a.every(function(e){return isNaN(e)})&&o.includes(e.property)&&(n[t]=Object(s.c)(a.reduce(function(e,t){var i=Number(t);return isNaN(i)?e:e+t},0)))}else n[t]="合计"}),n},showDialog:function(e){var t=[];"edit"===e&&(t=(this.invoiceVoList||[]).map(function(e){return{lineId:Date.now(),invoiceTypeCode:e.inoviceType,invoiceDate:e.invoiceTimeDate,invoiceCode:e.invoiceCode,invoiceNo:e.invoiceNumber,netAmount:e.noTaxMoney,taxCode:e.inTax||0==e.inTax?[e.inTax]:[],taxAmount:e.taxMoney,amount:e.invoiceMoney}}));var i={settlementNo:this.settlementNo,startDate:this.settlement.settlementStartDate,endDate:this.settlement.settlementEndDate,statusNameForVendor:this.settlement.statusName,invoiceAmount:this.settlement.shoudInvoiceMoney,invoicedAmount:this.settlement.havedInvoiceMoney,cantEdit:this.cantEdit,invoiceBatchNumber:this.settlement.invoiceBatchNumber||"",invoiceDetailList:t||[],filePaths:this.batchVO&&this.batchVO.invoiceFiles||[],settlement:this.settlement,type:e};this.$refs.invoiceDialog.setDefaultMsg(i)},goPrint:function(){this.$router.push("/settlement/print/"+this.storeNo+"/"+this.settlementNo)}}},d={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"detail-box"},[i("el-row",{staticClass:"button-size"},[i("el-button",{attrs:{size:"small",disabled:e.disabledInvoice,icon:"el-icon-tickets"},on:{click:e.showDialog}},[e._v("开发票")]),e._v(" "),i("el-button",{attrs:{icon:"el-icon-edit",disabled:e.cantEdit||e.invoiceVoDis,size:"small"},on:{click:function(t){return e.showDialog("edit")}}},[e._v("编辑")]),e._v(" "),i("el-button",{attrs:{icon:"el-icon-refresh-left",size:"small",disabled:e.cantEdit||e.invoiceVoDis},on:{click:e.doCancelHandel}},[e._v("撤回发票")]),e._v(" "),e.filePopContent?i("el-popover",{attrs:{placement:"top-start",width:"400",trigger:"hover"}},[i("div",{domProps:{innerHTML:e._s(e.filePopContent)}}),e._v(" "),i("el-button",{attrs:{slot:"reference",size:"small",disabled:!e.filePopContent},slot:"reference"},[e._v("下载附件")])],1):i("el-button",{attrs:{size:"small",disabled:!e.filePopContent}},[e._v("下载附件")]),e._v(" "),i("el-button",{attrs:{type:"primary",icon:"el-icon-printer",size:"small"},on:{click:e.goPrint}},[e._v("打印")]),e._v(" "),i("el-button",{attrs:{type:"primary",size:"small",disabled:!e.goodsList.length},on:{click:function(t){return e.doExortHandel("结算单单据明细","goodsColumns","goodsList")}}},[e._v("导出单据")]),e._v(" "),i("el-button",{attrs:{type:"primary",size:"small",disabled:!e.reconciliationVoList.length},on:{click:function(t){return e.doExortHandel("结算单商品明细","reconciliationColumns","reconciliationVoList")}}},[e._v("导出商品")])],1),e._v(" "),i("el-row",{staticClass:"settlement-detail"},[i("el-row",{staticClass:"mt-5"},[i("el-col",{attrs:{span:6}},[e._v("结算单号："+e._s(e.settlementNo))]),e._v(" "),i("el-col",{attrs:{span:6}},[e._v("结算主体："+e._s(e.settlement.accountName))]),e._v(" "),i("el-col",{attrs:{span:6}},[e._v("供应商名称："+e._s(e.settlement.supplierName))]),e._v(" "),i("el-col",{attrs:{span:6}},[e._v("单据状态："+e._s(e.settlement.statusName))])],1),e._v(" "),i("el-row",{staticClass:"mt-5"},[i("el-col",{attrs:{span:6}},[e._v("创建时间："+e._s(e.settlement.addTime))]),e._v(" "),i("el-col",{attrs:{span:6}},[e._v("类型："+e._s(e.settlement.cooperationModeName))]),e._v(" "),i("el-col",{attrs:{span:6}},[e._v("账期："+e._s(e.settlement.settlementStartDate)+"至"+e._s(e.settlement.settlementEndDate))]),e._v(" "),i("el-col",{attrs:{span:6}},[e._v("应结算日："+e._s(e.settlement.settlementEndDate))])],1),e._v(" "),i("el-row",{staticClass:"mt-5"},[i("el-col",{attrs:{span:6}},[e._v("单据金额：￥"+e._s(e.ioOrderTotalMoney))]),e._v(" "),i("el-col",{attrs:{span:6}},[e._v("费用金额：￥"+e._s(e.chargeAmount))]),e._v(" "),i("el-col",{attrs:{span:6}},[e._v("应结金额：￥"+e._s(e.settlement.shouldPay))]),e._v(" "),i("el-col",{attrs:{span:6}},[e._v("应开票金额：￥"+e._s(e.settlement.shoudInvoiceMoney))])],1),e._v(" "),i("el-row",{staticClass:"mt-5"},[i("el-col",{attrs:{span:6}},[e._v("已开票金额：￥"+e._s(e.settlement.havedInvoiceMoney))])],1),e._v(" "),i("el-col",{staticClass:"mt-5",attrs:{span:24}},[e._v("备注："+e._s(e.settlement.remark))])],1),e._v(" "),i("el-tabs",{staticClass:"search-form-wraper",attrs:{type:"card"},model:{value:e.activeTabName,callback:function(t){e.activeTabName=t},expression:"activeTabName"}},[1==e.typeCooperationMode?i("el-tab-pane",{key:0,attrs:{label:"单据",name:"first"}},[i("bl-table",{attrs:{loading:e.loading,border:!1,dataSource:e.reconciliationVoList,columns:e.reconciliationColumns,selection:!1,showSummary:!0,getSummaries:e.getSummariesOfReceipt}})],1):e._e(),e._v(" "),i("el-tab-pane",{key:1,attrs:{label:"其他费用",name:"second"}},[i("bl-table",{attrs:{loading:e.loading,border:!1,dataSource:e.chargeVoList,columns:e.chargeColumns,selection:!1,showSummary:!0,getSummaries:e.getSummariesOfOther}})],1),e._v(" "),i("el-tab-pane",{key:2,attrs:{label:"商品明细",name:"third"}},[i("bl-table",{attrs:{loading:e.loading,border:!1,dataSource:e.goodsList,columns:e.goodsColumns,selection:!1,showSummary:!0,getSummaries:e.getSummariesOfGood}})],1),e._v(" "),i("el-tab-pane",{key:3,attrs:{label:"门店明细",name:"fourth"}},[i("bl-table",{attrs:{loading:e.loading,border:!1,dataSource:e.storeList,columns:e.storeColumns,selection:!1,showSummary:!0,getSummaries:e.getSummariesOfStore}})],1),e._v(" "),i("el-tab-pane",{key:4,attrs:{label:"发票明细",name:"five"}},[i("bl-table",{attrs:{loading:e.loading,border:!1,dataSource:e.invoiceVoList,columns:e.invoiceColumns,selection:!1,showSummary:!0,getSummaries:e.getSummariesOfInvoice}})],1)],1),e._v(" "),i("invoice-dialog",{ref:"invoiceDialog",on:{parentsHandel:e.settlementDetail}})],1)},staticRenderFns:[]};var m=i("VU/8")(r,d,!1,function(e){i("mCuB")},"data-v-e210258e",null);t.default=m.exports},mCuB:function(e,t){}});
//# sourceMappingURL=7.298bf2c25b4e283b3921.1615898974438.js.map