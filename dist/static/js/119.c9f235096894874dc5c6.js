webpackJsonp([119],{"3Z9F":function(t,e){},extB:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=o("Gu7T"),s=o.n(a),r=o("Dd8w"),i=o.n(r),n=o("BO1k"),c=o.n(n),l=o("ssT3"),d=o("AoQI"),h=o("hfie"),u=o("wn3n"),p=o("oAV5"),f=o("d7hP"),m="/plateform/a/category/getCategoryTree",g="/plateform/a/store/condition/search",v="/plateform/a/platformCityGoods/presale/list",y="/plateform/a/platformCityGoods/presale/remove",C={data:function(){return{isDisabled:!1,loading:!1,pageNum:1,pageSize:10,total:0,searchContent:{queryString:"",platformCityGoodsIds:[],saleType:1,platformId:2,categoryIdList:[],categoryId:""},cateDefaultProps:{children:"categoryVoList",label:"categoryName",value:"categoryId"},categoryList:[],tableData:[],checkedList:[],storeOptions:[],isShow:!1,queryGoodsAsyncLoading:!1,queryGoodsSearchAsyncList:[]}},created:function(){this.getCategoryId()},mounted:function(){var t=l.a.get("searchJdGoodsContent");this.$route.meta.keepAlive&&t&&(this.pageNum=t.pageNum,this.searchContent=t.searchContent,this.queryGoodsSearchAsyncList=t.queryGoodsSearchAsyncList),l.a.remove("searchJdGoodsContent"),this.doSearchHandel(),this.goodsSelectInit()},components:{"choose-store":d.a,"batch-update-price":h.a,"goods-select":f.a,"batch-add-goods":u.a},methods:{goAddGoodsPage:function(){this.$router.push("/jd_goods/add_goods")},getStoreList:function(){var t=this;this.$http.post(g).then(function(e){if(0!==e.code)throw new Error(e.msg);if(e.data&&e.data.length){var o=[],a=!0,s=!1,r=void 0;try{for(var i,n=c()(e.data);!(a=(i=n.next()).done);a=!0){var l=i.value,d={value:l.storeNo,label:l.storeNo+"-"+l.storeName};o.push(d)}}catch(t){s=!0,r=t}finally{try{!a&&n.return&&n.return()}finally{if(s)throw r}}t.storeOptions=o}}).catch(function(t){console.log("提示(获取门店列表):",t.message)})},getCategoryId:function(){var t=this;this.$http.post(m).then(function(e){if(0!==e.code)throw new Error(e.msg);if(e.data&&e.data.length){var o=!0,a=!1,s=void 0;try{for(var r,i=c()(e.data);!(o=(r=i.next()).done);o=!0){var n=r.value;n.categoryVoList&&0===n.categoryVoList.length&&(n.categoryVoList=null)}}catch(t){a=!0,s=t}finally{try{!o&&i.return&&i.return()}finally{if(a)throw s}}t.categoryList=e.data}else t.categoryList=[]}).catch(function(t){console.log("提示(三方平台店内分类):",t.message)})},changeSize:function(t){this.pageSize=t,this.doSearchHandel()},changeCurrent:function(t){this.pageNum=t,this.doSearchHandel()},doSearchHandel:function(t){var e=this;this.checkedList=[];var o=this.searchContent.categoryIdList.length-1;this.searchContent.categoryId=this.searchContent.categoryIdList[o],this.loading=!0,!0===t&&(this.pageNum=1),this.$http.post(v,i()({},this.searchContent,{pageNum:this.pageNum,pageSize:this.pageSize})).then(function(t){if(e.loading=!1,0!==t.code)throw new Error(t.msg);t.data?(t.data.result&&t.data.result.length?e.tableData=t.data.result:e.tableData=[],e.total=t.data.total):(e.total=0,e.tableData=[])}).catch(function(t){e.loading=!1,e.$notify.error({title:"提示",message:t.message})})},editItem:function(t){var e={pageNum:this.pageNum,searchContent:this.searchContent,queryGoodsSearchAsyncList:this.queryGoodsSearchAsyncList};l.a.set("searchJdGoodsContent",e),this.$router.push("/jd_goods/edit_goods/"+t.platformCityGoodsId)},deleteItem:function(t){var e=this,o=[];o.push(t.platformCityGoodsId),this.$confirm("您确定要删除所选商品吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$http.post(y,{platformCityGoodsIds:o}).then(function(t){if(0===t.code)return e.$message.success("删除成功"),void e.doSearchHandel();throw new Error(t.msg)}).catch(function(t){e.$notify.error({title:"提示",message:t.message})})}).catch(function(){})},batchRemove:function(){var t=this,e=[],o=!0,a=!1,s=void 0;try{for(var r,i=c()(this.checkedList);!(o=(r=i.next()).done);o=!0){var n=r.value;e.push(n.platformCityGoodsId)}}catch(t){a=!0,s=t}finally{try{!o&&i.return&&i.return()}finally{if(a)throw s}}this.$confirm("您确定要删除所选商品吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$http.post(y,{platformCityGoodsIds:e}).then(function(e){if(0===e.code)return t.$message.success("删除成功"),void t.doSearchHandel();throw new Error(e.msg)}).catch(function(e){t.$notify.error({title:"提示",message:e.message})})}).catch(function(){})},handleSelect:function(t,e){var o={},a=[];if(p.l(e.platformCityGoodsId,this.checkedList))this.checkedList=p.q("platformCityGoodsId",e.platformCityGoodsId,this.checkedList);else{a.push(e);var r=[].concat(a,s()(this.checkedList));this.checkedList=r.reduceRight(function(t,e){return!o[e.platformCityGoodsId]&&(o[e.platformCityGoodsId]=t.push(e)),t},[])}},handleSelectAll:function(t){var e={};if(t.length>0){var o=!0,a=!1,s=void 0;try{for(var r,i=c()(t);!(o=(r=i.next()).done);o=!0){var n=r.value;this.checkedList.push(n)}}catch(t){a=!0,s=t}finally{try{!o&&i.return&&i.return()}finally{if(a)throw s}}this.checkedList=this.checkedList.reduceRight(function(t,o){return!e[o.platformCityGoodsId]&&(e[o.platformCityGoodsId]=t.push(o)),t},[])}else{var l=[],d=!0,h=!1,u=void 0;try{for(var f,m=c()(this.tableData);!(d=(f=m.next()).done);d=!0){var g=f.value;l.push(g)}}catch(t){h=!0,u=t}finally{try{!d&&m.return&&m.return()}finally{if(h)throw u}}var v=p.i(this.checkedList,l,"platformCityGoodsId");this.checkedList=v&&v.length>0?v:[]}},importStore:function(){if(0!==this.checkedList.length){var t=[],e=!0,o=!1,a=void 0;try{for(var s,r=c()(this.checkedList);!(e=(s=r.next()).done);e=!0){var i=s.value;t.push(i.platformCityGoodsId)}}catch(t){o=!0,a=t}finally{try{!e&&r.return&&r.return()}finally{if(o)throw a}}var n={title:"批量引入门店",platformCityGoodsIdList:t,platformId:this.searchContent.platformId};this.$refs.chooseStore.setDefault(n)}else this.$message("请选择商品")},showStoreState:function(t){var e=t.platformCityGoodsId;this.$router.push("/store_jd?platformCityGoodsId="+e)},showBatchUpdatePrice:function(){var t={title:"批量改价",saleType:this.searchContent.saleType,platformId:this.searchContent.platformId};this.$refs.batchUpdatePrice.setDefaultMesg(t)},batchAddGoods:function(){var t={title:"批量添加",saleType:this.searchContent.saleType,platformId:this.searchContent.platformId};this.$refs.batchAddGoods.setDefaultMesg(t)},doCategorysChangeHandel:function(){this.goodsSelectInit(),this.doSearchHandel(!0)},goodsSelectInit:function(){if(this.$refs.GoodsSelect){var t={queryString:this.searchContent.queryString,categoryIdList:this.searchContent.categoryIdList,saleType:this.searchContent.saleType,platformId:this.searchContent.platformId,platformCityGoodsIds:this.searchContent.platformCityGoodsIds};this.$refs.GoodsSelect.setDefaultMesg(t)}},DoSelectGoodsHandel:function(t){var e=t.checkedList,o=t.queryString,a=[],s=!0,r=!1,i=void 0;try{for(var n,l=c()(e);!(s=(n=l.next()).done);s=!0){var d=n.value;a.push(d.platformCityGoodsId)}}catch(t){r=!0,i=t}finally{try{!s&&l.return&&l.return()}finally{if(r)throw i}}this.searchContent.platformCityGoodsIds=a,this.searchContent.queryString=o,this.doSearchHandel(!0)}},beforeRouteLeave:function(t,e,o){e.meta.keepAlive=!1,o()}},w={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("div",{staticClass:"handel-search-wraper"},[o("div",{staticClass:"handel-wraper"},[o("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-plus"},on:{click:t.goAddGoodsPage}},[t._v("添加商品")]),t._v(" "),o("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-circle-plus-outline"},on:{click:t.batchAddGoods}},[t._v("批量添加")]),t._v(" "),o("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-edit"},on:{click:t.showBatchUpdatePrice}},[t._v("批量调价")])],1),t._v(" "),o("hr",{staticClass:"s-slip"}),t._v(" "),o("div",{staticClass:"search-form-wraper"},[o("el-form",{attrs:{model:t.searchContent,"label-position":"top"}},[o("el-form-item",{attrs:{label:"商品分类"}},[o("el-cascader",{staticClass:"search-input",attrs:{placeholder:"请选择分类",options:t.categoryList,"change-on-select":"",size:"small",clearable:"",filterable:"",props:t.cateDefaultProps},on:{change:t.doCategorysChangeHandel},model:{value:t.searchContent.categoryIdList,callback:function(e){t.$set(t.searchContent,"categoryIdList",e)},expression:"searchContent.categoryIdList"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"SKU编码/商品名称"}},[o("goods-select",{ref:"GoodsSelect",on:{DoSelectGoodsHandel:t.DoSelectGoodsHandel}})],1),t._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.doSearchHandel(!0)}}},[t._v("搜索")])],1)],1)],1)]),t._v(" "),o("div",{staticClass:"table-wraper"},[o("div",{staticClass:"batch-handel-w"},[o("el-button",{staticClass:"sup-mini",attrs:{size:"mini",icon:"el-icon-edit",disabled:0===t.checkedList.length},on:{click:t.importStore}},[t._v("引入门店")]),t._v(" "),o("el-button",{staticClass:"sup-mini",attrs:{size:"mini",icon:"el-icon-delete",disabled:0===t.checkedList.length},on:{click:t.batchRemove}},[t._v("批量删除")])],1),t._v(" "),o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"fixed-height",staticStyle:{width:"100%"},attrs:{data:t.tableData,"empty-text":"没有查询到您想要的数据",size:"small"},on:{select:t.handleSelect,"select-all":t.handleSelectAll}},[o("el-table-column",{attrs:{type:"selection",width:"50"}}),t._v(" "),o("el-table-column",{attrs:{"min-width":"236px",label:"商品信息"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("div",{staticClass:"p-m-w"},[o("div",{staticClass:"img-w g-m-r"},[o("p",{directives:[{name:"show",rawName:"v-show",value:e.row.topMark,expression:"scope.row.topMark"}],staticClass:"t-m-w"},[t._v(t._s(e.row.topMark))]),t._v(" "),e.row.imgUrl&&""!=e.row.imgUrl?o("img",{attrs:{src:e.row.imgUrl,alt:"",onerror:"onerror=null;src='/shop/static/img_error.png'"}}):o("img",{attrs:{src:"/shop/static/img_error.png",alt:""}}),t._v(" "),o("p",{directives:[{name:"show",rawName:"v-show",value:e.row.bottomMark,expression:"scope.row.bottomMark"}],staticClass:"b-m-w"},[t._v(t._s(e.row.bottomMark))])]),t._v(" "),o("div",{staticClass:"p-m-c-r"},[o("div",[t._v(t._s(e.row.goodsName||"--"))]),t._v(" "),o("div",{staticClass:"erp-p-no"},[t._v("SKU编码："+t._s(e.row.goodsNo||"--"))]),t._v(" "),o("div",{staticClass:"erp-p-no"},[t._v("商品ID："+t._s(e.row.platformCityGoodsId||"--"))])])])]}}])}),t._v(" "),o("el-table-column",{attrs:{"min-width":"120px",prop:"spec",label:"规格"}}),t._v(" "),o("el-table-column",{attrs:{"min-width":"120px",prop:"cityName",label:"城市"}}),t._v(" "),o("el-table-column",{attrs:{"min-width":"120px",prop:"categoryName",label:"分类"}}),t._v(" "),o("el-table-column",{attrs:{"min-width":"120px",prop:"price",label:"售价"}}),t._v(" "),o("el-table-column",{attrs:{fixed:"right",label:"操作",width:"140"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("div",[o("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-edit"},on:{click:function(o){return t.editItem(e.row)}}},[t._v("编辑")]),t._v(" "),o("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-delete"},on:{click:function(o){return t.deleteItem(e.row)}}},[t._v("删除")])],1),t._v(" "),o("div",[o("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-view"},on:{click:function(o){return t.showStoreState(e.row)}}},[t._v("查看门店状态")])],1)]}}])})],1),t._v(" "),t.total>0?o("el-pagination",{staticClass:"tc mt20",attrs:{background:"","current-page":t.pageNum,"page-sizes":[10,50,100,150,200],layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.changeSize,"current-change":t.changeCurrent,"update:currentPage":function(e){t.pageNum=e},"update:current-page":function(e){t.pageNum=e}}}):t._e()],1),t._v(" "),o("div",[o("choose-store",{ref:"chooseStore",on:{doSearchHandel:t.doSearchHandel}})],1),t._v(" "),o("batch-update-price",{ref:"batchUpdatePrice",on:{doSearchHandel:t.doSearchHandel}}),t._v(" "),o("batch-add-goods",{ref:"batchAddGoods",on:{doSearchHandel:t.doSearchHandel}})],1)},staticRenderFns:[]};var b=o("VU/8")(C,w,!1,function(t){o("3Z9F")},null,null);e.default=b.exports}});
//# sourceMappingURL=119.c9f235096894874dc5c6.js.map