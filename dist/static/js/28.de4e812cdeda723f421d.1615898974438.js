webpackJsonp([28],{"/VC1":function(t,e,a){"use strict";var o=a("bzuE"),s={summaryByGoods:o.a.reqUrl+"/supplier/a/vendorSale/summaryByGoods",storeSale:o.a.reqUrl+"/supplier/a/vendorSale/storeSale",summaryGoodsEachStore:o.a.reqUrl+"/supplier/a/vendorSale/summaryGoodsEachStore"};e.a=s},"8u0j":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=a("Dd8w"),s=a.n(o),r=a("WorT"),n=a("/VC1"),i=(a("t0/o"),a("oAV5")),l=a("8uth"),c=a("7592"),d=(a("8e4C"),{mixins:[r.a],components:{ChooseStore:c.a},data:function(){return{goodsNo:"",loading:!1,exportLoading:!1,total:0,tableData:[],searchContent:{vendorNoList:[],storeNoList:[],storeNames:"",startDate:"",endDate:"",goodsNo:"",goodsBarcode:"",vendorGoodsNo:"",contractNo:"",settlementMethodCode:""},typeIdOptions:[{value:"",label:"全部"},{value:1,label:"购销"},{value:2,label:"联营"},{value:9,label:"代营"}],checkedStoreList:[],vendorNos:[],columns:[{title:"序号",dataIndex:"index",minWidth:60},{title:"门店名称",ellipsis:!0,dataIndex:"storeName",minWidth:100},{title:"所在区域",dataIndex:"areaStr",ellipsis:!0,minWidth:130},{title:"平均销售价",dataIndex:"storeSalePrice",minWidth:130,sortable:!0},{title:"销售量+赠品",dataIndex:"storeSaleQty",minWidth:130,sortable:!0},{title:"销售额",dataIndex:"storeSaleAmount",minWidth:90,sortable:!0},{title:"销售占比",dataIndex:"storeSaleRatio",minWidth:100,sortable:!0},{title:"平均进价",dataIndex:"stockPrice",minWidth:120,sortable:!0},{title:"平均费率",dataIndex:"ratio",minWidth:110,sortable:!0},{title:"参考毛利额",dataIndex:"cityProfitAmount",minWidth:130,sortable:!0}],exportConfig:{index:"序号",storeName:"门店名称",areaStr:"所在区域",storeSalePrice:"平均销售价",storeSaleQty:"销售量+赠品",storeSaleAmount:"销售额",storeSaleRatio:"销售占比",stockPrice:"平均进价",ratio:"平均费率",cityProfitAmount:"参考毛利额"},orderMsg:{}}},created:function(){this.goodsNo=this.$route.params.goodsNo;var t=this.$storage.get("searchInfo");t&&(this.checkedStoreList=t.checkedStoreList||[],this.searchContent=s()({},t))},mounted:function(){this.doSearchHandle(!0)},methods:{doSearchHandle:function(t){var e=this;if(this.searchContent.startDate&&this.searchContent.endDate&&Object(i.a)(this.searchContent.startDate)>Object(i.a)(this.searchContent.endDate))this.$tip.message("结束时间不能早于开始时间！","warning");else{this.loading=!0;var a=s()({},this.searchContent,{goodsNo:this.goodsNo,startDate:this.searchContent.startDate+" 00:00:00",endDate:this.searchContent.endDate+" 23:59:59"});this.$http.post(n.a.summaryGoodsEachStore,s()({},a)).then(function(t){if(e.loading=!1,0!==t.code)throw new Error(t.msg);if(t.data){var a=t.data.citySaleList&&t.data.citySaleList.length?t.data.citySaleList.map(function(t,e){return t.index=e+1,t.provinceName&&t.cityName?t.areaStr=t.provinceName+"-"+t.cityName:t.provinceName?t.areaStr=""+t.provinceName:t.cityName?t.areaStr=""+t.cityName:t.areaStr="-",t.storeSalePrice=t.storeSalePrice?Object(i.c)(t.storeSalePrice):t.storeSalePrice,t.storeSaleQty=t.storeSaleQty?Object(i.c)(t.storeSaleQty,3):t.storeSaleQty,t.storeSaleAmount=t.storeSaleAmount?Object(i.c)(t.storeSaleAmount):t.storeSaleAmount,t.storeSaleRatio=t.storeSaleRatio?Object(i.c)(t.storeSaleRatio):t.storeSaleRatio,t.stockPrice=t.stockPrice?Object(i.c)(t.stockPrice):t.stockPrice,t.ratio=t.ratio?Object(i.c)(t.ratio):t.ratio,t.cityProfitAmount=t.cityProfitAmount?Object(i.c)(t.cityProfitAmount):t.cityProfitAmount,t}):[];e.tableData=a,e.orderMsg=s()({},t.data)}else e.tableData=[]}).catch(function(t){e.loading=!1,e.$tip.notify(t.message||"","error","系统提示")})}},doExortHandel:function(){this.exportLoading=!0;var t=this.orderMsg.goodsName,e=this.searchContent,a=e.startDate,o=e.endDate;if(this.tableData.length>0){var s=Object(i.i)(this.exportConfig,!1),r=Object(i.i)(this.exportConfig,!0);l.a.ExportJsonToExcel({header:s,filterVal:r,data:this.tableData,filename:t+"销售数据_"+a+"~"+o}),this.exportLoading=!1}else this.$tip.message("没有查询到可导出数据！","warning"),this.exportLoading=!1},clickInputHandel:function(){this.vendorNos=this.searchContent.vendorNo&&this.searchContent.vendorNo.length>0?this.searchContent.vendorNo:this.vendors.map(function(t){return t.vendorNo}),this.$refs.chooseStore.setDefault({vendorNos:this.vendorNos,defaultChecked:this.checkedStoreList})},confirmHandel:function(t){this.checkedStoreList=t,this.searchContent.storeNoList=t.map(function(t){return t.storeNo}),this.storeNames=t.map(function(t){return t.storeName}).join(",")}}}),h={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"handel-wraper"},[a("el-row",{attrs:{type:"flex",align:"bottom",gutter:10}},[a("el-col",{attrs:{span:6}},[t._v("商品："+t._s(t.orderMsg.goodsName||"-"))]),t._v(" "),a("el-col",{attrs:{span:6}},[t._v("编码："+t._s(t.orderMsg.goodsNo||"-"))]),t._v(" "),a("el-col",{attrs:{span:6}},[t._v("条码："+t._s(t.orderMsg.goodsBarcode||"-"))]),t._v(" "),a("el-col",{attrs:{span:6}},[t._v("货号："+t._s(t.orderMsg.vendorGoodsNo||"-"))])],1),t._v(" "),a("el-row",{attrs:{type:"flex",align:"bottom",gutter:10}},[a("el-col",{attrs:{span:6}},[t._v("合同编码："+t._s(t.orderMsg.contractNo||"-"))]),t._v(" "),a("el-col",{attrs:{span:6}},[t._v("规格："+t._s(t.orderMsg.spec||"-"))]),t._v(" "),a("el-col",{attrs:{span:6}},[t._v("单位："+t._s(t.orderMsg.saleUnit||"-"))]),t._v(" "),a("el-col",{attrs:{span:6}},[t._v("总销售量："+t._s(t.orderMsg.saleQty||"-"))])],1),t._v(" "),a("el-row",{attrs:{type:"flex",align:"bottom",gutter:10}},[a("el-col",{attrs:{span:6}},[t._v("总销售额：￥"+t._s(t.orderMsg.saleAmount))]),t._v(" "),a("el-col",{attrs:{span:6}},[t._v("毛利额：￥"+t._s(t.orderMsg.grossProfitAmount))])],1)],1),t._v(" "),a("div",{staticClass:"search-form-wraper"},[a("el-form",{attrs:{model:t.searchContent,"label-position":"top"}},[a("el-form-item",{attrs:{label:"起始时间"}},[a("el-date-picker",{staticClass:"search-input",attrs:{type:"date",placeholder:"起始时间",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",size:"small"},model:{value:t.searchContent.startDate,callback:function(e){t.$set(t.searchContent,"startDate",e)},expression:"searchContent.startDate"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"结束时间"}},[a("el-date-picker",{staticClass:"search-input",attrs:{type:"date",placeholder:"结束时间",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",size:"small"},model:{value:t.searchContent.endDate,callback:function(e){t.$set(t.searchContent,"endDate",e)},expression:"searchContent.endDate"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"门店"}},[a("el-input",{staticClass:"search-input",attrs:{size:"small",placeholder:"点击选择门店",readonly:""},model:{value:t.searchContent.storeNames,callback:function(e){t.$set(t.searchContent,"storeNames","string"==typeof e?e.trim():e)},expression:"searchContent.storeNames"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:t.clickInputHandel},slot:"append"})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"结算方式"}},[a("el-select",{staticClass:"search-input",attrs:{placeholder:"结算方式",filterable:"",clearable:"",size:"small"},model:{value:t.searchContent.settlementMethodCode,callback:function(e){t.$set(t.searchContent,"settlementMethodCode",e)},expression:"searchContent.settlementMethodCode"}},t._l(t.typeIdOptions,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.doSearchHandle}},[t._v("搜索")])],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{disabled:t.exportLoading,size:"mini",loading:t.exportLoading},on:{click:t.doExortHandel}},[t._v("导出")])],1),t._v(" "),a("div",{staticStyle:{float:"right","margin-top":"32px"}},[a("el-popover",{attrs:{placement:"bottom",width:"360",trigger:"hover",title:"表格字段说明"}},[a("div",[a("p",[t._v("平均售价：联营商品的销售额/联营商品的销售量；")]),t._v(" "),a("p",[t._v("平均进价：购销商品的进货额/购销商品的销售量；")]),t._v(" "),a("p",[t._v("销售额：仅显示联营类型的商品销售额；")]),t._v(" "),a("p",[t._v("平均费率：销售额*费率（扣点）之和/销售额，以每阶段的实际扣点计算；")]),t._v(" "),a("p",[t._v("参考毛利额：联营商品的销售额减去对应的扣点金额（销售额*费率），以每阶段的实际扣点计算；")])]),t._v(" "),a("span",{staticClass:"el-icon-question",attrs:{slot:"reference"},slot:"reference"},[t._v("帮助")])])],1)],1)],1),t._v(" "),a("div",{staticClass:"table-wraper"},[a("bl-table",{attrs:{loading:t.loading,border:!1,dataSource:t.tableData,columns:t.columns}})],1),t._v(" "),a("choose-store",{ref:"chooseStore",on:{confirm:t.confirmHandel}})],1)},staticRenderFns:[]},m=a("VU/8")(d,h,!1,null,null,null);e.default=m.exports}});
//# sourceMappingURL=28.de4e812cdeda723f421d.1615898974438.js.map