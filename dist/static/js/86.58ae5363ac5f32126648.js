webpackJsonp([86],{"9c3p":function(e,t){},aaRi:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("Dd8w"),i=a.n(n),s=a("ssT3"),r=a("u4Bf"),l=a.n(r),o=a("oAV5"),d="/plateform/a/banner/list",c="/plateform/a/banner/sort",v="/plateform/a/banner/del",u="/plateform/a/banner/updateStatus",b={data:function(){return{loading:!1,isDisabled:!1,canMove:!1,deleteBannerDialogVisible:!1,statusBannerDialogVisible:!1,activeName:"abled",currentPage:1,pageSize:20,total:0,searchContent:{name:"",status:""},abledTableData:[],disabledTableData:[],deleteBannerContent:{id:"",isDeleted:""},allAbledLength:""}},created:function(){var e=this.$route.query.status;"0"==e?this.activeName="abled":"1"==e&&(this.activeName="disabled")},mounted:function(){this.doSearchHandel(!0)},components:{draggable:l.a},methods:{changeSize:function(e){this.pageSize=e,this.doSearchHandel()},changeCurrent:function(e){this.doSearchHandel(e,"changeCurrent")},doSearchHandel:function(e,t){var a=this;this.loading=!0,this.currentPage="changeCurrent"==t?e:1,this.searchContent.status=0,this.$http.post(d,i()({},this.searchContent,{pageNum:1,pageSize:400})).then(function(e){if(a.loading=!1,0!==e.code)throw new Error(e.msg);if(e.data&&e.data.list&&e.data.list.length){e.data.list.forEach(function(e,t){e.index=t+1}),a.abledTableData=e.data.list;var t=a.abledTableData.length;a.allAbledLength=t}else a.abledTableData=[]}).catch(function(e){a.loading=!1,a.$notify.error({title:"提示",message:e.message})}),this.searchContent.status=1,this.$http.post(d,i()({},this.searchContent,{pageNum:this.currentPage,pageSize:this.pageSize})).then(function(e){if(a.loading=!1,0===e.code)return e.data&&e.data.list&&e.data.list.length?(e.data.list.forEach(function(e,t){e.index=(a.currentPage-1)*a.pageSize+t+1}),a.disabledTableData=e.data.list):a.disabledTableData=[],void(1==a.currentPage&&(a.total=e.data.total));throw new Error(e.msg)}).catch(function(e){console.log("提示(获取禁用分组列表):",e.message)})},doSortOnceHandel:function(){0!=this.abledTableData.length&&(this.canMove=!0)},doSaveSortHandel:function(){var e=this;if(!0!==this.isDisabled){var t=[];this.abledTableData.forEach(function(e,a){var n={id:e.id,level:a+1};t.push(n)}),this.isDisabled=!0,o.r(),this.$http.post(c,{bannerLevelList:t}).then(function(t){var a=e;if(setTimeout(function(){a.isDisabled=!1},800),o.c(),0===t.code)return e.$message.success("重新排序成功"),e.canMove=!1,void e.doSearchHandel();throw new Error(t.msg)}).catch(function(t){var a=e;setTimeout(function(){a.isDisabled=!1},800),o.c(),e.$notify.error({title:"提示",message:t.message})})}},addBanner:function(){this.$router.push("/banner_mgt/add_banner")},editBanner:function(e){s.a.set("bannerMeg",e),this.$router.push("/banner_mgt/edit_banner")},deleteBanner:function(e){this.deleteBannerContent.isDeleted=1,this.deleteBannerContent.id=e.id,this.deleteBannerDialogVisible=!0},sureDeleteBanner:function(){var e=this;this.$http.post(v,i()({},this.deleteBannerContent)).then(function(t){if(0===t.code)return e.deleteBannerDialogVisible=!1,e.$message({message:"删除Banner成功",type:"success"}),void e.doSearchHandel();throw new Error(t.msg)}).catch(function(t){e.$notify.error({title:"提示",message:t.message})})},disabledBanner:function(e,t){var a=this,n=void 0;if("true"==t){if(this.allAbledLength>5)return void(this.statusBannerDialogVisible=!0);n={id:e.id,status:0}}else n={id:e.id,status:1};this.$http.post(u,i()({},n)).then(function(e){if(0===e.code)return"true"==t?a.$message({message:"开启Banner成功",type:"success"}):a.$message({message:"禁用Banner成功",type:"success"}),void a.doSearchHandel();throw new Error(e.msg)}).catch(function(e){a.$notify.error({title:"提示",message:e.message})})}}},m={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"handel-search-wraper"},[a("div",{staticClass:"handel-wraper"},[a("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-plus"},on:{click:e.addBanner}},[e._v("新增 Banner")])],1),e._v(" "),a("hr",{staticClass:"s-slip"}),e._v(" "),a("div",{staticClass:"search-form-wraper"},[a("el-form",{attrs:{model:e.searchContent,"label-position":"top"}},[a("el-form-item",{attrs:{label:"Banner名称"}},[a("el-input",{staticClass:"search-input",attrs:{placeholder:"请输入名称关键字",size:"small",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.doSearchHandel(t)}},model:{value:e.searchContent.name,callback:function(t){e.$set(e.searchContent,"name","string"==typeof t?t.trim():t)},expression:"searchContent.name"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.doSearchHandel}},[e._v("搜索")])],1),e._v(" "),"abled"!=e.activeName||e.canMove?"abled"==e.activeName?a("el-button",{staticStyle:{float:"right","margin-top":"26px"},attrs:{type:"primary",disabled:e.isDisabled,size:"mini"},on:{click:e.doSaveSortHandel}},[e._v("保存排序")]):e._e():a("el-button",{staticStyle:{float:"right","margin-top":"26px"},attrs:{type:"primary",size:"mini"},on:{click:e.doSortOnceHandel}},[e._v("编辑排序")])],1)],1)]),e._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"tab-wraper table-wraper"},[a("el-tabs",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{name:"abled"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v("启用 "+e._s(this.abledTableData.length))])]),e._v(" "),a("el-tab-pane",{attrs:{name:"disabled"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v("禁用 "+e._s(this.total))])]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:"abled"==e.activeName,expression:"activeName == 'abled'"}],staticStyle:{"background-color":"#fff",width:"100","overflow-x":"auto"}},[a("div",{staticClass:"banner-draggable-header banner-draggable-width"},[a("div",[e._v("序号")]),e._v(" "),a("div",[e._v("名称")]),e._v(" "),a("div",[e._v("缩略图（750*280）")]),e._v(" "),a("div",[e._v("跳转类型")]),e._v(" "),a("div",[e._v("修改时间")]),e._v(" "),a("div",[e._v("状态")]),e._v(" "),a("div",[e._v("操作")]),e._v(" "),e.canMove?a("div"):e._e()]),e._v(" "),e.canMove?a("draggable",{model:{value:e.abledTableData,callback:function(t){e.abledTableData=t},expression:"abledTableData"}},[a("transition-group",e._l(e.abledTableData,function(t,n){return a("div",{key:t.index,staticClass:"banner-draggable-td banner-draggable-width"},[a("div",[e._v(e._s(t.index))]),e._v(" "),a("div",[e._v(e._s(t.name))]),e._v(" "),a("div",{staticClass:"banner-img"},[a("img",{attrs:{src:t.url}})]),e._v(" "),a("div",[e._v(e._s(t.typeName))]),e._v(" "),a("div",[e._v(e._s(t.updateTime))]),e._v(" "),a("div",[e._v(e._s(t.statusName))]),e._v(" "),a("div",[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.editBanner(t)}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.deleteBanner(t)}}},[e._v("删除")]),e._v(" "),a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.disabledBanner(t)}}},[e._v("禁用")])],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.canMove,expression:"canMove"}],staticClass:"banner-mgt-move"},[a("img",{attrs:{src:"/shop/static/imgs/move.png",alt:""}}),e._v(" "),a("span",[e._v("按住拖拽")])])])}),0)],1):e._l(e.abledTableData,function(t,n){return a("div",{key:t.index,staticClass:"banner-draggable-td banner-draggable-width"},[a("div",[e._v(e._s(t.index))]),e._v(" "),a("div",[e._v(e._s(t.name))]),e._v(" "),a("div",{staticClass:"banner-img"},[a("img",{attrs:{src:t.url}})]),e._v(" "),a("div",[e._v(e._s(t.typeName))]),e._v(" "),a("div",[e._v(e._s(t.updateTime))]),e._v(" "),a("div",[e._v(e._s(t.statusName))]),e._v(" "),a("div",[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.editBanner(t)}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.deleteBanner(t)}}},[e._v("删除")]),e._v(" "),a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.disabledBanner(t)}}},[e._v("禁用")])],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.canMove,expression:"canMove"}]})])}),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.abledTableData.length<=0,expression:"abledTableData.length <= 0"}],staticClass:"no-data-wrap"},[e._v("没有查询到您想要的数据")])],2),e._v(" "),a("el-table",{directives:[{name:"show",rawName:"v-show",value:"disabled"==e.activeName,expression:"activeName == 'disabled'"}],staticClass:"fixed-height banner-img",staticStyle:{width:"100%"},attrs:{data:e.disabledTableData,"empty-text":"没有查询到您想要的数据",size:"small"}},[a("el-table-column",{attrs:{"min-width":"60",prop:"index",label:"序号"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"150",prop:"name",label:"名称"}}),e._v(" "),a("el-table-column",{attrs:{width:"180",label:"缩略图（750*280）"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("img",{attrs:{src:e.row.url}})]}}])}),e._v(" "),a("el-table-column",{attrs:{"min-width":"120",prop:"typeName",label:"跳转类型"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"160",prop:"updateTime",label:"修改时间"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"80",prop:"statusName",label:"状态"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"320",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.editBanner(t.row)}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.deleteBanner(t.row)}}},[e._v("删除")]),e._v(" "),a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.disabledBanner(t.row,"true")}}},[e._v("开启")])]}}])})],1),e._v(" "),a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:"disabled"==e.activeName&&e.disabledTableData.length>0,expression:"activeName == 'disabled' && disabledTableData.length>0"}],staticClass:"tc mt20",attrs:{background:"","current-page":e.currentPage,"page-sizes":[20,50,100,150,200],layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.changeSize,"current-change":e.changeCurrent,"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t}}})],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"删除Banner",visible:e.deleteBannerDialogVisible,width:"360px"},on:{"update:visible":function(t){e.deleteBannerDialogVisible=t}}},[a("span",[e._v("您确定要删除所选Banner吗？")]),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"mini"},on:{click:function(t){e.deleteBannerDialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.sureDeleteBanner}},[e._v("确 认")])],1)]),e._v(" "),a("el-dialog",{attrs:{title:"启用失败",visible:e.statusBannerDialogVisible,width:"360px"},on:{"update:visible":function(t){e.statusBannerDialogVisible=t}}},[a("span",[e._v("已经超过Banner的启用数量，限制6个")]),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){e.statusBannerDialogVisible=!1}}},[e._v("确 认")])],1)])],1)},staticRenderFns:[]};var h=a("VU/8")(b,m,!1,function(e){a("9c3p")},"data-v-615a0644",null);t.default=h.exports}});
//# sourceMappingURL=86.58ae5363ac5f32126648.js.map