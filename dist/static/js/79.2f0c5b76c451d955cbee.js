webpackJsonp([79],{jgPL:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("Gu7T"),l=a.n(r),i=a("Dd8w"),o=a.n(i),n=a("BO1k"),s=a.n(n),d=a("oAV5"),c=a("ssT3"),u=a("bzuE"),p=a("8uth"),h=a("XfvZ"),g=a("32kd"),v={orderDeliveryQuery:"/plateform/a/logistics/orderDeliveryQuery",orderDeliveryLogQuery:"/plateform/a/logistics/orderDeliveryLogQuery"},m={data:function(){return{loading:!1,pageNum:1,pageSize:20,total:0,pageSizes:u.a.pageSizes20,searchContent:{DIFFCITY:!0,defaultRange:[],beginTime:"",endTime:"",defaultRangeDelivery:[],deliveryBeginTime:"",deliveryEndTime:"",logisticsCompanyCode:"",deliveryStatus:"",currentCity:!1,storeNo:"",regionCode:c.a.get("regionCode")||""},storeOptions:[],tableData:[],orderNo:"",iconLoading:!1,dialogVisible:!1,orderDeliveryLogQuery:[],logisticsCompanyCodeOptions:[{label:"全部",value:""},{label:"美团配送",value:1002},{label:"达达配送",value:1003},{label:"门店自配送",value:1001},{label:"顺丰同城配送",value:1004}],deliveryStatusOptions:[{label:"全部",value:""},{label:"待派单",value:0},{label:"已接单",value:1},{label:"已分配骑手",value:2},{label:"骑手已揽件",value:3},{label:"已送达",value:4},{label:"配送失败",value:9},{label:"已取消",value:10}],orderStatusOptions:[{label:"全部",value:""},{label:"待出票",value:1},{label:"待备货",value:2},{label:"待揽件",value:3},{label:"配送中",value:5},{label:"已完成",value:6},{label:"已取消",value:7},{label:"已退款",value:10},{label:"已失效",value:11}],currentCityOptions:[{label:"是",value:!0},{label:"否",value:!1}],exportLoading:!1,exportConfig:{cityName:"城市",storeName:"门店",orderId:"订单号",expectedTime:"期望送达时间",logisticsCompany:"配送公司",deliveryStatusStr:"状态",orderStatusStr:"订单状态",orderCreateTime:"下单时间",deliveryTime:"派单时间",shipperAllocatedTime:"分配骑手时间",shipperReceivedTime:"揽件时间",shipperDeliveredTime:"送达/取消配送时间"}}},mounted:function(){this.doSearchHandel(!0)},components:{"date-picker-range":h.a,"region-city-store":g.a},methods:{StoreGroupChange:function(e){this.searchContent.regionCode=e.regionCode,this.searchContent.cityId=e.cityId,this.searchContent.storeNo=e.storeNo},changeSize:function(e){this.pageSize=e,this.doSearchHandel()},changeCurrent:function(e){this.pageNum=e,this.doSearchHandel()},getStoreList:function(){var e=this;this.$http.post(v.search,{DIFFCITY:!0}).then(function(t){if(0!==t.code)throw new Error(t.msg);if(t.data&&t.data.length){var a=[],r=!0,l=!1,i=void 0;try{for(var o,n=s()(t.data);!(r=(o=n.next()).done);r=!0){var d=o.value,c={value:d.storeNo,label:d.storeNo+"-"+d.storeName};a.push(c)}}catch(e){l=!0,i=e}finally{try{!r&&n.return&&n.return()}finally{if(l)throw i}}e.storeOptions=a}}).catch(function(e){console.log("提示(获取门店列表):",e.message)})},doSearchHandel:function(e){var t=this;this.loading=!0,!0===e&&(this.pageNum=1),this.$http.post(v.orderDeliveryQuery,o()({},this.searchContent,{pageNum:this.pageNum,pageSize:this.pageSize})).then(function(e){if(t.loading=!1,0!==e.code)throw new Error(e.msg);if(e.data&&e.data.result&&e.data.result.length){var a=!0,r=!1,l=void 0;try{for(var i,o=s()(e.data.result);!(a=(i=o.next()).done);a=!0){var n=i.value;n.redirectUrl="/order_mgt/detail/"+n.orderId}}catch(e){r=!0,l=e}finally{try{!a&&o.return&&o.return()}finally{if(r)throw l}}t.tableData=e.data.result}else t.tableData=[];t.total=e.data.total}).catch(function(e){t.loading=!1,t.$notify.error({title:"提示",message:e.message})})},showItem:function(e){var t=this;this.orderNo=e.orderId,this.iconLoading=!0,this.$http.post(v.orderDeliveryLogQuery,{orderNo:this.orderNo,DIFFCITY:!0}).then(function(e){if(t.dialogVisible=!0,t.iconLoading=!1,0!==e.code)throw new Error(e.msg);e.data&&e.data.length?t.orderDeliveryLogQuery=e.data:t.orderDeliveryLogQuery=[]}).catch(function(e){t.iconLoading=!1,t.$notify.error({title:"提示",message:e.message})})},exportHandel:function(){var e=this;this.exportLoading=!0,this.$http.post(v.orderDeliveryQuery,o()({},this.searchContent)).then(function(t){if(e.exportLoading=!1,0!==t.code)throw new Error(t.msg);if(t.data&&t.data.result&&t.data.result.length){var a=t.data.result,r=d.o(e.exportConfig,!1),l=d.o(e.exportConfig,!0);p.a.ExportJsonToExcel({header:r,filterVal:l,data:a,filename:d.u(Date.parse(new Date))+"_配送单"}),e.$notify.success({title:"温馨提示",message:d.u(Date.parse(new Date))+"_配送单导出成功"})}else e.$notify.warning({title:"温馨提示",message:"没有查询到您想要的数据，导出数据为空！"})}).catch(function(t){e.exportLoading=!1,e.$notify.error({title:"提示",message:t.message})})},datePickerRangeChange:function(e){this.searchContent.defaultRange=e?[].concat(l()(e)):e,this.searchContent.beginTime=e?e[0]:"",this.searchContent.endTime=e?e[1]:"",this.doSearchHandel(!0)},datePickerRangeChangeDelivery:function(e){this.searchContent.defaultRangeDelivery=e?[].concat(l()(e)):e,this.searchContent.deliveryBeginTime=e?e[0]:"",this.searchContent.deliveryEndTime=e?e[1]:"",this.doSearchHandel(!0)}}},f={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"search-form-wraper"},[a("el-form",{attrs:{model:e.searchContent,"label-position":"top"}},[a("el-form-item",{attrs:{label:"下单时间"}},[a("date-picker-range",{attrs:{defaultRange:e.searchContent.defaultRange},on:{datePickerRangeChange:e.datePickerRangeChange}})],1),e._v(" "),a("el-form-item",{attrs:{label:"送达时间"}},[a("date-picker-range",{attrs:{defaultRange:e.searchContent.defaultRangeDelivery},on:{datePickerRangeChange:e.datePickerRangeChangeDelivery}})],1),e._v(" "),a("el-form-item",{attrs:{label:"配送公司"}},[a("el-select",{staticClass:"search-input",attrs:{filterable:"",placeholder:"请选择配送公司",clearable:"",size:"small"},on:{change:function(t){return e.doSearchHandel(!0)}},model:{value:e.searchContent.logisticsCompanyCode,callback:function(t){e.$set(e.searchContent,"logisticsCompanyCode",t)},expression:"searchContent.logisticsCompanyCode"}},e._l(e.logisticsCompanyCodeOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"订单号"}},[a("el-input",{staticClass:"search-input",attrs:{placeholder:"请输入订单号",size:"small",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.doSearchHandel(!0)}},model:{value:e.searchContent.orderId,callback:function(t){e.$set(e.searchContent,"orderId","string"==typeof t?t.trim():t)},expression:"searchContent.orderId"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"配送状态"}},[a("el-select",{staticClass:"search-input",attrs:{filterable:"",placeholder:"请选择配送状态",clearable:"",size:"small"},on:{change:function(t){return e.doSearchHandel(!0)}},model:{value:e.searchContent.deliveryStatus,callback:function(t){e.$set(e.searchContent,"deliveryStatus",t)},expression:"searchContent.deliveryStatus"}},e._l(e.deliveryStatusOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"订单状态"}},[a("el-select",{staticClass:"search-input",attrs:{filterable:"",placeholder:"请选择配送状态",clearable:"",size:"small"},on:{change:function(t){return e.doSearchHandel(!0)}},model:{value:e.searchContent.orderStatus,callback:function(t){e.$set(e.searchContent,"orderStatus",t)},expression:"searchContent.orderStatus"}},e._l(e.orderStatusOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("region-city-store",{attrs:{showGroup:!1},on:{StoreGroupChange:e.StoreGroupChange}}),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.doSearchHandel(!0)}}},[e._v("搜索")]),e._v(" "),a("el-button",{attrs:{icon:e.exportLoading?"el-icon-loading":"el-icon-download",size:"mini"},on:{click:e.exportHandel}},[e._v("导出")])],1)],1)],1),e._v(" "),a("div",{staticClass:"table-wraper"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"fixed-height",staticStyle:{width:"100%"},attrs:{data:e.tableData,"empty-text":"没有查询到您想要的数据",size:"small"}},[a("el-table-column",{attrs:{"min-width":"70px",prop:"cityName",label:"城市"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"100px",prop:"storeName",label:"门店"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"178px",prop:"orderId",label:"订单号"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"order-id"},[a("router-link",{attrs:{to:t.row.redirectUrl,target:"_blank"}},[e._v(e._s(t.row.orderId))])],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{"min-width":"170px",prop:"expectedTime",label:"期望送达时间"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"90px",prop:"logisticsCompany",label:"配送公司"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"80px",prop:"deliveryStatusStr",label:"状态"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"80px",prop:"orderStatusStr",label:"订单状态"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"170px",prop:"orderCreateTime",label:"下单时间"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"170px",prop:"deliveryTime",label:"派单时间"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"170px",prop:"shipperAllocatedTime",label:"分配骑手时间"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"170px",prop:"shipperReceivedTime",label:"揽件时间"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"170px",prop:"shipperDeliveredTime",label:"送达/取消配送时间"}}),e._v(" "),a("el-table-column",{attrs:{align:"left",fixed:"right",label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-button",{attrs:{type:"text",size:"mini",icon:e.iconLoading&&t.row.orderId===e.orderNo?"el-icon-loading":"el-icon-view"},on:{click:function(a){return e.showItem(t.row)}}},[e._v("查看配送日志")])],1)]}}])})],1),e._v(" "),e.total>0?a("el-pagination",{staticClass:"tc mt20",attrs:{background:"","current-page":e.pageNum,"page-sizes":e.pageSizes,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.changeSize,"current-change":e.changeCurrent,"update:currentPage":function(t){e.pageNum=t},"update:current-page":function(t){e.pageNum=t}}}):e._e()],1),e._v(" "),a("el-dialog",{attrs:{title:"查看配送日志",visible:e.dialogVisible,width:"460px"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",{staticClass:"deli-order-detail-wrap"},[a("ul",e._l(e.orderDeliveryLogQuery,function(t,r){return a("li",{key:r,staticClass:"order-log-item-wrap"},[a("div",{staticClass:"log-cre-t-w"},[e._v(e._s(t.createTime))]),e._v(" "),a("div",{staticClass:"log-mesg-w"},[a("div",{staticClass:"log-s-w",class:0===r?"first-deli-str":""},[a("span",[e._v(e._s(t.deliveryStatusStr))]),e._v(" "),a("span",{staticClass:"deli-company-name"},[e._v(e._s(t.logisticsCompany))])])])])}),0)]),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"mini"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("关闭")])],1)])],1)},staticRenderFns:[]};var b=a("VU/8")(m,f,!1,function(e){a("qNEI")},null,null);t.default=b.exports},qNEI:function(e,t){}});
//# sourceMappingURL=79.2f0c5b76c451d955cbee.js.map