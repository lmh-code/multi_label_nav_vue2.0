webpackJsonp([116],{"0Csa":function(e,t){},wJl3:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("Dd8w"),n=a.n(s),o=a("oAV5"),r="/plateform/a/businessLog/list",i="/plateform/a/businessLog/listPage",l="/plateform/a/businessLog/getOperateTypeList",c={data:function(){return{loading:!1,detailMesgVisible:!1,pageNum:1,pageSize:20,total:0,searchContent:{startDate:"",endDate:"",user:"",moduleType:0,key:""},operateType:0,moduleTypes:[],operateTypes:[],tableData:[],detailMesg:"",operateTypeList:[]}},created:function(){this.searchContent.startDate=o.u((new Date).getTime())+" 00:00:00",this.searchContent.endDate=o.u((new Date).getTime())+" 23:59:59"},mounted:function(){this.getModuleType(),this.doSearchHandel(!0)},components:{},methods:{getSortList:function(e){return function(t,a){return t[e]-a[e]}},getRemList:function(e,t){var a=[],s=[];return e.forEach(function(e,n){-1==a.indexOf(e[t])&&(s.push(e),a.push(e[t]))}),s},getModuleType:function(){var e=this;this.$http.post(i).then(function(t){0!==t.code||t.data&&t.data.moduleTypeList&&t.data.opearteTypeList&&(e.moduleTypes=t.data.moduleTypeList.sort(e.getSortList("code")),e.operateTypeList=t.data.opearteTypeList.sort(e.getSortList("code")),e.operateTypes=e.getRemList(e.operateTypeList,"msg"))}).catch(function(t){e.$notify.error({title:"提示",message:t.msg})})},getOperateType:function(){var e=this;this.searchContent.moduleType?this.$http.get(l,{moduleType:this.searchContent.moduleType}).then(function(t){0!==t.code||t.data&&(e.operateType=0,e.operateTypes=t.data.sort(e.getSortList("code")),e.doSearchHandel(!0))}).catch(function(t){e.$notify.error({title:"提示",message:t.msg})}):this.$http.post(i).then(function(t){0!==t.code||t.data&&t.data.moduleTypeList&&t.data.opearteTypeList&&(e.moduleTypes=t.data.moduleTypeList.sort(e.getSortList("code")),e.operateType=0,e.operateTypeList=t.data.opearteTypeList.sort(e.getSortList("code")),e.operateTypes=e.getRemList(e.operateTypeList,"msg"),e.doSearchHandel(!0))}).catch(function(t){e.$notify.error({title:"提示",message:t.msg})})},changeSize:function(e){this.pageSize=e,this.doSearchHandel()},changeCurrent:function(e){this.pageNum=e,this.doSearchHandel()},doSearchHandel:function(e){var t=this;e&&(this.pageNum=1);var a=[];if(""!=this.operateType&&""==this.searchContent.moduleType){var s="";this.operateTypeList.forEach(function(e,a){e.code==t.operateType&&(s=e.msg)}),this.operateTypeList.forEach(function(e,t){e.msg==s&&a.push(e.code)})}else""!=this.operateType&&a.push(this.operateType);this.loading=!0,this.$http.post(r,n()({},this.searchContent,{operateTypes:a,pageNum:this.pageNum,pageSize:this.pageSize})).then(function(e){if(t.loading=!1,0===e.code)return e.data&&e.data.result&&e.data.result.length?t.tableData=e.data.result:t.tableData=[],void(t.total=e.data.total);throw new Error(e.msg)}).catch(function(e){t.loading=!1,t.$notify.error({title:"提示",message:e.message})})},showDetail:function(e){e&&(this.detailMesg=JSON.parse(e),this.detailMesgVisible=!0)}}},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"handel-search-wraper"},[a("div",{staticClass:"search-form-wraper"},[a("el-form",{attrs:{model:e.searchContent,"label-position":"top"}},[a("el-form-item",{attrs:{label:"操作开始时间"}},[a("el-date-picker",{staticClass:"search-date-picker",attrs:{type:"datetime",placeholder:"请选择操作开始时间",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss",size:"small",editable:!1,clearable:!1},on:{change:function(t){return e.doSearchHandel(!0)}},model:{value:e.searchContent.startDate,callback:function(t){e.$set(e.searchContent,"startDate",t)},expression:"searchContent.startDate"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"操作结束时间"}},[a("el-date-picker",{staticClass:"search-date-picker",attrs:{type:"datetime",placeholder:"请选择操作结束时间",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss",size:"small",editable:!1,clearable:!1},on:{change:function(t){return e.doSearchHandel(!0)}},model:{value:e.searchContent.endDate,callback:function(t){e.$set(e.searchContent,"endDate",t)},expression:"searchContent.endDate"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"操作人"}},[a("el-input",{staticClass:"search-input",attrs:{placeholder:"请输入用户名称",size:"small",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.doSearchHandel(!0)}},model:{value:e.searchContent.user,callback:function(t){e.$set(e.searchContent,"user","string"==typeof t?t.trim():t)},expression:"searchContent.user"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"操作模块"}},[a("el-select",{staticClass:"search-input",attrs:{filterable:"",placeholder:"请选择操作模块",clearable:"",size:"small"},on:{change:e.getOperateType},model:{value:e.searchContent.moduleType,callback:function(t){e.$set(e.searchContent,"moduleType",t)},expression:"searchContent.moduleType"}},e._l(e.moduleTypes,function(e){return a("el-option",{key:e.code,attrs:{label:e.msg,value:e.code}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"操作类型"}},[a("el-select",{staticClass:"search-input",attrs:{filterable:"",placeholder:"请选择操作类型",clearable:"",size:"small"},on:{change:function(t){return e.doSearchHandel(!0)}},model:{value:e.operateType,callback:function(t){e.operateType=t},expression:"operateType"}},e._l(e.operateTypes,function(e){return a("el-option",{key:e.code,attrs:{label:e.msg,value:e.code}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"操作主体"}},[a("el-input",{staticClass:"search-input",attrs:{placeholder:"输入商品id或门店编码",size:"small"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.doSearchHandel(!0)}},model:{value:e.searchContent.key,callback:function(t){e.$set(e.searchContent,"key","string"==typeof t?t.trim():t)},expression:"searchContent.key"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.doSearchHandel(!0)}}},[e._v("搜索")])],1)],1)],1)]),e._v(" "),a("div",{staticClass:"table-wraper"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"fixed-height",staticStyle:{width:"100%"},attrs:{data:e.tableData,"empty-text":"没有查询到您想要的数据",size:"small"}},[a("el-table-column",{attrs:{"min-width":"160",prop:"createTime",label:"操作时间"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"100",prop:"user",label:"操作人"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"100",prop:"moduleStr",label:"操作模块"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"100",prop:"operateStr",label:"操作类型"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"360",prop:"data",label:"详细信息"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"detail-flex"},[a("div",{staticClass:"detail-flex-words"},[e._v(e._s(t.row.data))]),e._v(" "),a("div",{staticClass:"detail-flex-click",on:{click:function(a){return e.showDetail(t.row.data)}}},[e._v("查看详细")])])]}}])})],1),e._v(" "),a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:e.tableData.length>0,expression:"tableData.length>0"}],staticClass:"tc mt20",attrs:{background:"","current-page":e.pageNum,"page-sizes":[20,50,100,150,200],layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.changeSize,"current-change":e.changeCurrent,"update:currentPage":function(t){e.pageNum=t},"update:current-page":function(t){e.pageNum=t}}})],1),e._v(" "),a("el-dialog",{attrs:{title:"详细信息",visible:e.detailMesgVisible,width:"50%"},on:{"update:visible":function(t){e.detailMesgVisible=t}}},[a("div",{staticClass:"dailog-data"},[a("pre",[e._v("        "+e._s(e.detailMesg)+"\n      ")])]),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){e.detailMesgVisible=!1}}},[e._v("关 闭")])],1)])],1)},staticRenderFns:[]};var p=a("VU/8")(c,d,!1,function(e){a("0Csa")},null,null);t.default=p.exports}});
//# sourceMappingURL=116.1870bd95c23891710f58.js.map