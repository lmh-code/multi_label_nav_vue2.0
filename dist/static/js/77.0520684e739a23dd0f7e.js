webpackJsonp([77],{"8u+N":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("Gu7T"),r=a.n(n),l=a("BO1k"),o=a.n(l),i=a("Dd8w"),s=a.n(i),c=a("oAV5"),u=a("FzCZ"),d="/member/a/shop/ideaFeedback/pageList",p={data:function(){return{loading:!1,pageNum:1,pageSize:10,total:0,searchContent:{ideaType:"",phone:"",defaultRange:[],startDateTime:"",endDateTime:"",onlyShowCity:0},tableData:[],ideaTypeOptions:[{value:"",label:"全部"},{value:1,label:"功能建议"},{value:2,label:"售后退款"},{value:3,label:"送货问题"},{value:4,label:"商家问题"},{value:5,label:"商品质量"},{value:6,label:"购买问题"},{value:7,label:"登录问题"},{value:99,label:"其他"}],onlyShowCityOptions:[{value:0,label:"否"},{value:1,label:"是"}],bigImgUrl:"",showDialog:!1,exportLoading:!1,exportConfig:{ideaTypeName:"问题类型",remark:"问题详情",leaderStr:"是否为团长",createTimeStr:"反馈时间",phone:"用户手机",vestStoreNo:"归属门店",memberId:"会员编码",memberPhone:"会员手机号",name:"姓名",sexStr:"性别"}}},mounted:function(){this.doSearchHandel(!0)},components:{"date-picker-range":a("XfvZ").a},methods:{changeSize:function(e){this.pageSize=e,this.doSearchHandel()},changeCurrent:function(e){this.pageNum=e,this.doSearchHandel()},doSearchHandel:function(e){var t=this;this.loading=!0,!0===e&&(this.pageNum=1),this.$http.post(d,s()({},this.searchContent,{pageNum:this.pageNum,pageSize:this.pageSize})).then(function(e){if(t.loading=!1,0!==e.code)throw new Error(e.msg);if(e.data&&e.data.result&&e.data.result.length){var a=!0,n=!1,r=void 0;try{for(var l,i=o()(e.data.result);!(a=(l=i.next()).done);a=!0){var s=l.value;s.createTimeStr=c.s(s.createTime),s.updateTimeStr=c.s(s.updateTime),s.remarkStr70=s.remark.substring(0,50),s.remark.length>50?s.isShowOpenBtn=!0:s.isShowOpenBtn=!1}}catch(e){n=!0,r=e}finally{try{!a&&i.return&&i.return()}finally{if(n)throw r}}t.tableData=e.data.result,t.total=e.data.total}else t.tableData=[],t.total=0}).catch(function(e){t.loading=!1,t.$notify.error({title:"提示",message:e.message})})},showBigImg:function(e){this.bigImgUrl=e,this.showDialog=!0},sexFormatter:function(e,t,a){return 0===a?"未知":1===a?"男":2===a?"女":"--"},exportHandel:function(){var e=this;this.exportLoading=!0,this.$http.post(d,s()({},this.searchContent,{pageNum:1,pageSize:5e3})).then(function(t){if(e.exportLoading=!1,0!==t.code)throw new Error(t.msg);if(t.data&&t.data.result&&t.data.result.length){var a=!0,n=!1,r=void 0;try{for(var l,i=o()(t.data.result);!(a=(l=i.next()).done);a=!0){var s=l.value;s.createTimeStr=c.s(s.createTime),s.updateTimeStr=c.s(s.updateTime),s.sexStr=0===s.sex?"未知":1===s.sex?"男":2===s.sex?"女":"--",s.leaderStr=s.leader?"是":"否"}}catch(e){n=!0,r=e}finally{try{!a&&i.return&&i.return()}finally{if(n)throw r}}var d=t.data.result;u.a.exportFileByConfig(d,c.u(Date.parse(new Date))+"_用户反馈.xlsx",e.exportConfig),e.$notify.success({title:"温馨提示",message:c.u(Date.parse(new Date))+"_用户反馈导出成功"})}else e.$notify.warning({title:"温馨提示",message:"没有查询到您想要的数据，导出数据为空！"})}).catch(function(t){e.exportLoading=!1,e.$notify.error({title:"提示",message:t.message})})},datePickerRangeChange:function(e){this.searchContent.defaultRange=e?[].concat(r()(e)):e,this.searchContent.startDateTime=e?e[0]:"",this.searchContent.endDateTime=e?e[1]:"",this.doSearchHandel(!0)}}},h={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"search-form-wraper"},[a("el-form",{attrs:{model:e.searchContent,"label-position":"top"},nativeOn:{submit:function(e){e.preventDefault()}}},[a("el-form-item",{attrs:{label:"问题类型"}},[a("el-select",{staticClass:"search-input",attrs:{filterable:"",placeholder:"请选择问题类型",clearable:"",size:"small"},on:{change:function(t){return e.doSearchHandel(!0)}},model:{value:e.searchContent.ideaType,callback:function(t){e.$set(e.searchContent,"ideaType",t)},expression:"searchContent.ideaType"}},e._l(e.ideaTypeOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"会员手机号"}},[a("el-input",{staticClass:"search-input",attrs:{placeholder:"会员手机号",size:"small",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.doSearchHandel(!0)}},model:{value:e.searchContent.phone,callback:function(t){e.$set(e.searchContent,"phone","string"==typeof t?t.trim():t)},expression:"searchContent.phone"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"反馈时间"}},[a("date-picker-range",{attrs:{defaultRange:e.searchContent.defaultRange},on:{datePickerRangeChange:e.datePickerRangeChange}})],1),e._v(" "),a("el-form-item",{attrs:{label:"仅查看本城市"}},[a("el-select",{staticClass:"search-input",attrs:{placeholder:"请选择",size:"small"},on:{change:function(t){return e.doSearchHandel(!0)}},model:{value:e.searchContent.onlyShowCity,callback:function(t){e.$set(e.searchContent,"onlyShowCity",t)},expression:"searchContent.onlyShowCity"}},e._l(e.onlyShowCityOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.doSearchHandel(!0)}}},[e._v("搜索")]),e._v(" "),a("el-popover",{attrs:{placement:"bottom-start",width:"250",trigger:"hover",content:"导出功能，最多导出5000条数据。"}},[a("el-button",{attrs:{slot:"reference",icon:e.exportLoading?"el-icon-loading":"el-icon-download",type:"primary",size:"mini"},on:{click:e.exportHandel},slot:"reference"},[e._v("导出")])],1)],1)],1)],1),e._v(" "),a("div",{staticClass:"table-wraper"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"fixed-height",staticStyle:{width:"100%"},attrs:{data:e.tableData,"empty-text":"没有查询到您想要的数据",size:"small"}},[a("el-table-column",{attrs:{width:"90px",prop:"ideaTypeName",label:"问题类型"}}),e._v(" "),a("el-table-column",{attrs:{label:"问题详情","min-width":"300px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("div",{staticClass:"remark-mesg-wrap"},[e._v("\n              "+e._s(t.row.remark)+"\n            ")])])]}}])}),e._v(" "),a("el-table-column",{attrs:{width:"230px",label:"问题图片"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",e._l(t.row.feedbackImageList,function(t,n){return a("img",{key:n,staticClass:"problem-img",attrs:{src:t,alt:"",onerror:"onerror=null;src='/shop/static/img_error.png'"},on:{click:function(a){return e.showBigImg(t)}}})}),0)]}}])}),e._v(" "),a("el-table-column",{attrs:{width:"100px",prop:"leader",label:"是否为团长"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v("\n            "+e._s(t.row.leader?"是":"否")+"\n          ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{width:"170px",prop:"createTimeStr",label:"反馈时间"}}),e._v(" "),a("el-table-column",{attrs:{width:"120px",prop:"phone",label:"用户手机"}}),e._v(" "),a("el-table-column",{attrs:{width:"100px",prop:"vestStoreNo",label:"归属门店"}}),e._v(" "),a("el-table-column",{attrs:{width:"100px",prop:"memberId",label:"会员编码"}}),e._v(" "),a("el-table-column",{attrs:{width:"120px",prop:"memberPhone",label:"会员手机号"}}),e._v(" "),a("el-table-column",{attrs:{width:"90px",prop:"name",label:"姓名"}}),e._v(" "),a("el-table-column",{attrs:{width:"90px",prop:"sex",label:"性别",formatter:e.sexFormatter}})],1),e._v(" "),e.total>0?a("el-pagination",{staticClass:"tc mt20",attrs:{background:"","current-page":e.pageNum,"page-sizes":[10,50,100,150,200],layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.changeSize,"current-change":e.changeCurrent,"update:currentPage":function(t){e.pageNum=t},"update:current-page":function(t){e.pageNum=t}}}):e._e()],1),e._v(" "),a("el-dialog",{attrs:{title:"查看大图",visible:e.showDialog,width:"400px"},on:{"update:visible":function(t){e.showDialog=t}}},[a("div",{staticStyle:{"text-align":"center"}},[a("img",{staticClass:"problem-img-large",attrs:{src:e.bigImgUrl,alt:"",onerror:"onerror=null;src='/shop/static/img_error.png'"}})]),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"mini"},on:{click:function(t){e.showDialog=!1}}},[e._v("关 闭")])],1)])],1)},staticRenderFns:[]};var m=a("VU/8")(p,h,!1,function(e){a("B+kt")},null,null);t.default=m.exports},"B+kt":function(e,t){}});
//# sourceMappingURL=77.0520684e739a23dd0f7e.js.map