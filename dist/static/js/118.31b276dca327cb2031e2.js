webpackJsonp([118],{LH6e:function(e,t){},c8Sl:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("Dd8w"),r=a.n(n),s=a("FzCZ"),i="/member/zt/giftCard/getGiftCardList",o="/member/zt/giftCard/abandon",l=/^[1-9]*[1-9][0-9]*$/,c={data:function(){return{exportLoading:!1,loading:!1,pageNum:1,pageSize:20,total:0,searchContent:{source:"shop",cardNoMin:null,cardNoMax:null,phone:null,cardType:-1,status:-1},tableData:[],cardTypeOptions:[{label:"全部",value:-1},{label:"余额",value:1},{label:"商品",value:2}],statusOptions:[{label:"全部",value:-1},{label:"未兑换",value:0},{label:"已兑换",value:1},{label:"已作废",value:2}],exportConfig:{cardNo:"卡号",phone:"会员手机号",name:"会员昵称",exchangeTime:"发放时间",cardCode:"兑换码",amount:"兑换价值",cardTypeStr:"兑换类型",updateTime:"操作时间",statusStr:"状态"}}},created:function(){},mounted:function(){this.doSearchHandel()},methods:{cardTypeFormater:function(e,t,a){return 1===a?"余额":2===a?"商品":void 0},statusFormater:function(e,t,a){return 0===a?"未兑换":1===a?"已兑换":2===a?"已作废":void 0},changeSize:function(e){this.pageSize=e,this.doSearchHandel()},changeCurrent:function(e){this.pageNum=e,this.doSearchHandel()},goAddPage:function(){this.$router.push("/recharge/add")},doSearchHandel:function(e){var t=this;if(this.searchContent.cardNoMin){if(!l.test(this.searchContent.cardNoMin))return void this.$message("卡号开始值为大于0的整数");if(this.searchContent.cardNoMin<=0)return void this.$message("卡号开始值为大于0的整数")}else this.searchContent.cardNoMin=null;if(this.searchContent.cardNoMax){if(!l.test(this.searchContent.cardNoMax))return void this.$message("卡号结束值为大于0的整数");if(this.searchContent.cardNoMax<=0)return void this.$message("卡号结束值为大于0的整数")}else this.searchContent.cardNoMax=null;this.searchContent.cardNoMin&&this.searchContent.cardNoMax&&this.searchContent.cardNoMin>=this.searchContent.cardNoMax?this.$message("卡号开始值必须小于卡号结束值"):(this.loading=!0,!0===e&&(this.pageNum=1),this.$http.post(i,r()({},this.searchContent,{pageNum:this.pageNum,pageSize:this.pageSize})).then(function(e){if(t.loading=!1,0===e.code)return e.data&&e.data.list&&e.data.list.length?t.tableData=e.data.list:t.tableData=[],void(e.data&&e.data.total?t.total=e.data.total:t.total=0);throw new Error(e.msg)}).catch(function(e){t.loading=!1,t.$notify.error({title:"提示(后台充值):",message:e.message})}))},exportData:function(){var e=this;if(this.searchContent.cardNoMin){if(!l.test(this.searchContent.cardNoMin))return void this.$message("卡号开始值为大于0的整数");if(this.searchContent.cardNoMin<=0)return void this.$message("卡号开始值为大于0的整数")}else this.searchContent.cardNoMin=null;if(this.searchContent.cardNoMax){if(!l.test(this.searchContent.cardNoMax))return void this.$message("卡号结束值为大于0的整数");if(this.searchContent.cardNoMax<=0)return void this.$message("卡号结束值为大于0的整数")}else this.searchContent.cardNoMax=null;this.searchContent.cardNoMin&&this.searchContent.cardNoMax&&this.searchContent.cardNoMin>=this.searchContent.cardNoMax?this.$message("卡号开始值必须小于卡号结束值"):(this.exportLoading=!0,this.$http.post(i,r()({},this.searchContent,{pageNum:1,pageSize:0})).then(function(t){if(e.exportLoading=!1,0!==t.code)throw new Error(t.msg);if(t.data&&t.data.list&&t.data.list.length){var a=t.data.list.map(function(e,t){switch(e.cardType){case 1:e.cardTypeStr="余额";break;case 2:e.cardTypeStr="商品";break;default:e.cardTypeStr=""}switch(e.status){case 0:e.statusStr="未兑换";break;case 1:e.statusStr="已兑换";break;case 2:e.statusStr="已作废";break;default:e.statusStr=""}return e});s.a.exportFileByConfig(a,"后台充值表.xlsx",e.exportConfig),setTimeout(function(){e.$message.success("导出成功")},500)}else e.$notify.warning({title:"温馨提示",message:"没有查询到要导出的数据"})}).catch(function(t){e.exportLoading=!1,e.$notify.error({title:"提示(导出数据)：",message:t.message})}))},deleteItem:function(e){var t=this,a=e.id;this.$confirm("您确定要执行作废操作吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$http.post(o,{id:a}).then(function(e){if(0===e.code)return t.$message.success("操作成功"),void t.doSearchHandel();throw new Error(e.msg)}).catch(function(e){t.$notify.error({title:"提示",message:e.message})})}).catch(function(){})}},beforeRouteLeave:function(e,t,a){t.meta.keepAlive=!1,a()}},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"handel-search-wraper"},[a("div",{staticClass:"handel-wraper"},[a("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-plus"},on:{click:e.goAddPage}},[e._v("新增充值")])],1),e._v(" "),a("hr",{staticClass:"s-slip"}),e._v(" "),a("div",{staticClass:"search-form-wraper"},[a("el-form",{attrs:{model:e.searchContent,"label-position":"top"}},[a("el-form-item",{attrs:{label:"卡号"}},[a("el-input",{staticClass:"search-input-small-width",attrs:{placeholder:"卡号开始",size:"small",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.doSearchHandel(!0)}},model:{value:e.searchContent.cardNoMin,callback:function(t){e.$set(e.searchContent,"cardNoMin","string"==typeof t?t.trim():t)},expression:"searchContent.cardNoMin"}}),e._v("\n          ~\n          "),a("el-input",{staticClass:"search-input-small-width",attrs:{placeholder:"卡号结束",size:"small",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.doSearchHandel(!0)}},model:{value:e.searchContent.cardNoMax,callback:function(t){e.$set(e.searchContent,"cardNoMax","string"==typeof t?t.trim():t)},expression:"searchContent.cardNoMax"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"会员手机号"}},[a("el-input",{staticClass:"search-input",attrs:{placeholder:"会员手机号",size:"small",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.doSearchHandel(!0)}},model:{value:e.searchContent.phone,callback:function(t){e.$set(e.searchContent,"phone","string"==typeof t?t.trim():t)},expression:"searchContent.phone"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"兑换类型"}},[a("el-select",{staticClass:"search-input",attrs:{filterable:"",placeholder:"兑换类型",size:"small"},on:{change:function(t){return e.doSearchHandel(!0)}},model:{value:e.searchContent.cardType,callback:function(t){e.$set(e.searchContent,"cardType",t)},expression:"searchContent.cardType"}},e._l(e.cardTypeOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"状态"}},[a("el-select",{staticClass:"search-input",attrs:{filterable:"",placeholder:"状态",size:"small"},on:{change:function(t){return e.doSearchHandel(!0)}},model:{value:e.searchContent.status,callback:function(t){e.$set(e.searchContent,"status",t)},expression:"searchContent.status"}},e._l(e.statusOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.doSearchHandel(!0)}}},[e._v("搜索")]),e._v(" "),a("el-button",{attrs:{size:"mini",loading:e.exportLoading},on:{click:e.exportData}},[e._v("导出")])],1)],1)],1)]),e._v(" "),a("div",{staticClass:"table-wraper"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"fixed-height",staticStyle:{width:"100%"},attrs:{data:e.tableData,"empty-text":"没有查询到您想要的数据",size:"small"}},[a("el-table-column",{attrs:{"min-width":"80px",prop:"cardNo",label:"卡号"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"120px",prop:"phone",label:"会员手机号"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"100px",prop:"name",label:"会员昵称"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"160px",prop:"exchangeTime",label:"发放时间"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"186px",prop:"cardCode",label:"兑换码"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"80px",prop:"amount",label:"兑换价值"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"80px",prop:"cardType",label:"兑换类型",formatter:e.cardTypeFormater}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"160px",prop:"updateTime",label:"操作时间"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"70px",prop:"status",label:"状态",formatter:e.statusFormater}}),e._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"90"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[0===t.row.status?a("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-delete"},on:{click:function(a){return e.deleteItem(t.row)}}},[e._v("作废")]):e._e()],1)]}}])})],1),e._v(" "),a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:e.tableData.length>0,expression:"tableData.length>0"}],staticClass:"tc mt20",attrs:{background:"","current-page":e.pageNum,"page-sizes":[20,50,100,150,200],layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.changeSize,"current-change":e.changeCurrent,"update:currentPage":function(t){e.pageNum=t},"update:current-page":function(t){e.pageNum=t}}})],1)])},staticRenderFns:[]};var u=a("VU/8")(c,d,!1,function(e){a("LH6e")},null,null);t.default=u.exports}});
//# sourceMappingURL=118.31b276dca327cb2031e2.js.map