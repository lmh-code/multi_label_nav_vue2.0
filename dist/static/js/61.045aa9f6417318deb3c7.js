webpackJsonp([61],{"/tLY":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("BO1k"),s=a.n(i),r=a("oAV5"),n={data:function(){return{tableData:[],scene:"",checkedList:[]}},methods:{setDefaultMesg:function(t){var e=t.tableData||[],a=!0,i=!1,r=void 0;try{for(var n,o=s()(e);!(a=(n=o.next()).done);a=!0){var l=n.value;l.copyUrl="pages/product/detail?id="+l.platformCityGoodsId+"&type=4&activityPlatCityGoodsId="+l.id}}catch(t){i=!0,r=t}finally{try{!a&&o.return&&o.return()}finally{if(i)throw r}}this.tableData=e,this.checkedList=t.checkedList||[],this.scene=t.scene||""},sfInStockHeader:function(){var t=this.$createElement;return t("el-popover",{attrs:{placement:"top-start",width:"260",trigger:"hover"}},[t("div",[t("p",["1、顺丰标品设为顺丰仓现货时，下单会校验仓库库存；"]),t("p",["2、本来鲜生鲜品无需设置；"])]),t("span",{slot:"reference"},["是否为顺丰仓现货",t("i",{class:"el-icon-question"})])])},onCopySuc:function(){this.$message.success("链接已复制至剪切板，仅限微信公众号中使用")},onCopyError:function(){this.$message.error("复制链接失败,请手动复制")}}},o={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{directives:[{name:"show",rawName:"v-show",value:t.tableData.length>0,expression:"tableData.length > 0"}]},[a("el-table",{ref:"multipleTable",staticClass:"fixed-height",staticStyle:{width:"100%"},attrs:{data:t.tableData,"empty-text":"暂无选中任何商品","max-height":"400",size:"small"}},[a("el-table-column",{attrs:{"min-width":"220px",label:"商品信息"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"ll-p-m-w"},[a("div",{staticClass:"ll-img-w"},[e.row.imgUrl&&""!=e.row.imgUrl?a("img",{attrs:{src:e.row.imgUrl,alt:"",onerror:"onerror=null;src='/shop/static/img_error.png'"}}):a("img",{attrs:{src:"/shop/static/img_error.png",alt:""}})]),t._v(" "),a("div",{staticClass:"ll-p-m-c-r"},[a("div",[t._v("\n                "+t._s(e.row.goodsName||"-")+"\n              ")]),t._v(" "),a("div",{staticClass:"ll-erp-p-no"},[t._v("SKU编码："+t._s(e.row.goodsNo||"--"))]),t._v(" "),a("div",{staticClass:"ll-erp-p-no"},[t._v("商品ID："+t._s(e.row.id))])])])]}}])}),t._v(" "),a("el-table-column",{attrs:{"min-width":"100px",prop:"spec",label:"规格"}}),t._v(" "),a("el-table-column",{attrs:{"min-width":"130px",label:"活动商品名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[t._v("\n            "+t._s(e.row.activityGoodsName||"-")+"\n          ")])]}}])}),t._v(" "),a("el-table-column",{attrs:{"min-width":"90px",prop:"price",label:"原价"}}),t._v(" "),a("el-table-column",{attrs:{"min-width":"110px",label:"活动价"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[t._v("\n            "+t._s(e.row.groupPrice)+"\n          ")])]}}])}),t._v(" "),a("el-table-column",{attrs:{"min-width":"150px",label:"限购数量(为空不限)"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[t._v("\n            "+t._s(e.row.limitGoodsCount)+"\n          ")])]}}])}),t._v(" "),a("el-table-column",{attrs:{"min-width":"110px",label:"活动库存"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[t._v("\n            "+t._s(e.row.curStock)+"\n          ")])]}}])}),t._v(" "),a("el-table-column",{attrs:{"min-width":"110px",label:"排序权重"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[t._v("\n            "+t._s(e.row.sortNum)+"\n          ")])]}}])}),t._v(" "),a("el-table-column",{attrs:{"min-width":"170px","render-header":t.sfInStockHeader},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[t._v(t._s(e.row.sfInStock?"是":"否"))])]}}])})],1),t._v(" "),t._m(0)],1)])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("span",{staticStyle:{color:"red"}},[this._v("*")]),this._v("注意：权重排序，先创建的活动商品在前；剩余的按前端规则走。\n    ")])}]},l="/plateform/a/activityRule/edit",c={data:function(){return{isDisabled:!1,addParamMesg:{id:"",activityId:"",regionCode:"",regionName:"",activityType:"",activityTypeName:"",activityName:"",activityStartDate:"",activityEndDate:"",activityCode:"",activityStoreList:[],activityStoreGroupList:[],activityScenes:[]},activeName:"first",scene:1,activityScenes:[{scene:1,activeName:"first",label:"第一场",activityStartTime:"",activityEndTime:"",platCityGoodsInfos:[],checkedList:[],discount:""},{scene:2,activeName:"second",label:"第二场",activityStartTime:"",activityEndTime:"",platCityGoodsInfos:[],checkedList:[],discount:""},{scene:3,activeName:"third",label:"第三场",activityStartTime:"",activityEndTime:"",platCityGoodsInfos:[],checkedList:[],discount:""},{scene:4,activeName:"fourth",label:"第四场",activityStartTime:"",activityEndTime:"",platCityGoodsInfos:[],checkedList:[],discount:""}],activityStoreGroupList:[{performanceDate:"",activityStoresCheckedList:[]}]}},created:function(){var t=this.$route.params.activityId;this.addParamMesg.activityId=t},mounted:function(){this.getDetail()},components:{"join-goods-table":a("VU/8")(n,o,!1,null,null,null).exports},methods:{getDetail:function(){var t=this,e=this.addParamMesg.activityId||"";r.r(),this.$http.post(l,{activityId:e}).then(function(e){if(r.c(),0!==e.code)throw new Error(e.msg);if(e.data){var a=e.data;if(t.addParamMesg.id=a.id,t.addParamMesg.activityId=a.id,t.addParamMesg.regionCode=a.regionCode||"",t.addParamMesg.regionName=a.regionName||"",t.addParamMesg.activityType=a.activityType||"",t.addParamMesg.activityTypeName=a.activityTypeName||"",t.addParamMesg.activityName=a.activityName||"",t.addParamMesg.activityStartDate=a.activityStartDate||"",t.addParamMesg.activityEndDate=a.activityEndDate||"",t.addParamMesg.activityCode=a.activityCode||"",a.storeVos&&a.storeVos.length&&(t.activityStoresCheckedList=a.storeVos),t.activityStoreGroupList=a.storeGroupVos&&a.storeGroupVos.length?a.storeGroupVos.map(function(t){return{performanceDate:t.performanceDatetime?t.performanceDatetime.substr(0,10):"",activityStoresCheckedList:t.storeVos}}):[{performanceDate:"",activityStoresCheckedList:[]}],a.activityScenes&&a.activityScenes.length){var i=a.activityScenes,n=!0,o=!1,l=void 0;try{for(var c,d=s()(t.activityScenes);!(n=(c=d.next()).done);n=!0){var v=c.value,m=!0,u=!1,y=void 0;try{for(var f,p=s()(i);!(m=(f=p.next()).done);m=!0){var h=f.value;v.scene===h.scene&&(v.activityStartTime=h.activityStartTime.slice(0,5),v.activityEndTime=h.activityEndTime.slice(0,5),v.platCityGoodsInfos=h.platCityGoodsVos)}}catch(t){u=!0,y=t}finally{try{!m&&p.return&&p.return()}finally{if(u)throw y}}}}catch(t){o=!0,l=t}finally{try{!n&&d.return&&d.return()}finally{if(o)throw l}}}t.setJoinGoodsMesg(t.scene)}}).catch(function(e){r.c(),t.$notify.error({title:"提示",message:e.message})})},handleTabClick:function(t){"first"==t.name?this.scene=1:"second"==t.name?this.scene=2:"third"==t.name?this.scene=3:"fourth"==t.name&&(this.scene=4),this.activeName=t.name,this.setJoinGoodsMesg(this.scene)},setJoinGoodsMesg:function(t){var e=[],a=[],i=!0,r=!1,n=void 0;try{for(var o,l=s()(this.activityScenes);!(i=(o=l.next()).done);i=!0){var c=o.value;c.scene===t&&(e=c.platCityGoodsInfos,a=c.checkedList)}}catch(t){r=!0,n=t}finally{try{!i&&l.return&&l.return()}finally{if(r)throw n}}var d={scene:t,checkedList:a,tableData:e};this.$refs.joinGoodsTable.setDefaultMesg(d)},doCancelHandel:function(){this.$router.push("/store_act")}},beforeRouteLeave:function(t,e,a){t.meta.keepAlive=!0,a()}},d={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"add-form-wraper"},[a("el-form",{ref:"form",attrs:{model:t.addParamMesg,"label-width":"140px"}},[a("el-form-item",{attrs:{label:"活动类型"}},[a("p",{staticStyle:{color:"#222","font-size":"16px","font-weight":"bold"}},[t._v(t._s(t.addParamMesg.activityTypeName))])]),t._v(" "),a("el-form-item",{attrs:{label:"选择区域"}},[a("p",[t._v(t._s(t.addParamMesg.regionName))])]),t._v(" "),a("el-form-item",{attrs:{label:"活动编码"}},[a("p",[t._v(t._s(t.addParamMesg.activityCode))])]),t._v(" "),a("el-form-item",{attrs:{label:"活动名称"}},[a("p",[t._v(t._s(t.addParamMesg.activityName))])]),t._v(" "),a("el-form-item",{attrs:{label:"开始时间"}},[a("p",[t._v(t._s(t.addParamMesg.activityStartDate))])]),t._v(" "),a("el-form-item",{attrs:{label:"结束时间"}},[a("p",[t._v(t._s(t.addParamMesg.activityEndDate))])]),t._v(" "),a("el-form-item",{attrs:{label:"门店/履约时间",required:""}},t._l(t.activityStoreGroupList,function(e,i){return a("div",{key:i,staticClass:"store-pre-time-item-wrap",class:i>0?"mt10":null},[a("div",{staticClass:"item-right"},[a("div",[a("span",[t._v("参与门店")]),t._v(" "),e.activityStoresCheckedList.length>0?a("div",[a("el-table",{staticClass:"fixed-height",attrs:{data:e.activityStoresCheckedList,"empty-text":"暂无选中任何门店","max-height":"250",size:"small"}},[a("el-table-column",{attrs:{"min-width":"226px",label:"门店编码/名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[t._v("\n                        "+t._s(e.row.erpStoreNo)+"_"+t._s(e.row.erpStoreName)+"\n                      ")])]}}],null,!0)}),t._v(" "),a("el-table-column",{attrs:{"min-width":"100",prop:"saleTypeName",label:"门店类型"}})],1)],1):t._e()]),t._v(" "),a("div",{staticClass:"mt10"},[a("span",[t._v("履约时间")]),t._v(" "),a("span",[t._v(t._s(e.performanceDate||"--"))])])])])}),0),t._v(" "),a("el-form-item",{attrs:{label:"参与商品"}},[a("el-tabs",{on:{"tab-click":t.handleTabClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[t._l(t.activityScenes,function(e,i){return a("el-tab-pane",{key:i,attrs:{name:e.activeName}},[a("span",{attrs:{slot:"label"},slot:"label"},[t._v("\n              "+t._s(e.label)+" \n              "),e.activityStartTime&&e.activityEndTime?a("span",[t._v("\n                "+t._s(e.activityStartTime)+"-"+t._s(e.activityEndTime)+"\n              ")]):t._e()])])}),t._v(" "),a("join-goods-table",{ref:"joinGoodsTable"})],2)],1),t._v(" "),a("hr",{staticClass:"s-slip-tb"}),t._v(" "),a("el-form-item",[a("el-button",{attrs:{size:"small"},on:{click:t.doCancelHandel}},[t._v("返回")])],1)],1)],1)])},staticRenderFns:[]};var v=a("VU/8")(c,d,!1,function(t){a("6N5h")},null,null);e.default=v.exports},"6N5h":function(t,e){}});
//# sourceMappingURL=61.045aa9f6417318deb3c7.js.map