webpackJsonp([36],{WNV7:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("Dd8w"),i=a.n(n),l=a("BO1k"),s=a.n(l),o=a("ssT3"),r=a("oAV5"),c=a("bzuE"),u=a("Gu7T"),h=a.n(u),d={data:function(){return{tableData:[],checkedList:[],activityTypeOptions:[{label:"全部",value:""},{label:"拼团",value:11},{label:"秒杀",value:21},{label:"包装折扣",value:31},{label:"新人专享",value:41},{label:"预售",value:51},{label:"每日爆款",value:61}],activityStatusOptions:[{label:"全部",value:""},{label:"进行中",value:3},{label:"未发布",value:0},{label:"未开始",value:2},{label:"已结束",value:4},{label:"已终止",value:5}]}},methods:{setDefaultMsg:function(t){this.tableData=t.tableData,this.checkedList=[]},shelfStatusFormatter:function(t,e,a,n){return 0===a?"上架":1===a?"下架":void 0},activityTypeFormatter:function(t,e,a,n){var i=this.activityTypeOptions.filter(function(t){return t.value===a})[0];return i?i.label:"--"},activityStatusFormatter:function(t,e,a,n){return 0===a?"未发布":1==a?"已发布":2==a?"未开始[发布中]":3==a?"进行中[发布中]":4==a?11===t.activityType?"已结束[发布中]":"已结束":5==a?"已终止":6==a?"已失效":void 0},updateShelfStatus:function(t,e){var a={row:t,shelfStatus:e};this.$emit("updateShelfStatus",a)},deleteItem:function(t){var e={row:t};this.$emit("deleteItem",e)},handleSelect:function(t,e){var a={},n=[];if(r.m(e.id,"id",this.checkedList))this.checkedList=r.q("id",e.id,this.checkedList);else{n.push(e);var i=[].concat(n,h()(this.checkedList));this.checkedList=i.reduceRight(function(t,e){return!a[e.id]&&(a[e.id]=t.push(e)),t},[])}},handleSelectAll:function(t){var e={};if(t.length>0){var a=!0,n=!1,i=void 0;try{for(var l,o=s()(t);!(a=(l=o.next()).done);a=!0){var c=l.value;this.checkedList.push(c)}}catch(t){n=!0,i=t}finally{try{!a&&o.return&&o.return()}finally{if(n)throw i}}this.checkedList=this.checkedList.reduceRight(function(t,a){return!e[a.id]&&(e[a.id]=t.push(a)),t},[])}else{var u=[],h=!0,d=!1,p=void 0;try{for(var f,v=s()(this.tableData);!(h=(f=v.next()).done);h=!0){var m=f.value;u.push(m)}}catch(t){d=!0,p=t}finally{try{!h&&v.return&&v.return()}finally{if(d)throw p}}var y=r.i(this.checkedList,u,"id");this.checkedList=y&&y.length>0?y:[]}},doBatchDelHandel:function(){var t={checkedList:this.checkedList};this.$emit("doBatchDelHandel",t)},batchUpdateShelfStatus:function(t){var e={shelfStatus:t,checkedList:this.checkedList};this.$emit("batchUpdateShelfStatus",e)}}},p={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"batch-handel-w"},[a("el-button",{staticClass:"sup-mini",attrs:{size:"mini",icon:"el-icon-upload2",disabled:0===t.checkedList.length},on:{click:function(e){return t.batchUpdateShelfStatus(0)}}},[t._v("上架")]),t._v(" "),a("el-button",{staticClass:"sup-mini",attrs:{size:"mini",icon:"el-icon-download",disabled:0===t.checkedList.length},on:{click:function(e){return t.batchUpdateShelfStatus(1)}}},[t._v("下架")]),t._v(" "),a("el-button",{staticClass:"sup-mini",attrs:{size:"mini",icon:"el-icon-delete",disabled:0===t.checkedList.length},on:{click:t.doBatchDelHandel}},[t._v("删除")])],1),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,"empty-text":"没有查询到您想要的数据",size:"small"},on:{select:t.handleSelect,"select-all":t.handleSelectAll}},[a("el-table-column",{attrs:{type:"selection",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{"min-width":"160px",label:"ID"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"ll-erp-p-no"},[t._v("活动ID: "+t._s(e.row.activityId))]),t._v(" "),a("div",{staticClass:"ll-erp-p-no"},[t._v("活动商品ID: "+t._s(e.row.activityPlatCityGoodsId))]),t._v(" "),a("div",{staticClass:"ll-erp-p-no"},[t._v("SKU编码："+t._s(e.row.goodsNo))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"门店信息","min-width":"130px"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[a("p",[t._v(t._s(e.row.storeName))]),t._v(" "),a("p",{staticClass:"erp-p-no"},[t._v("ERP编码："+t._s(e.row.storeNo))])])]}}])}),t._v(" "),a("el-table-column",{attrs:{"min-width":"250px",label:"商品信息"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"p-m-w"},[a("div",{staticClass:"img-w g-m-r"},[e.row.preSaleImageUrl&&""!=e.row.preSaleImageUrl?a("img",{attrs:{src:e.row.preSaleImageUrl,alt:"",onerror:"onerror=null;src='/shop/static/img_error.png'"}}):a("img",{attrs:{src:"/shop/static/img_error.png",alt:""}})]),t._v(" "),a("div",{staticClass:"p-m-c-r"},[a("div",[t._v("\n              "+t._s(e.row.goodsName||"-")+"\n            ")]),t._v(" "),a("div",{staticClass:"ll-erp-p-no"},[t._v("商品编码："+t._s(e.row.skuNo||"--"))]),t._v(" "),a("div",{staticClass:"ll-erp-p-no"},[t._v("区域商品ID："+t._s(e.row.platformCityGoodsId||"--"))])])])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"spec",label:"规格","min-width":"90px"}}),t._v(" "),a("el-table-column",{attrs:{prop:"price",label:"原价","min-width":"90px"}}),t._v(" "),a("el-table-column",{attrs:{prop:"preSalePrice",label:"活动价","min-width":"90px"}}),t._v(" "),a("el-table-column",{attrs:{"min-width":"90px",prop:"activityType",label:"活动类型",formatter:t.activityTypeFormatter}}),t._v(" "),a("el-table-column",{attrs:{"min-width":"120px",prop:"activityName",label:"活动名称"}}),t._v(" "),a("el-table-column",{attrs:{"min-width":"210px",label:"活动时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.activityStartDate&&e.row.activityEndDate?a("div",{staticClass:"date-wrap-inline"},[a("div",[a("p",[t._v(t._s(e.row.activityStartDate.substr(0,10)))]),t._v(" "),a("p",[t._v(t._s(e.row.activityStartDate.substr(11,8)))])]),t._v(" "),a("div",[t._v(" - ")]),t._v(" "),a("div",[a("p",[t._v(t._s(e.row.activityEndDate.substr(0,10)))]),t._v(" "),a("p",[t._v(t._s(e.row.activityEndDate.substr(11,8)))])])]):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{"min-width":"110px",prop:"pickUpStartDatetime",label:"履约时间"}}),t._v(" "),a("el-table-column",{attrs:{"min-width":"120px",prop:"activityStatus",label:"活动状态",formatter:t.activityStatusFormatter}}),t._v(" "),a("el-table-column",{attrs:{"min-width":"60px",prop:"shelfStatus",label:"状态",formatter:t.shelfStatusFormatter}}),t._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[1===e.row.shelfStatus?a("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-upload2"},on:{click:function(a){return t.updateShelfStatus(e.row,"0")}}},[t._v("上架")]):0===e.row.shelfStatus?a("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-download"},on:{click:function(a){return t.updateShelfStatus(e.row,"1")}}},[t._v("下架")]):t._e()],1),t._v(" "),a("div",[a("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-delete"},on:{click:function(a){return t.deleteItem(e.row)}}},[t._v("删除")])],1)]}}])})],1)],1)},staticRenderFns:[]};var f="/plateform/a/category/getCategoryTree",v="/plateform/a/preSale/storeGoods/listPage",m="/plateform/a/preSale/storeGoods/onShelf",y="/plateform/a/preSale/storeGoods/del",g={data:function(){return{pageSizes:c.a.pageSizes10,loading:!1,pageNum:1,pageSize:10,total:0,activeName:"all",searchContent:{DIFFCITY:!0,regionCode:o.a.get("regionCode")||"",activitySearchVal:"",shelfStatus:-1,storeGroupTypeNo:"",storeGroupNo:"",storeNo:"",categoryId:"",categoryIdList:[],activityType:"",activityStatus:"",goodsInfo:""},cateDefaultProps:{children:"categoryVoList",label:"categoryName",value:"categoryId"},activityTypeOptions:[{label:"全部",value:""},{label:"拼团",value:11},{label:"秒杀",value:21},{label:"新人专享",value:41},{label:"每日爆款",value:61}],activityStatusOptions:[{label:"全部",value:""},{label:"进行中",value:3},{label:"未发布",value:0},{label:"未开始",value:2},{label:"已结束",value:4},{label:"已终止",value:5}],categoryList:[],tableData:[],checkedList:[],topCardCount:{all:0,onShelfCount:0,offShelfCount:0}}},created:function(){this.getCategoryId()},mounted:function(){this.doSearchHandel(!0)},components:{"my-table":a("VU/8")(d,p,!1,function(t){a("fqyK")},null,null).exports,"region-city-store":a("32kd").a},methods:{StoreGroupChange:function(t){this.searchContent.regionCode=t.regionCode,this.searchContent.cityId=t.cityId,this.searchContent.storeNo=t.storeNo,this.searchContent.storeGroupTypeNo=t.storeGroupTypeNoList[0],this.searchContent.storeGroupNo=t.storeGroupTypeNoList[1],this.doSearchHandel(!0)},getCategoryId:function(){var t=this;this.$http.post(f,{DIFFCITY:!0}).then(function(e){if(0!==e.code)throw new Error(e.msg);if(e.data&&e.data.length){var a=!0,n=!1,i=void 0;try{for(var l,o=s()(e.data);!(a=(l=o.next()).done);a=!0){var r=l.value;r.categoryVoList&&0===r.categoryVoList.length&&(r.categoryVoList=null)}}catch(t){n=!0,i=t}finally{try{!a&&o.return&&o.return()}finally{if(n)throw i}}t.categoryList=e.data}else t.categoryList=[]}).catch(function(t){console.log("提示(三方平台店内分类):",t.message)})},handleTabClick:function(t){"all"==t.name?this.searchContent.shelfStatus=-1:"onShelf"==t.name?this.searchContent.shelfStatus=0:"downShelf"==t.name&&(this.searchContent.shelfStatus=1),this.activeName=t.name,this.doSearchHandel(!0)},changeSize:function(t){this.pageSize=t,this.doSearchHandel()},changeCurrent:function(t){this.pageNum=t,this.doSearchHandel()},doSearchHandel:function(t){var e=this,a=this.searchContent.categoryIdList.length-1;this.searchContent.categoryId=this.searchContent.categoryIdList[a],this.loading=!0,!0===t&&(this.pageNum=1),this.$http.post(v,i()({},this.searchContent,{pageSize:this.pageSize,pageNum:this.pageNum})).then(function(t){if(e.loading=!1,0===t.code){if(t.data&&t.data.goodsList&&t.data.goodsList.length){e.tableData=t.data.goodsList;var a={tableData:e.tableData};e.$refs.myTable&&e.$refs.myTable.setDefaultMsg(a)}else{e.tableData=[];var n={tableData:e.tableData};e.$refs.myTable&&e.$refs.myTable.setDefaultMsg(n)}return e.topCardCount.all=t.data.allCount||0,e.topCardCount.onShelfCount=t.data.onShelfCount||0,e.topCardCount.offShelfCount=t.data.offShelfCount||0,void(e.total=t.data.total||0)}throw new Error(t.msg)}).catch(function(t){e.loading=!1,e.$notify.error({title:"提示",message:t.message})})},updateShelfStatus:function(t){var e=this,a=[];a.push(t.row.id);var n=-1,i="";0==t.shelfStatus?(n=0,i="上架"):1==t.shelfStatus&&(n=1,i="下架"),this.$confirm("确定要执行("+i+")操作吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){r.r(),e.$http.post(m,{ids:a,shelfStatus:n,DIFFCITY:!0}).then(function(t){if(r.c(),0===t.code)return 0===n?e.$message.success("上架成功"):1===n&&e.$message.success("下架成功"),void e.doSearchHandel();throw new Error(t.msg)}).catch(function(t){r.c(),e.$notify.error({title:"提示",message:t.message})})}).catch(function(){})},deleteItem:function(t){var e=this,a=[],n={id:t.row.id,activityType:t.row.activityType};a.push(n),this.$confirm("确定要执行删除操作吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){r.r(),e.$http.post(y,{idAndActivityTypeList:a,DIFFCITY:!0}).then(function(t){if(r.c(),0===t.code)return e.$message.success("删除成功"),void e.doSearchHandel(!0);throw new Error(t.msg)}).catch(function(t){r.c(),e.$notify.error({title:"提示",message:t.message})})}).catch(function(){})},doBatchDelHandel:function(t){var e=this;if(t.checkedList&&(this.checkedList=t.checkedList),0!==this.checkedList.length){var a=this.checkedList.map(function(t){return{id:t.id,activityType:t.activityType}});this.$confirm("确定要执行批量删除操作吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){r.r(),e.$http.post(y,{idAndActivityTypeList:a,DIFFCITY:!0}).then(function(t){if(r.c(),0===t.code)return e.$message.success("批量删除成功"),void e.doSearchHandel(!0);throw new Error(t.msg)}).catch(function(t){r.c(),e.$notify.error({title:"提示",message:t.message})})}).catch(function(){})}else this.$message("请选择商品")},batchUpdateShelfStatus:function(t){var e=this;if(t.checkedList&&(this.checkedList=t.checkedList),0!==this.checkedList.length){var a=this.checkedList.map(function(t){return t.id}),n=-1,i="";0==t.shelfStatus?(n=0,i="上架"):1==t.shelfStatus&&(n=1,i="下架"),this.$confirm("确定要执行批量("+i+")操作吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){r.r(),e.$http.post(m,{ids:a,shelfStatus:n,DIFFCITY:!0}).then(function(t){if(r.c(),0===t.code)return 0===n?e.$message.success("批量上架成功"):1===n&&e.$message.success("批量下架成功"),void e.doSearchHandel();throw new Error(t.msg)}).catch(function(t){r.c(),e.$notify.error({title:"提示",message:t.message})})}).catch(function(){})}else this.$message("请选择商品")}}},b={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"search-form-wraper"},[a("el-form",{attrs:{model:t.searchContent,"label-position":"top"}},[a("region-city-store",{on:{StoreGroupChange:t.StoreGroupChange}}),t._v(" "),a("el-form-item",{attrs:{label:"商品分类"}},[a("el-cascader",{staticClass:"search-input",attrs:{placeholder:"请选择分类",options:t.categoryList,"change-on-select":"",size:"small",clearable:"",filterable:"",props:t.cateDefaultProps},on:{change:function(e){return t.doSearchHandel(!0)}},model:{value:t.searchContent.categoryIdList,callback:function(e){t.$set(t.searchContent,"categoryIdList",e)},expression:"searchContent.categoryIdList"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"SKU编码/商品名称"}},[a("el-input",{staticClass:"search-input",attrs:{placeholder:"SKU编码/商品名称",size:"small",clearable:""},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.doSearchHandel(!0)}},model:{value:t.searchContent.goodsInfo,callback:function(e){t.$set(t.searchContent,"goodsInfo","string"==typeof e?e.trim():e)},expression:"searchContent.goodsInfo"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"活动ID/名称"}},[a("el-input",{staticClass:"search-input",attrs:{placeholder:"活动ID/名称",size:"small",clearable:""},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.doSearchHandel(!0)}},model:{value:t.searchContent.activitySearchVal,callback:function(e){t.$set(t.searchContent,"activitySearchVal","string"==typeof e?e.trim():e)},expression:"searchContent.activitySearchVal"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"活动类型"}},[a("el-select",{staticClass:"search-input",attrs:{filterable:"",placeholder:"请选择活动类型",size:"small",clearable:""},on:{change:function(e){return t.doSearchHandel(!0)}},model:{value:t.searchContent.activityType,callback:function(e){t.$set(t.searchContent,"activityType",e)},expression:"searchContent.activityType"}},t._l(t.activityTypeOptions,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"状态"}},[a("el-select",{staticClass:"search-input",attrs:{filterable:"",placeholder:"请选择状态",size:"small",clearable:""},on:{change:function(e){return t.doSearchHandel(!0)}},model:{value:t.searchContent.activityStatus,callback:function(e){t.$set(t.searchContent,"activityStatus",e)},expression:"searchContent.activityStatus"}},t._l(t.activityStatusOptions,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.doSearchHandel(!0)}}},[t._v("搜索")])],1)],1)],1),t._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"table-wraper tab-wraper"},[a("el-tabs",{on:{"tab-click":t.handleTabClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[a("el-tab-pane",{attrs:{name:"all"}},[a("span",{attrs:{slot:"label"},slot:"label"},[t._v("全部 "+t._s(this.topCardCount.all))])]),t._v(" "),a("el-tab-pane",{attrs:{name:"onShelf"}},[a("span",{attrs:{slot:"label"},slot:"label"},[t._v("上架中 "+t._s(this.topCardCount.onShelfCount))])]),t._v(" "),a("el-tab-pane",{attrs:{name:"downShelf"}},[a("span",{attrs:{slot:"label"},slot:"label"},[t._v("已下架 "+t._s(this.topCardCount.offShelfCount))])]),t._v(" "),a("my-table",{ref:"myTable",on:{updateShelfStatus:t.updateShelfStatus,deleteItem:t.deleteItem,doBatchDelHandel:t.doBatchDelHandel,batchUpdateShelfStatus:t.batchUpdateShelfStatus}})],1)],1),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.tableData.length>0,expression:"tableData.length > 0"}],staticClass:"pagination"},[a("el-pagination",{attrs:{background:"","current-page":t.pageNum,"page-sizes":t.pageSizes,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.changeSize,"current-change":t.changeCurrent,"update:currentPage":function(e){t.pageNum=e},"update:current-page":function(e){t.pageNum=e}}})],1)])},staticRenderFns:[]};var S=a("VU/8")(g,b,!1,function(t){a("ouIU")},null,null);e.default=S.exports},fqyK:function(t,e){},ouIU:function(t,e){}});
//# sourceMappingURL=36.827581677faa4c905893.js.map