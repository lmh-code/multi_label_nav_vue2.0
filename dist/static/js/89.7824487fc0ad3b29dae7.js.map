{"version":3,"sources":["webpack:///src/components/Activity/DisCoupon/Add/AddConsumption.vue","webpack:///./src/components/Activity/DisCoupon/Add/AddConsumption.vue?75f9","webpack:///./src/components/Activity/DisCoupon/Add/AddConsumption.vue"],"names":["reqUrl","AddConsumption","data","isDisabled","addParamMesg","triggerType","triggerTypeName","cardType","title","beginTime","endTime","triggerSaleType","triggerSource","triggerTimesType","triggerSourceRadio","value","label","triggerAmount","triggerTimesTypeRadio","setDisableTime","disabledDate","time","getTime","Date","now","created","mounted","components","store-template","TemplateStore","prom-type-template","TemplatePromType","methods","changeStore","val","key","this","changePromType","promReqs","console","log","formattData","_this","countReg","countRegtofixed","$message","length","utils","test","timesType","triggerIntervalDays","useType","undefined","useBeginTime","useEndTime","useDayCount","disCount","disIsnull","promDiscounts","forEach","item","goodCount","goodIsnull","every","meetAmount","discAmount","sendPromCount","parseInt","needPayAmount","goodsNo","productQtyLimit","splice","doSaveHandel","_this2","$set","triggerOnlineGoodsType","$http","post","extends_default","then","res","setTimeout","code","success","$router","push","Error","msg","catch","e","$notify","error","message","doCancelHandel","_this3","$confirm","confirmButtonText","cancelButtonText","type","Add_AddConsumption","render","_vm","_h","$createElement","_c","_self","staticClass","ref","attrs","model","label-width","required","staticStyle","color","font-size","font-weight","_v","_s","size","placeholder","clearable","callback","$$v","expression","picker-options","_l","slot","on","disabled","click","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/89.7824487fc0ad3b29dae7.js","sourcesContent":["<style scoped>\r\n.trigger-radio.el-radio {\r\n  display: block;\r\n  margin-top: 6px;\r\n}\r\n.trigger-radio.el-radio+.el-radio {\r\n  margin-left: 0px;\r\n}\r\n.el-form-item__content .trigger-radio .el-input-group{\r\n  vertical-align: middle;\r\n}\r\n</style>\r\n<template>\r\n  <div>\r\n    <div class=\"add-form-wraper\">\r\n      <el-form ref=\"form\" :model=\"addParamMesg\" label-width=\"140px\">\r\n        <el-form-item label=\"活动类型\" required>\r\n          <p style=\"color: #222;font-size: 16px; font-weight: bold;\">{{addParamMesg.triggerTypeName}}</p>\r\n        </el-form-item>\r\n        <el-form-item label=\"活动名称\" required>\r\n          <el-input v-model=\"addParamMesg.title\" size=\"small\" class=\"add-input\" placeholder=\"请输入活动名称\" clearable></el-input>\r\n          <span>活动名称,限制30个汉字</span>\r\n        </el-form-item>\r\n        <el-form-item label=\"活动开始日期\" required>\r\n          <el-date-picker\r\n            class=\"add-input\"\r\n            v-model=\"addParamMesg.beginTime\"\r\n            type=\"date\"\r\n            placeholder=\"请选择活动开始日期\"\r\n            :picker-options=\"setDisableTime\"\r\n            size=\"small\">\r\n          </el-date-picker>\r\n          <span>活动开始日期</span>\r\n        </el-form-item>\r\n        <el-form-item label=\"活动结束日期\" required>\r\n          <el-date-picker\r\n            class=\"add-input\"\r\n            v-model=\"addParamMesg.endTime\"\r\n            type=\"date\"\r\n            placeholder=\"请选择活动结束日期\"\r\n            :picker-options=\"setDisableTime\"\r\n            size=\"small\">\r\n          </el-date-picker>\r\n          <span>活动结束日期</span>\r\n        </el-form-item>\r\n        <el-form-item label=\"设置条件\">\r\n          <el-radio-group v-model=\"addParamMesg.triggerSource\">\r\n            <el-radio class=\"trigger-radio\"\r\n              v-for=\"item in triggerSourceRadio\"\r\n              :key=\"item.value\"\r\n              :label=\"item.value\">\r\n              {{item.label}}\r\n              <el-input class=\"coupon-input\" size=\"small\" v-model=\"item.triggerAmount\">\r\n                <template slot=\"append\">元</template>\r\n              </el-input>\r\n            </el-radio>\r\n          </el-radio-group>\r\n        </el-form-item>\r\n        <el-form-item label=\"设置发放频率\">\r\n          <el-radio-group v-model=\"addParamMesg.triggerTimesType\">\r\n            <el-radio \r\n              v-for=\"item in triggerTimesTypeRadio\"\r\n              :key=\"item.value\"\r\n              :label=\"item.value\">\r\n              {{item.label}}\r\n            </el-radio>\r\n          </el-radio-group>\r\n        </el-form-item>\r\n\r\n        <!-- 门店 -->\r\n        <store-template @changeStore=\"changeStore\"></store-template>\r\n        <!-- 卡券形式 满减券 商品券 -->\r\n        <prom-type-template @changePromType=\"changePromType\" :triggerType=\"addParamMesg.triggerType\"></prom-type-template>\r\n\r\n        <el-form-item>\r\n          <el-button type=\"primary\" size=\"small\" @click=\"doSaveHandel\" :disabled=\"isDisabled\">保存</el-button>\r\n          <el-button size=\"small\" @click=\"doCancelHandel\">取消</el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\n  import * as utils from '@/utils/utils'\r\n  import TemplateStore from \"../AddTemplate/TemplateStore\"\r\n  import TemplatePromType from \"../AddTemplate/TemplatePromType\"\r\n\r\n  const reqUrl = {\r\n    // 新增活动规则\r\n    batchAddProm: \"/member/erp/prom/batchAddProm\"\r\n  }\r\n  export default {\r\n    data() {\r\n      return {\r\n        isDisabled: false,\r\n        addParamMesg: {\r\n          triggerType: 71,\r\n          triggerTypeName: '消费发放',\r\n          cardType: 2,\r\n          title: '',\r\n          beginTime: '',\r\n          endTime: '',\r\n          triggerSaleType: 1,\r\n          triggerSource: 0,\r\n          triggerTimesType: 0,\r\n        },\r\n        triggerSourceRadio: [\r\n          {\r\n            value: 1,\r\n            label: '单笔门店消费:',\r\n            triggerAmount: ''\r\n          },\r\n          {\r\n            value: 2,\r\n            label: '单笔商城消费:',\r\n            triggerAmount: ''\r\n          }\r\n        ],\r\n        triggerTimesTypeRadio: [\r\n          {\r\n            value: 0, \r\n            label: '无限制'\r\n          },\r\n          {\r\n            value: 1, \r\n            label: '整个活动只发放一次'\r\n          },\r\n          {\r\n            value: 2, \r\n            label: '每天一次'\r\n          },\r\n          {\r\n            value: 3, \r\n            label: '每周一次'\r\n          }\r\n        ],\r\n        setDisableTime: {\r\n          disabledDate(time) {\r\n            return time.getTime() < Date.now() - 8.64e7;\r\n          }\r\n        }\r\n\r\n      }\r\n    },\r\n    created() {\r\n\r\n    },\r\n    mounted() {\r\n      \r\n    },\r\n    components: {\r\n      \"store-template\": TemplateStore,\r\n      \"prom-type-template\": TemplatePromType\r\n    },\r\n    methods: {\r\n      changeStore(val) {\r\n        // 传值\r\n        if(val) {\r\n          for(let key in val) {\r\n            this.addParamMesg[key] = val[key]\r\n          }\r\n        }\r\n      },\r\n      changePromType(val) {\r\n        this.addParamMesg.promReqs = val\r\n        console.log(val)\r\n      },\r\n      /**\r\n       * [formattData 数据格式化]\r\n       * @return {[type]} [description]\r\n       */\r\n      formattData() {\r\n        let countReg = /^\\+?[1-9][0-9]*$/;\r\n        let countRegtofixed = /(^[1-9]{1}[0-9]*$)|(^[0-9]*\\.[0-9]{1}$)|(^[0-9]*\\.[0-9]{2}$)/\r\n        // 活动名称 日期\r\n        if(!this.addParamMesg.title) {\r\n          this.$message(\"请输入活动名称\")\r\n          return false\r\n        }else if(this.addParamMesg.title.length > 30) {\r\n          this.$message(\"活动名称限制30个汉字\")\r\n          return false\r\n        }\r\n        if(this.addParamMesg.beginTime == \"\") {\r\n          this.$message(\"请选择活动开始日期\")\r\n          return false\r\n        }else {\r\n          this.addParamMesg.beginTime = utils.timestampToTimeNoHMS(new Date(this.addParamMesg.beginTime).getTime()) + ' 00:00:00'\r\n        }\r\n        if(this.addParamMesg.endTime == \"\") {\r\n          this.$message(\"请选择活动结束日期\")\r\n          return false\r\n        }else {\r\n          this.addParamMesg.endTime = utils.timestampToTimeNoHMS(new Date(this.addParamMesg.endTime).getTime()) + ' 23:59:59'\r\n        }\r\n        if(new Date(this.addParamMesg.endTime).getTime() <= new Date(this.addParamMesg.beginTime).getTime()) {\r\n          this.$message(\"活动结束日期不能早于或等于开始日期\")\r\n          return false\r\n        }\r\n        if(this.addParamMesg.triggerSource === 0) {\r\n          this.$message('请设置单笔消费金额')\r\n          return false\r\n        }else if(this.addParamMesg.triggerSource === 1) {\r\n          if(countRegtofixed.test(this.triggerSourceRadio[0].triggerAmount) === false) {\r\n              this.$message('设置单笔门店消费金额有误')\r\n              return false\r\n          }\r\n        }else if(this.addParamMesg.triggerSource === 2) {\r\n          if(countRegtofixed.test(this.triggerSourceRadio[1].triggerAmount) === false) {\r\n              this.$message('设置单笔商城消费金额有误')\r\n              return false\r\n          }\r\n        }\r\n        if(this.addParamMesg.triggerTimesType === \"\" ) {\r\n          this.$message(\"请选择发放频率\")\r\n          return false\r\n        }\r\n        let timesType = this.addParamMesg.triggerTimesType \r\n        if(timesType === 2) {\r\n          this.addParamMesg.triggerIntervalDays = 1\r\n        }else if(timesType === 3) {\r\n          this.addParamMesg.triggerIntervalDays = 7\r\n        }\r\n        // 卡券有效时间\r\n        if(this.addParamMesg.useType === \"\" || this.addParamMesg.useType === undefined) {\r\n          this.$message(\"请选择卡券有效时间\")\r\n          return false\r\n        }else if(this.addParamMesg.useType === 1) {\r\n          if(this.addParamMesg.useBeginTime == \"\") {\r\n            this.$message(\"请选择卡券有效开始日期\")\r\n            return false\r\n          }else {\r\n            this.addParamMesg.useBeginTime = utils.timestampToTimeNoHMS(new Date(this.addParamMesg.useBeginTime).getTime()) + ' 00:00:00'\r\n          }\r\n          if(this.addParamMesg.useEndTime == \"\") {\r\n            this.$message(\"请选择卡券有效结束日期\")\r\n            return false\r\n          }else {\r\n            this.addParamMesg.useEndTime = utils.timestampToTimeNoHMS(new Date(this.addParamMesg.useEndTime).getTime()) + ' 23:59:59'\r\n          }\r\n          if(new Date(this.addParamMesg.useEndTime).getTime() <= new Date(this.addParamMesg.useBeginTime).getTime()) {\r\n            this.$message(\"卡券有效结束日期不能早于或等于开始日期\")\r\n            return false\r\n          }\r\n          if(new Date(this.addParamMesg.useEndTime).getTime() < new Date(this.addParamMesg.endTime).getTime()) {\r\n            this.$message(\"卡券有效结束日期不能早于活动结束时间\")\r\n            return false\r\n          }\r\n          delete this.addParamMesg['useDayCount']\r\n        }else if(this.addParamMesg.useType === 2) {\r\n          if(this.addParamMesg.useDayCount == \"\") {\r\n            this.$message(\"卡券有效使用天数不能为空\")\r\n            return false\r\n          }\r\n          if(countReg.test(this.addParamMesg.useDayCount) == false) {\r\n            this.$message(\"卡券有效使用天数为大于零的整数\");\r\n            return false\r\n          }\r\n          delete this.addParamMesg['useBeginTime']\r\n          delete this.addParamMesg['useEndTime']\r\n        }\r\n\r\n\r\n        // 满减券\r\n        let disCount = this.addParamMesg.promReqs[0]\r\n        let disIsnull = true\r\n        if(disCount && disCount.promDiscounts && disCount.promDiscounts.length > 0) {\r\n          disCount.promDiscounts.forEach(item => {\r\n            for(let key in item) {\r\n              if((key == 'discAmount' || key == 'meetAmount' || key == 'sendPromCount') && item[key] != '') {\r\n                disIsnull = false\r\n              }\r\n            }        \r\n          })\r\n        }\r\n        // 商品券\r\n        let goodCount = this.addParamMesg.promReqs[1]\r\n        let goodIsnull = true\r\n        if(goodCount && goodCount.promDiscounts && goodCount.promDiscounts.length > 0) {\r\n          goodCount.promDiscounts.forEach(item => {\r\n            for(let key in item) {\r\n              if((key == 'range' || key == 'goodsType' || key == 'needPayAmount' || key == 'goodsNo' || key == 'sendPromCount') && item[key] != '') {\r\n                goodIsnull = false\r\n              }\r\n            }        \r\n          })\r\n        }\r\n        \r\n        if(disIsnull && goodIsnull) {\r\n          this.$message('请设置满减券卡券奖励')\r\n          return false\r\n        }\r\n        if(disIsnull == false) {\r\n          let dis = disCount && disCount.promDiscounts ? disCount.promDiscounts.every(item => {\r\n            if(item.meetAmount == '' || item.discAmount == '' || item.sendPromCount == '') {\r\n              this.$message(\"满减券卡券奖励-满减金额或张数不能为空\");\r\n              return false\r\n            }else if(countRegtofixed.test(item.meetAmount) === false || countRegtofixed.test(item.discAmount) === false) {\r\n              this.$message(\"满减券卡券奖励-满减金额大于零的数字，允许输入两位小数\");\r\n              return false\r\n            }else if(countReg.test(item.sendPromCount) === false) {\r\n              this.$message(\"满减券卡券奖励-满减金额或张数为大于零的整数\");\r\n              return false\r\n            }else if(parseInt(item.meetAmount) < parseInt(item.discAmount)) {\r\n              this.$message(\"满减券卡券奖励-减金额不能大于满金额\");\r\n              return false\r\n            }\r\n\r\n            if(this.addParamMesg.triggerSource == 1) {\r\n              item.triggerAmount = this.triggerSourceRadio[0].triggerAmount\r\n              this.addParamMesg.triggerAmount = this.triggerSourceRadio[0].triggerAmount\r\n            }else if(this.addParamMesg.triggerSource == 2) {\r\n              item.triggerAmount = this.triggerSourceRadio[1].triggerAmount\r\n              this.addParamMesg.triggerAmount = this.triggerSourceRadio[1].triggerAmount\r\n            }\r\n            return true\r\n          }) : false\r\n          if(dis == false) {\r\n            return false\r\n          }\r\n        }\r\n        if(goodIsnull == false) {\r\n          let good = goodCount && goodCount.promDiscounts ? goodCount.promDiscounts.every(item => {\r\n            if(item.needPayAmount == '' || item.needPayAmount == undefined) {\r\n              this.$message('商品券卡券奖励-商品应付价格不能为空')\r\n              return false\r\n            }else {\r\n              if(item.needPayAmount != 0 && !countRegtofixed.test(item.needPayAmount)) {\r\n                this.$message('商品券卡券奖励-商品应付价格输入大于等于0的数字，允许输入一位小数。')\r\n                return false\r\n              }\r\n            }\r\n            if(item.goodsNo == '' || item.goodsNo == undefined) {\r\n              this.$message('商品券卡券奖励-请选择商品')\r\n              return false\r\n            }\r\n            if(item.productQtyLimit == '' || item.productQtyLimit == undefined) {\r\n              this.$message('商品券卡券奖励-请输入选择商品数量小于等于的值')\r\n              return false\r\n            }else {\r\n              if(!countReg.test(item.productQtyLimit)) {\r\n                this.$message('商品券卡券奖励-选择商品数量小于等于的值格式不对，为大于零的整数')\r\n                return false\r\n              }\r\n            }\r\n            if(item.sendPromCount === '' || item.sendPromCount == undefined) {\r\n              this.$message('商品券卡券奖励-请输入发放优惠券数量')\r\n              return false\r\n            }else { \r\n              if(!countReg.test(item.sendPromCount)) {\r\n                this.$message('商品券卡券奖励-发放优惠券数量为大于零的整数')\r\n                return false\r\n              }\r\n            }\r\n\r\n            if(this.addParamMesg.triggerSource == 1) {\r\n              item.triggerAmount = this.triggerSourceRadio[0].triggerAmount\r\n            }else if(this.addParamMesg.triggerSource == 2) {\r\n              item.triggerAmount = this.triggerSourceRadio[1].triggerAmount\r\n            }\r\n\r\n            return true\r\n          }) : false\r\n          if(good == false) {\r\n            return false\r\n          }\r\n        }\r\n        // 删除空的满减券或者商品券\r\n        if(disIsnull == true) {\r\n          this.addParamMesg.promReqs.splice(0,1)\r\n        }\r\n        if(goodIsnull == true) {\r\n          this.addParamMesg.promReqs.splice(1,1)\r\n        }\r\n        return true\r\n      },\r\n      /**\r\n       * [doSaveHandel 保存]\r\n       * @return {[type]} [description]\r\n       */\r\n      doSaveHandel() {\r\n        if(this.formattData() === false) {\r\n          return\r\n        }\r\n        // 商品类型传3、4、5\r\n        if(this.addParamMesg.promReqs[0]) {\r\n          this.$set(this.addParamMesg.promReqs[0], 'onlineGoodsType', '3;4;5')\r\n        }\r\n        if(this.addParamMesg.promReqs[1]) {\r\n          this.$set(this.addParamMesg.promReqs[1], 'onlineGoodsType', '3;4;5')\r\n        }\r\n        this.addParamMesg.triggerOnlineGoodsType = '3;4;5'\r\n        this.isDisabled = true\r\n        this.$http.post(reqUrl.batchAddProm, {...this.addParamMesg}).then(res => {\r\n          // 保存按钮可再次点击\r\n          setTimeout(() => {\r\n            this.isDisabled = false\r\n          }, 800)\r\n          if(res.code === 0) {\r\n            this.$message.success(\"保存成功\")\r\n            this.$router.push('/discount_coupon')\r\n            return\r\n          }\r\n          throw new Error(res.msg)\r\n        }).catch(e => {\r\n          this.isDisabled = false\r\n          this.$notify.error({\r\n            title: '提示',\r\n            message: e.message\r\n          })\r\n        })\r\n      },\r\n      doCancelHandel() {\r\n        this.$confirm('确定取消吗?', '提示', {\r\n          confirmButtonText: '确定',\r\n          cancelButtonText: '取消',\r\n          type: 'warning'\r\n        }).then(() => {\r\n          this.$router.push('/discount_coupon')\r\n        }).catch(() => {})\r\n      }\r\n    }\r\n  }\r\n\r\n</script>\n\n\n// WEBPACK FOOTER //\n// src/components/Activity/DisCoupon/Add/AddConsumption.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('div',{staticClass:\"add-form-wraper\"},[_c('el-form',{ref:\"form\",attrs:{\"model\":_vm.addParamMesg,\"label-width\":\"140px\"}},[_c('el-form-item',{attrs:{\"label\":\"活动类型\",\"required\":\"\"}},[_c('p',{staticStyle:{\"color\":\"#222\",\"font-size\":\"16px\",\"font-weight\":\"bold\"}},[_vm._v(_vm._s(_vm.addParamMesg.triggerTypeName))])]),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"活动名称\",\"required\":\"\"}},[_c('el-input',{staticClass:\"add-input\",attrs:{\"size\":\"small\",\"placeholder\":\"请输入活动名称\",\"clearable\":\"\"},model:{value:(_vm.addParamMesg.title),callback:function ($$v) {_vm.$set(_vm.addParamMesg, \"title\", $$v)},expression:\"addParamMesg.title\"}}),_vm._v(\" \"),_c('span',[_vm._v(\"活动名称,限制30个汉字\")])],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"活动开始日期\",\"required\":\"\"}},[_c('el-date-picker',{staticClass:\"add-input\",attrs:{\"type\":\"date\",\"placeholder\":\"请选择活动开始日期\",\"picker-options\":_vm.setDisableTime,\"size\":\"small\"},model:{value:(_vm.addParamMesg.beginTime),callback:function ($$v) {_vm.$set(_vm.addParamMesg, \"beginTime\", $$v)},expression:\"addParamMesg.beginTime\"}}),_vm._v(\" \"),_c('span',[_vm._v(\"活动开始日期\")])],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"活动结束日期\",\"required\":\"\"}},[_c('el-date-picker',{staticClass:\"add-input\",attrs:{\"type\":\"date\",\"placeholder\":\"请选择活动结束日期\",\"picker-options\":_vm.setDisableTime,\"size\":\"small\"},model:{value:(_vm.addParamMesg.endTime),callback:function ($$v) {_vm.$set(_vm.addParamMesg, \"endTime\", $$v)},expression:\"addParamMesg.endTime\"}}),_vm._v(\" \"),_c('span',[_vm._v(\"活动结束日期\")])],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"设置条件\"}},[_c('el-radio-group',{model:{value:(_vm.addParamMesg.triggerSource),callback:function ($$v) {_vm.$set(_vm.addParamMesg, \"triggerSource\", $$v)},expression:\"addParamMesg.triggerSource\"}},_vm._l((_vm.triggerSourceRadio),function(item){return _c('el-radio',{key:item.value,staticClass:\"trigger-radio\",attrs:{\"label\":item.value}},[_vm._v(\"\\n            \"+_vm._s(item.label)+\"\\n            \"),_c('el-input',{staticClass:\"coupon-input\",attrs:{\"size\":\"small\"},model:{value:(item.triggerAmount),callback:function ($$v) {_vm.$set(item, \"triggerAmount\", $$v)},expression:\"item.triggerAmount\"}},[_c('template',{slot:\"append\"},[_vm._v(\"元\")])],2)],1)}),1)],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"设置发放频率\"}},[_c('el-radio-group',{model:{value:(_vm.addParamMesg.triggerTimesType),callback:function ($$v) {_vm.$set(_vm.addParamMesg, \"triggerTimesType\", $$v)},expression:\"addParamMesg.triggerTimesType\"}},_vm._l((_vm.triggerTimesTypeRadio),function(item){return _c('el-radio',{key:item.value,attrs:{\"label\":item.value}},[_vm._v(\"\\n            \"+_vm._s(item.label)+\"\\n          \")])}),1)],1),_vm._v(\" \"),_c('store-template',{on:{\"changeStore\":_vm.changeStore}}),_vm._v(\" \"),_c('prom-type-template',{attrs:{\"triggerType\":_vm.addParamMesg.triggerType},on:{\"changePromType\":_vm.changePromType}}),_vm._v(\" \"),_c('el-form-item',[_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"small\",\"disabled\":_vm.isDisabled},on:{\"click\":_vm.doSaveHandel}},[_vm._v(\"保存\")]),_vm._v(\" \"),_c('el-button',{attrs:{\"size\":\"small\"},on:{\"click\":_vm.doCancelHandel}},[_vm._v(\"取消\")])],1)],1)],1)])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-603f28b0\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/Activity/DisCoupon/Add/AddConsumption.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-603f28b0\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./AddConsumption.vue\")\n}\nvar normalizeComponent = require(\"!../../../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./AddConsumption.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./AddConsumption.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-603f28b0\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../../../node_modules/vue-loader/lib/selector?type=template&index=0!./AddConsumption.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-603f28b0\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/Activity/DisCoupon/Add/AddConsumption.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}