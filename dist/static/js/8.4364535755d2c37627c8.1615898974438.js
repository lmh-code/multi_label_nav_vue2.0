webpackJsonp([8],{"+H5h":function(e,t){},MZx3:function(e,t){},Wzek:function(e,t){},YDHL:function(e,t,n){"use strict";var i=n("Dd8w"),a=n.n(i),o=n("Gu7T"),s=n.n(o),l=n("t0/o"),c=n("Hixw"),r=n("oAV5"),d=n("YSQh"),u={model:{prop:"info",event:"change"},props:{cantEdit:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},info:{type:Object,default:{lineId:"",invoiceTypeCode:"",invoiceDate:"",invoiceCode:"",invoiceNo:"",netAmount:"",taxCode:"",taxAmount:""}},invoiceTypeCodeOptions:{type:Array,default:[]},taxCodeOptions:{type:Array,default:[]}},data:function(){return{invoiceTypeCode:1,taxCode:["0"],invoiceDate:"",invoiceCode:"",invoiceNo:"",netAmount:"",taxAmount:""}},computed:{amount:function(){return 1==this.info.taxCode.length&&this.info.netAmount?"0"==this.info.taxCode[0]?(this.info.taxAmount=0,Object(r.c)(this.info.netAmount)):(this.info.taxAmount=Object(r.c)(this.info.netAmount*+this.info.taxCode[0]/100),Object(r.c)((1e4*+this.info.netAmount+1e4*this.info.taxAmount)/1e4)):this.info.taxCode.length>1&&this.info.netAmount?Object(r.c)((1e4*+this.info.taxAmount+1e4*+this.info.netAmount)/1e4):(this.info.netAmount||(this.info.taxAmount=""),"--")}},methods:{deleteLine:function(){var e=this;this.$confirm("确定要删除该发票吗","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$emit("deleteInvoiceLine",e.info.lineId)})},handleChange:function(e){this.$emit("change",a()({},this.info,{amount:"--"===this.amount?0:this.amount}))}}},m={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-row",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"invoice-form",attrs:{gutter:6}},[n("el-form",{attrs:{"label-width":"40px",size:"small","label-position":"top"}},[n("el-col",{attrs:{span:1}},[n("el-button",{staticClass:"fs28 mt28",attrs:{size:"mini",icon:"el-icon-delete",circle:""},on:{click:e.deleteLine}})],1),e._v(" "),n("el-col",{attrs:{span:3}},[n("el-form-item",{attrs:{label:"发票种类:"}},[n("el-select",{attrs:{disabled:e.cantEdit,placeholder:"请选择"},on:{change:e.handleChange},model:{value:e.info.invoiceTypeCode,callback:function(t){e.$set(e.info,"invoiceTypeCode",t)},expression:"info.invoiceTypeCode"}},e._l(e.invoiceTypeCodeOptions,function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),n("el-col",{attrs:{span:3}},[n("el-form-item",{attrs:{label:"发票日期:"}},[n("el-date-picker",{staticStyle:{width:"100%"},attrs:{disabled:e.cantEdit,type:"date",placeholder:"发票日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd"},on:{change:e.handleChange},model:{value:e.info.invoiceDate,callback:function(t){e.$set(e.info,"invoiceDate",t)},expression:"info.invoiceDate"}})],1)],1),e._v(" "),n("el-col",{attrs:{span:3}},[n("el-form-item",{attrs:{label:"发票代码:"}},[n("el-input",{attrs:{disabled:e.cantEdit,placeholder:"发票代码",clearable:""},on:{change:e.handleChange},model:{value:e.info.invoiceCode,callback:function(t){e.$set(e.info,"invoiceCode",t)},expression:"info.invoiceCode"}})],1)],1),e._v(" "),n("el-col",{attrs:{span:3}},[n("el-form-item",{attrs:{label:"发票号:"}},[n("el-input",{attrs:{disabled:e.cantEdit,placeholder:"发票号",clearable:""},on:{change:e.handleChange},model:{value:e.info.invoiceNo,callback:function(t){e.$set(e.info,"invoiceNo",t)},expression:"info.invoiceNo"}})],1)],1),e._v(" "),n("el-col",{attrs:{span:3}},[n("el-form-item",{attrs:{label:"发票金额:"}},[n("el-input",{attrs:{disabled:e.cantEdit,type:"number",clearable:"",placeholder:"不含税金额"},on:{change:e.handleChange},model:{value:e.info.netAmount,callback:function(t){e.$set(e.info,"netAmount",t)},expression:"info.netAmount"}})],1)],1),e._v(" "),n("el-col",{attrs:{span:3}},[n("el-form-item",{attrs:{label:"税率:"}},[n("el-select",{attrs:{disabled:e.cantEdit,multiple:"","collapse-tags":"",placeholder:"请选择"},on:{change:e.handleChange},model:{value:e.info.taxCode,callback:function(t){e.$set(e.info,"taxCode",t)},expression:"info.taxCode"}},e._l(e.taxCodeOptions,function(e){return n("el-option",{key:e.value,attrs:{label:e.value,value:e.value}})}),1)],1)],1),e._v(" "),n("el-col",{attrs:{span:3}},[n("el-form-item",{attrs:{label:"税额:"}},[n("el-input",{attrs:{disabled:e.cantEdit,type:"number",clearable:"",placeholder:"税额"},on:{change:e.handleChange},model:{value:e.info.taxAmount,callback:function(t){e.$set(e.info,"taxAmount",t)},expression:"info.taxAmount"}})],1)],1),e._v(" "),n("el-col",{attrs:{span:2}},[n("el-form-item",{attrs:{label:"价税合计:"}},[e._v("\n          "+e._s(e.amount)+"\n        ")])],1)],1)],1)},staticRenderFns:[]};var h=n("VU/8")(u,m,!1,function(e){n("MZx3")},"data-v-eb74c71a",null).exports,p=/((^[1-9]\d*)|^0)(\.\d{0,2}){0,1}$/,v={components:{"file-upload":d.a,"invoice-line":h},data:function(){return{type:"",dialogVisible:!1,settlementNo:"",startDate:"",endDate:"",statusNameForVendor:"",invoiceAmount:"",invoicedAmount:"",invoiceTypeCodeOptions:[],taxCodeOptions:[],loading:!1,cantEdit:!1,id:"",invoiceTypeCode:1,taxCode:["0"],invoiceDate:"",invoiceCode:"",invoiceNo:"",netAmount:"",taxAmount:"",filePaths:[],invoiceBatchNumber:"",previewFileList:[],invoiceDetailList:[],totalAmount:"",uploadStyleObj:{maxHeight:"120px",overflow:"auto"}}},methods:{addLine:function(){var e=this.invoiceDetailList;e&&e.length>=20?this.$tip.message("最多可开20张发票","warning"):e.push({lineId:Date.now(),invoiceTypeCode:"",invoiceDate:"",invoiceCode:"",invoiceNo:"",netAmount:"",taxCode:"",taxAmount:""})},deleteInvoiceLine:function(e){var t=this;this.invoiceDetailList.some(function(n,i){if(e===n.lineId)return t.invoiceDetailList.splice(i,1),!0})},handleChange:function(e){var t=this.invoiceDetailList.findIndex(function(t){return t.lineId===e.lineId});this.invoiceDetailList.splice(t,1,e),this.calTotalAmount()},calTotalAmount:function(){var e=(this.invoiceDetailList||[]).reduce(function(e,t){return{amount:(e.amount||0)+(t.amount||0)}},{amount:0}).amount;this.totalAmount=Object(r.c)(e)},setDefaultMsg:function(e){this.getCommonCodes(),this.dialogVisible=!0,this.settlementNo=e.settlementNo,this.startDate=e.startDate,this.endDate=e.endDate,this.statusNameForVendor=e.statusNameForVendor,this.invoiceAmount=e.invoiceAmount,this.invoicedAmount=e.invoicedAmount,this.cantEdit=e.cantEdit||!1,this.id=e.invoiceId,this.invoiceBatchNumber=e.invoiceBatchNumber||"",this.invoiceDetailList=e.invoiceDetailList||[],this.filePaths=e.filePaths,this.previewFileList=e.filePaths,this.settlement=e.settlement,this.type=e.type,this.calTotalAmount()},getCommonCodes:function(){var e=this;this.$http.post(l.a.listByCommonCodes,["TAX","InvoiceType"]).then(function(t){if(0===t.code)return e.invoiceTypeCodeOptions=t.data&&t.data.InvoiceType&&t.data.InvoiceType.length?t.data.InvoiceType.map(function(e){return{id:e.id,value:+e.code,label:e.value}}):[],void(e.taxCodeOptions=t.data&&t.data.TAX&&t.data.TAX.length?t.data.TAX.map(function(e){return{id:e.id,value:e.value,label:e.value}}):[]);throw new Error(t.msg)}).catch(function(e){console.log("【发票种类和税率】:",e.message)})},handleCancel:function(){var e=this;this.$confirm("取消操作不保存页面任何数据，是否确定取消？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.dialogVisible=!1})},checkLine:function(e){if(e.invoiceDate)if(e.invoiceCode)if(e.invoiceNo)if(e.netAmount||0===e.netAmount)if(p.test(Math.abs(e.netAmount)))if(e.taxAmount||0===e.taxAmount)if(p.test(Math.abs(e.taxAmount))){if(!(Object(r.c)(parseFloat(e.totalAmount))+parseFloat(Object(r.c)(e.invoicedAmount))>Object(r.c)(parseFloat(e.invoiceAmount))))return!0;this.$tip.message("开票金额不可超过应开票金额","warning")}else this.$tip.message("税额是小数保留小数点后2位","warning");else this.$tip.message("请输入税额","warning");else this.$tip.message("发票（不含税）金额是小数保留小数点后2位","warning");else this.$tip.message("请输入发票（不含税）金额","warning");else this.$tip.message("请输入发票号","warning");else this.$tip.message("请输入发票代码","warning");else this.$tip.message("请选择发票日期","warning")},handleSubmit:function(){var e=this,t=this.invoiceDetailList;if(t&&t.length){for(var n=0;n<t.length;n++)if(!this.checkLine(t[n]))return;if(this.totalAmount>this.invoiceAmount-this.invoicedAmount)this.$tip.message("发票金额不可大于待开金额","warning");else{t=t.map(function(e){return{invoiceCode:e.invoiceCode,invoiceDate:e.invoiceDate,invoiceNumber:e.invoiceNo,invoiceTypeCode:e.invoiceTypeCode,inTaxs:e.taxCode.join(","),invoiceMoney:e.amount,taxMoney:e.taxAmount,noTaxMoney:e.netAmount}}),this.loading=!0;var i="",o={},l=this.filePaths&&this.filePaths.length?this.filePaths:[];"edit"===this.type?(i=c.a.editInvoice,o={filePaths:[].concat(s()(l)),invoiceDetailList:t,accountName:this.settlement.accountName,accountSet:this.settlement.accountSet,settlementNumbers:this.settlementNo,supplierName:this.settlement.supplierName,batchNumber:this.invoiceBatchNumber,supplierNumber:this.settlement.supplierNumber}):(o={filePaths:[].concat(s()(l)),settlementNumbers:this.settlementNo,batchNumber:this.invoiceBatchNumber,invoiceDetailList:t},i=c.a.addInvoice),this.$http.post(i,a()({},o)).then(function(t){if(e.loading=!1,0===t.code)return e.$tip.message("提交成功，等待本来鲜财务人员审核！","success"),e.dialogVisible=!1,void e.$emit("parentsHandel");throw new Error(t.msg)}).catch(function(t){e.loading=!1,e.$tip.notify(t.message||"","error","系统提示")})}}else this.$tip.message("发票信息不可为空","warning")},resetHandle:function(){this.invoiceTypeCode=1,this.taxCode=["0"],this.invoiceDate="",this.invoiceCode="",this.invoiceNo="",this.netAmount="",this.taxAmount="",this.filePaths=[]},getInvoiceMsg:function(e){var t=this;this.loading=!0,this.$http.post(c.a.invoiceDetails+"/"+e).then(function(e){if(t.loading=!1,0!==e.code)throw new Error(e.msg);if(e.data){e.data.invoiceMoney&&e.data.invoiceMoney;t.previewFileList=e.data.invoiceFiles&&e.data.invoiceFiles.length?e.data.invoiceFiles:[],t.invoiceTypeCode=e.data.inoviceType||"",t.invoiceDate=e.data.invoiceTimeDate||"",t.invoiceCode=e.data.invoiceCode||"",t.invoiceNo=e.data.invoiceNumber||"",t.taxCode=e.data.inTax&&e.data.inTax.split(","),t.netAmount=e.data.noTaxMoney,t.taxAmount=e.data.taxMoney}}).catch(function(e){t.loading=!1,t.$tip.notify(e.message||"","error","系统提示")})},setFileList:function(e){var t=e.filesList;e.path;this.filePaths=t}}},f={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{attrs:{title:"发票",visible:e.dialogVisible,width:"1080px","close-on-click-modal":!1,"destroy-on-close":!0,"show-close":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[n("el-row",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"title-box"},[n("el-col",{attrs:{span:8}},[e._v("结算单号："+e._s(e.settlementNo))]),e._v(" "),n("el-col",{attrs:{span:8}},[e._v("账期："+e._s(e.startDate)+"至"+e._s(e.endDate))]),e._v(" "),n("el-col",{attrs:{span:8}},[e._v("状态："+e._s(e.statusNameForVendor))]),e._v(" "),n("el-col",{attrs:{span:8}},[e._v("应开票金额：￥"+e._s(e.invoiceAmount))]),e._v(" "),n("el-col",{attrs:{span:8}},[e._v("已开票金额：￥"+e._s(e.invoicedAmount))]),e._v(" "),n("el-col",{attrs:{span:8}},[e._v("待开票：￥"+e._s(e.invoiceAmount-e.invoicedAmount))])],1),e._v(" "),n("el-row",{staticClass:"operation-box"},[n("el-button",{attrs:{type:"primary"},on:{click:e.addLine}},[e._v("添加发票")])],1),e._v(" "),n("div",{staticClass:"el-dialog-div"},[e.invoiceDetailList.length?e._l(e.invoiceDetailList,function(t,i){return n("invoice-line",{key:i,attrs:{cantEdit:e.cantEdit,loading:e.loading,info:t,invoiceTypeCodeOptions:e.invoiceTypeCodeOptions,taxCodeOptions:e.taxCodeOptions},on:{deleteInvoiceLine:e.deleteInvoiceLine,change:e.handleChange}})}):e._e()],2),e._v(" "),n("el-row",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"invoice-total"},[n("el-form",[n("el-col",{attrs:{span:24}},[n("el-form-item",{attrs:{label:"总金额:"}},[e._v("\n          ￥"+e._s(e.totalAmount)+"\n        ")])],1),e._v(" "),n("el-col",{attrs:{span:24}},[n("el-form-item",{attrs:{label:"附件:"}},[n("file-upload",{ref:"fileUpload",attrs:{previewFileList:e.previewFileList,fileAspectType:["jpg","doc","png","docx","pdf","jpeg"],maxFilesNum:5,styleObj:e.uploadStyleObj,tipText:"限上传5张图片或PDF，单张不可超20MB"},on:{"files-change":e.setFileList}})],1)],1)],1)],1),e._v(" "),n("span",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{size:"mini"},on:{click:e.handleCancel}},[e._v("取 消")]),e._v(" "),n("el-button",{attrs:{type:"primary",size:"mini",disabled:e.cantEdit},on:{click:e.handleSubmit}},[e._v("确 定")])],1)],1)},staticRenderFns:[]};var g=n("VU/8")(v,f,!1,function(e){n("+H5h")},"data-v-045027ff",null);t.a=g.exports},lpid:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n("Gu7T"),a=n.n(i),o=n("Dd8w"),s=n.n(o),l=n("WorT"),c=n("4WFj"),r=n("t0/o"),d=n("Hixw"),u=n("oAV5"),m=n("8uth"),h=n("YDHL"),p={mixins:[l.a,c.a],components:{"invoice-dialog":h.a},data:function(){return{searchContent:{settlementStartDate:Object(u.b)("yyyy-MM-dd",Date.parse(new Date)-5184e5),settlementEndDate:Object(u.b)("yyyy-MM-dd",Date.parse(new Date)),searchSupplierNumberList:[],status:"",settlementNumber:"",cooperationMode:"",inNumber:"",outNumber:""},statusOptionsArr:[],typeIdOptions:[],totalSettlementAmount:"",settledAmount:"",settledQty:"",unsettledQty:"",loading:!1,exportLoading:!1,tableData:[],total:0,pageNum:1,pageSize:10,checkedList:[],exportConfigForDetail:{index:"序号",settlementNo:"结算单号",vendorName:"供应商",cooperationModeName:"结算方式",accountPeriod:"账期",endDate:"应结算日",goodsName:"商品名称",goodsNo:"商品编码",vendorGoodsNo:"货号",barcode:"商品条码",spec:"规格",taxPct:"税率",averageUnitPrice:"平均单价",qty:"数量",amount:"参考结算金额"},columns:[{title:"序号",dataIndex:"index",minWidth:50},{title:"结算单号",dataIndex:"settlementNumber",ellipsis:!0,minWidth:160},{title:"供应商",dataIndex:"supplierName",ellipsis:!0,minWidth:100},{title:"结算方式",dataIndex:"cooperationModeName",ellipsis:!0,minWidth:100},{title:"账期",minWidth:200,ellipsis:!0,dataIndex:"accountPeriod"},{title:"应结算日",dataIndex:"settlementEndDate",ellipsis:!0,minWidth:100},{title:"应结金额",dataIndex:"shouldPay",ellipsis:!0,minWidth:100},{title:"应开票金额",dataIndex:"shoudInvoiceMoney",ellipsis:!0,minWidth:120},{title:"已开票金额",dataIndex:"havedInvoiceMoney",ellipsis:!0,minWidth:120},{title:"状态",dataIndex:"statusName",ellipsis:!0,minWidth:100},{title:"状态更新日期",dataIndex:"lastUpdateTime",ellipsis:!0,minWidth:140},{title:"结算主体",dataIndex:"accountName",ellipsis:!0,minWidth:100},{title:"创建时间",minWidth:100,ellipsis:!0,dataIndex:"addTime"},{title:"操作",fixed:"right",minWidth:170,operation:[{label:"详情",icon:"el-icon-view",clickFunc:this.goDetailPage},{label:"开发票",icon:"el-icon-tickets",isDisabled:function(e){return 2!==e.status},clickFunc:this.invoiceHandel}]}]}},mounted:function(){this.getStatus(),this.initMounted()},methods:{initMounted:function(){var e=this;this.vendors&&this.vendors.length>0?this.doSearchHandle(!0):setTimeout(function(){e.initMounted()},500)},getStatus:function(){var e=this;this.$http.post(r.a.listByCommonCodes,["VendorSettleStatus1","TRADEM4"]).then(function(t){if(0===t.code)return e.statusOptionsArr=t.data&&t.data.VendorSettleStatus1&&t.data.VendorSettleStatus1.length?t.data.VendorSettleStatus1.map(function(e){return{id:e.id,value:e.code,label:e.value}}):[],e.statusOptionsArr.unshift({id:-1,value:"",label:"全部"}),e.typeIdOptions=t.data&&t.data.TRADEM4&&t.data.TRADEM4.length?t.data.TRADEM4.map(function(e){return{id:e.id,value:+e.code,label:e.value}}):[],void e.typeIdOptions.unshift({value:"",label:"全部"});throw new Error(t.msg)}).catch(function(e){console.log("【对账管理状态】:",e.message)})},getListTotal:function(){var e=this,t=s()({},this.searchContent);(!t.searchSupplierNumberList||t.searchSupplierNumberList.length<=0)&&(t.searchSupplierNumberList=this.vendors.map(function(e){return e.vendorNo})),this.$http.post(d.a.listTotal,s()({},t)).then(function(t){if(0!==t.code)throw new Error(t.msg);t.data?(e.settledAmount=t.data.settledAmount,e.settledQty=t.data.settledQty,e.totalSettlementAmount=t.data.totalSettlementAmount,e.unsettledQty=t.data.unsettledQty):(e.settledAmount="--",e.settledQty="--",e.totalSettlementAmount="--",e.unsettledQty="--")}).catch(function(e){console.log("【列表统计提示】:",e.message||"")})},selectionChangeHandel:function(e){var t=e.selection;this.checkedList=[].concat(a()(t))},doSearchHandleRequest:function(e){var t=this,n=this.searchContent,i=n.settlementStartDate,a=n.settlementEndDate;if(i&&a)if(Date.parse(new Date(i.replace(/-/g,"/")))>Date.parse(new Date(a.replace(/-/g,"/"))))this.$tip.message("结算结束时间不能早于开始时间！","warning");else{this.loading=!0,e&&(this.pageNum=1);var o=s()({},this.searchContent,{pageNum:this.pageNum,pageSize:this.pageSize});(!o.searchSupplierNumberList||o.searchSupplierNumberList.length<=0)&&(o.searchSupplierNumberList=this.vendors.map(function(e){return e.vendorNo})),this.$http.post(d.a.settlementList,s()({},o)).then(function(e){if(t.loading=!1,0===e.code){var n=(e.data&&e.data.settlementList&&e.data.settlementList.length?e.data.settlementList:[]).map(function(e,t){return e.index=t+1,e.settlementStartDate&&e.settlementEndDate?e.accountPeriod=e.settlementStartDate+"至"+e.settlementEndDate:e.settlementStartDate?e.accountPeriod=e.settlementStartDate+"至--":e.settlementEndDate&&(e.accountPeriod="--至"+e.settlementEndDate),e.invoiceAmount=e.invoiceAmount||0===e.invoiceAmount?e.invoiceAmount:"",e.invoicedAmount=e.invoicedAmount||0===e.invoicedAmount?e.invoicedAmount:"",e});return t.total=e.data&&e.data.totalSettlementCount?e.data.totalSettlementCount:0,void(t.tableData=n)}throw new Error(e.msg)}).catch(function(e){t.loading=!1,t.$tip.notify(e.message||"","error","系统提示")})}else this.$tip.message("请选择时间！","warning")},doSearchHandle:function(e){this.doSearchHandleRequest(e),this.getListTotal()},changeSize:function(e){this.pageSize=e,this.doSearchHandleRequest()},changeCurrent:function(e){this.pageNum=e,this.doSearchHandleRequest()},doExportDataDetailHandel:function(){var e=this,t=this.checkedList.map(function(e){return e.settlementNumber});this.exportLoading=!0,this.$http.post(d.a.export,{settlementNoList:t}).then(function(t){e.exportLoading=!1;var n=Object(u.b)("yyyy-MM-dd",Date.parse(new Date));if(0!==t.code)throw new Error(t.msg);if(t.data&&t.data&&t.data.result.length){t.data.result.forEach(function(e,t){e.index=t+1,e.startDate&&e.endDate?e.accountPeriod=Object(u.b)("yyyy-MM-dd",e.startDate)+"至"+Object(u.b)("yyyy-MM-dd",e.endDate):e.startDate?e.accountPeriod=Object(u.b)("yyyy-MM-dd",e.startDate)+"至--":e.endDate&&(e.accountPeriod="--至"+Object(u.b)("yyyy-MM-dd",e.endDate)),e.endDate=Object(u.b)("yyyy-MM-dd",e.endDate),e.amount&&e.qty?e.averageUnitPrice=(e.amount/e.qty).toFixed(2):e.averageUnitPrice=""});var i=Object(u.i)(e.exportConfigForDetail,!1),a=Object(u.i)(e.exportConfigForDetail,!0);m.a.ExportJsonToExcel({header:i,filterVal:a,data:t.data.result,filename:"本来鲜结算数据详细信息_"+n+".xlsx"}),setTimeout(function(){e.$tip.notify("导出成功","success","温馨提示")},500)}else e.$tip.notify("没有查询到可导出数据","warning","系统提示")}).catch(function(t){e.exportLoading=!1,e.$tip.notify(t.message||"","error","系统提示")})},goDetailPage:function(e){this.$router.push("/settlement/"+e.settlementNumber)},invoiceHandel:function(e){var t={cantEdit:3===e.status||!1,settlementNo:e.settlementNumber,startDate:e.settlementStartDate,endDate:e.settlementEndDate,statusNameForVendor:e.statusName,invoiceAmount:e.shoudInvoiceMoney,invoicedAmount:e.havedInvoiceMoney,invoiceBatchNumber:e.invoiceBatchNumber||""};this.$refs.invoiceDialog.setDefaultMsg(t)}}},v={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"search-form-wraper"},[n("el-form",{attrs:{model:e.searchContent,"label-position":"top"}},[n("el-form-item",{attrs:{label:"结算起始时间"}},[n("el-date-picker",{staticClass:"search-input",attrs:{type:"date",placeholder:"结算起始时间",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",size:"small"},model:{value:e.searchContent.settlementStartDate,callback:function(t){e.$set(e.searchContent,"settlementStartDate",t)},expression:"searchContent.settlementStartDate"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"结算结束时间"}},[n("el-date-picker",{staticClass:"search-input",attrs:{type:"date",placeholder:"结算结束时间",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",size:"small"},model:{value:e.searchContent.settlementEndDate,callback:function(t){e.$set(e.searchContent,"settlementEndDate",t)},expression:"searchContent.settlementEndDate"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"供应商"}},[n("el-select",{staticClass:"search-input",attrs:{multiple:"","collapse-tags":"",filterable:"",size:"small",placeholder:"请选择供应商"},model:{value:e.searchContent.searchSupplierNumberList,callback:function(t){e.$set(e.searchContent,"searchSupplierNumberList",t)},expression:"searchContent.searchSupplierNumberList"}},e._l(e.vendors,function(e){return n("el-option",{key:e.vendorNo,attrs:{label:e.vendorName,value:e.vendorNo}})}),1)],1),e._v(" "),n("el-form-item",{attrs:{label:"状态"}},[n("el-select",{staticClass:"search-input",attrs:{size:"small",placeholder:"请选择状态"},model:{value:e.searchContent.status,callback:function(t){e.$set(e.searchContent,"status",t)},expression:"searchContent.status"}},e._l(e.statusOptionsArr,function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),n("el-form-item",{attrs:{label:"结算单号"}},[n("el-input",{staticClass:"search-input",attrs:{size:"small",placeholder:"结算单号",clearable:""},model:{value:e.searchContent.settlementNumber,callback:function(t){e.$set(e.searchContent,"settlementNumber",t)},expression:"searchContent.settlementNumber"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"进货单号"}},[n("el-input",{staticClass:"search-input",attrs:{size:"small",placeholder:"进货单号",clearable:""},model:{value:e.searchContent.inNumber,callback:function(t){e.$set(e.searchContent,"inNumber",t)},expression:"searchContent.inNumber"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"退货单号"}},[n("el-input",{staticClass:"search-input",attrs:{size:"small",placeholder:"退货单号",clearable:""},model:{value:e.searchContent.outNumber,callback:function(t){e.$set(e.searchContent,"outNumber",t)},expression:"searchContent.outNumber"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"结算方式"}},[n("el-select",{staticClass:"search-input",attrs:{size:"small",placeholder:"结算方式"},model:{value:e.searchContent.cooperationMode,callback:function(t){e.$set(e.searchContent,"cooperationMode",t)},expression:"searchContent.cooperationMode"}},e._l(e.typeIdOptions,function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.doSearchHandle(!0)}}},[e._v("搜索")]),e._v(" "),n("el-button",{attrs:{size:"mini",disabled:0===e.checkedList.length,loading:e.exportLoading},on:{click:e.doExportDataDetailHandel}},[e._v("批量导出")])],1)],1)],1),e._v(" "),n("el-row",{staticClass:"detail-box"},[n("el-col",{attrs:{span:6}},[e._v("总金额：￥"+e._s(e.totalSettlementAmount))]),e._v(" "),n("el-col",{attrs:{span:6}},[e._v("已结算金额：￥"+e._s(e.settledAmount))]),e._v(" "),n("el-col",{attrs:{span:6}},[e._v("已结算单："+e._s(e.settledQty))]),e._v(" "),n("el-col",{attrs:{span:6}},[e._v("未结算单："+e._s(e.unsettledQty))])],1),e._v(" "),n("div",{staticClass:"table-wraper"},[n("bl-table",{attrs:{loading:e.loading,border:!1,dataSource:e.tableData,columns:e.columns,selection:!0,showSummary:!1},on:{"selection-change":e.selectionChangeHandel}}),e._v(" "),n("bl-pagination",{attrs:{showPagination:e.tableData.length>0,pageNum:e.pageNum,total:e.total},on:{"size-change":e.changeSize,"current-change":e.changeCurrent}})],1),e._v(" "),n("invoice-dialog",{ref:"invoiceDialog",on:{parentsHandel:e.doSearchHandleRequest}})],1)},staticRenderFns:[]};var f=n("VU/8")(p,v,!1,function(e){n("Wzek")},"data-v-3e9c2f9f",null);t.default=f.exports}});
//# sourceMappingURL=8.4364535755d2c37627c8.1615898974438.js.map