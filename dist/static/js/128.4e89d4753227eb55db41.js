webpackJsonp([128],{F9hR:function(e,t){},Mg86:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i("Gu7T"),a=i.n(s),n=i("Dd8w"),l=i.n(n),r=i("BO1k"),o=i.n(r),c=i("oAV5"),h=/((^[1-9]\d*)|^0)(\.\d{0,2}){0,1}$/,d="/plateform/a/store/condition/search",u="/plateform/a/mall/storeDelivery/list",p="/plateform/a/mall/storeDelivery/closeExpress",m="/plateform/a/mall/storeDelivery/openExpress",g="/plateform/a/mall/storeDelivery/closeSelfPick",f="/plateform/a/mall/storeDelivery/openSelfPick",v="/plateform/a/mall/storeDelivery/closeTakeaway",b="/plateform/a/mall/storeDelivery/openTakeaway",k="/plateform/a/mall/storeDelivery/expressMoneyConfig",_={data:function(){return{isDisabled:!1,loading:!1,pageNum:1,pageSize:10,total:0,searchContent:{storeNo:""},storeOptions:[],tableData:[],checkedList:[],dialogFormVisible:!1,setFreightParams:{basicShippingFee:"",freeShippingAmount:"",storeCodes:[]}}},created:function(){this.getStoreList(),this.doSearchHandel(!0)},methods:{changeSize:function(e){this.pageSize=e,this.doSearchHandel()},changeCurrent:function(e){this.pageNum=e,this.doSearchHandel()},getStoreList:function(){var e=this;this.$http.post(d).then(function(t){if(0!==t.code)throw new Error(t.msg);if(t.data&&t.data.length){var i=[],s=!0,a=!1,n=void 0;try{for(var l,r=o()(t.data);!(s=(l=r.next()).done);s=!0){var c=l.value,h={value:c.storeNo,label:c.storeNo+"-"+c.storeName};i.push(h)}}catch(e){a=!0,n=e}finally{try{!s&&r.return&&r.return()}finally{if(a)throw n}}e.storeOptions=i}else e.storeOptions=[]}).catch(function(e){console.log("提示(获取门店列表):",e.message)})},doSearchHandel:function(e){var t=this;this.checkedList=[],!0===e&&(this.pageNum=1),this.loading=!0,this.$http.post(u,l()({},this.searchContent,{pageSize:this.pageSize,pageNum:this.pageNum})).then(function(e){if(t.loading=!1,0!==e.code)throw new Error(e.msg);e.data&&e.data.result&&e.data.result.length?(t.tableData=e.data.result,t.total=e.data.total):(t.tableData=[],t.total=0)}).catch(function(e){t.loading=!1,t.$notify.error({title:"提示",message:e.message})})},handleSelect:function(e,t){var i={},s=[];if(c.l(t.storeNo,this.checkedList))this.checkedList=c.q("storeNo",t.storeNo,this.checkedList);else{s.push(t);var n=[].concat(s,a()(this.checkedList));this.checkedList=n.reduceRight(function(e,t){return!i[t.storeNo]&&(i[t.storeNo]=e.push(t)),e},[])}},handleSelectAll:function(e){var t={};if(e.length>0){var i=!0,s=!1,a=void 0;try{for(var n,l=o()(e);!(i=(n=l.next()).done);i=!0){var r=n.value;this.checkedList.push(r)}}catch(e){s=!0,a=e}finally{try{!i&&l.return&&l.return()}finally{if(s)throw a}}this.checkedList=this.checkedList.reduceRight(function(e,i){return!t[i.storeNo]&&(t[i.storeNo]=e.push(i)),e},[])}else{var h=[],d=!0,u=!1,p=void 0;try{for(var m,g=o()(this.tableData);!(d=(m=g.next()).done);d=!0){var f=m.value;h.push(f)}}catch(e){u=!0,p=e}finally{try{!d&&g.return&&g.return()}finally{if(u)throw p}}var v=c.i(this.checkedList,h,"storeNo");this.checkedList=v&&v.length>0?v:[]}},batchHandel:function(e){var t=this,i="",s="",a="",n=this.checkedList.map(function(e){return e.storeNo});switch(e){case"10":i=f,s="启用自提成功",a="确定要将所选门店启用自提吗？";break;case"01":i=g,s="禁用自提成功",a="确定要将所选门店禁用自提吗？";break;case"20":i=b,s="启用外卖成功",a="确定要将所选门店启用外卖吗？";break;case"02":i=v,s="禁用外卖成功",a="确定要将所选门店禁用外卖吗？";break;case"30":i=m,s="启用配送成功",a="确定要将所选门店启用配送吗？";break;case"03":i=p,s="禁用配送成功",a="确定要将所选门店禁用配送吗？"}this.$confirm(a,"温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.isDisabled=!0,t.$http.post(i,{storeCodes:n}).then(function(e){if(t.isDisabled=!1,0===e.code)return t.$message.success(s),void t.doSearchHandel();throw new Error(e.msg)}).catch(function(e){t.isDisabled=!1,t.$notify.error({title:"提示",message:e.message})})}).catch(function(){})},showSetFrightDialog:function(){this.dialogFormVisible=!0},doSetFreightHandel:function(){var e=this;this.setFreightParams.basicShippingFee||0==this.setFreightParams.basicShippingFee?h.test(this.setFreightParams.basicShippingFee)?this.setFreightParams.freeShippingAmount||0==this.setFreightParams.freeShippingAmount?h.test(this.setFreightParams.freeShippingAmount)?(this.setFreightParams.storeCodes=this.checkedList.map(function(e){return e.storeNo}),this.isDisabled=!0,this.$http.post(k,l()({},this.setFreightParams)).then(function(t){if(setTimeout(function(){e.isDisabled=!1},800),0===t.code)return e.$message.success("运费设置成功"),e.dialogFormVisible=!1,void e.doSearchHandel();throw new Error(t.msg)}).catch(function(t){e.isDisabled=!1,e.$notify.error({title:"提示",message:t.message})})):this.$message.warning("单笔订单满金额必须是大于等于0，小数保留小数点后2位"):this.$message.warning("请输入单笔订单满金额"):this.$message.warning("基础运费金额必须是大于等于0，小数保留小数点后2位"):this.$message.warning("请输入基础运费金额")}}},S={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{staticClass:"search-form-wraper"},[i("el-form",{attrs:{model:e.searchContent,"label-position":"top"}},[i("el-form-item",{attrs:{label:"门店"}},[i("el-select",{staticClass:"search-input",attrs:{filterable:"",placeholder:"请选择门店",clearable:"",size:"small"},on:{change:function(t){return e.doSearchHandel(!0)}},model:{value:e.searchContent.storeNo,callback:function(t){e.$set(e.searchContent,"storeNo",t)},expression:"searchContent.storeNo"}},e._l(e.storeOptions,function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),i("el-form-item",[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.doSearchHandel(!0)}}},[e._v("搜索")])],1)],1)],1),e._v(" "),i("div",{staticClass:"table-wraper"},[i("div",{staticClass:"sp-handel-w"},[i("el-button",{staticClass:"sup-mini",attrs:{size:"mini",disabled:0===this.checkedList.length||this.isDisabled,icon:"el-icon-circle-check"},on:{click:function(t){return e.batchHandel("10")}}},[e._v("启用自提")]),e._v(" "),i("el-button",{staticClass:"sup-mini",attrs:{size:"mini",disabled:0===this.checkedList.length||this.isDisabled,icon:"el-icon-close"},on:{click:function(t){return e.batchHandel("01")}}},[e._v("禁用自提")]),e._v(" "),i("el-button",{staticClass:"sup-mini",attrs:{size:"mini",disabled:0===this.checkedList.length||this.isDisabled,icon:"el-icon-circle-check"},on:{click:function(t){return e.batchHandel("20")}}},[e._v("启用外卖")]),e._v(" "),i("el-button",{staticClass:"sup-mini",attrs:{size:"mini",disabled:0===this.checkedList.length||this.isDisabled,icon:"el-icon-close"},on:{click:function(t){return e.batchHandel("02")}}},[e._v("禁用外卖")]),e._v(" "),i("el-button",{staticClass:"sup-mini",attrs:{size:"mini",disabled:0===this.checkedList.length||this.isDisabled,icon:"el-icon-circle-check"},on:{click:function(t){return e.batchHandel("30")}}},[e._v("启用配送")]),e._v(" "),i("el-button",{staticClass:"sup-mini",attrs:{size:"mini",disabled:0===this.checkedList.length||this.isDisabled,icon:"el-icon-close"},on:{click:function(t){return e.batchHandel("03")}}},[e._v("禁用配送")]),e._v(" "),i("el-button",{staticClass:"sup-mini",attrs:{size:"mini",disabled:0===this.checkedList.length||this.isDisabled,icon:"el-icon-setting"},on:{click:e.showSetFrightDialog}},[e._v("设置运费")])],1),e._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticClass:"fixed-height",staticStyle:{width:"100%"},attrs:{data:e.tableData,"empty-text":"没有查询到您想要的数据",size:"small"},on:{select:e.handleSelect,"select-all":e.handleSelectAll}},[i("el-table-column",{attrs:{type:"selection",align:"center"}}),e._v(" "),i("el-table-column",{attrs:{label:"门店信息","min-width":"200px"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",[i("p",[e._v("\n              "+e._s(t.row.storeNo)+"-"+e._s(t.row.storeName)+"\n            ")]),e._v(" "),i("p",{staticClass:"mh-address"},[e._v(e._s(t.row.address))])])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"自提","min-width":"90px"},scopedSlots:e._u([{key:"default",fn:function(e){return[i("div",[1===e.row.selfPickFlag?i("i",{staticClass:"el-icon-circle-check",staticStyle:{color:"#3080fe"}}):i("i",{staticClass:"el-icon-close"})])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"外卖配送","min-width":"90px"},scopedSlots:e._u([{key:"default",fn:function(e){return[i("div",[1===e.row.takeawayFlag?i("i",{staticClass:"el-icon-circle-check",staticStyle:{color:"#3080fe"}}):i("i",{staticClass:"el-icon-close"})])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"快递配送","min-width":"90px"},scopedSlots:e._u([{key:"default",fn:function(e){return[i("div",[1===e.row.expressDeleiveryFlag?i("i",{staticClass:"el-icon-circle-check",staticStyle:{color:"#3080fe"}}):i("i",{staticClass:"el-icon-close"})])]}}])}),e._v(" "),i("el-table-column",{attrs:{"min-width":"150px",prop:"orderId",label:"运费设置"},scopedSlots:e._u([{key:"default",fn:function(t){return[0===t.row.basicShippingFee&&0===t.row.freeShippingAmount?i("div",[e._v("\n            免运费\n          ")]):i("div",[i("p",[e._v("基础运费"+e._s(t.row.basicShippingFee)+"元")]),e._v(" "),i("p",[e._v("满"+e._s(t.row.freeShippingAmount)+"元免运费")])])]}}])})],1),e._v(" "),e.total>0?i("el-pagination",{staticClass:"tc mt20",attrs:{background:"","current-page":e.pageNum,"page-sizes":[10,50,100,150,200],layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.changeSize,"current-change":e.changeCurrent,"update:currentPage":function(t){e.pageNum=t},"update:current-page":function(t){e.pageNum=t}}}):e._e()],1),e._v(" "),i("el-dialog",{attrs:{title:"批量修改运费",visible:e.dialogFormVisible,width:"420px"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[i("el-form",{attrs:{model:e.setFreightParams,"label-width":"100px"}},[i("el-form-item",{attrs:{label:"基础运费",required:""}},[i("el-input",{staticClass:"search-input",attrs:{size:"small",placeholder:"请输入金额"},model:{value:e.setFreightParams.basicShippingFee,callback:function(t){e.$set(e.setFreightParams,"basicShippingFee",t)},expression:"setFreightParams.basicShippingFee"}}),e._v(" "),i("span",[e._v("元运费")])],1),e._v(" "),i("el-form-item",{attrs:{label:"单笔订单满",required:""}},[i("el-input",{staticClass:"search-input",attrs:{size:"small",placeholder:"请输入金额"},model:{value:e.setFreightParams.freeShippingAmount,callback:function(t){e.$set(e.setFreightParams,"freeShippingAmount",t)},expression:"setFreightParams.freeShippingAmount"}}),e._v(" "),i("span",[e._v("元，免运费")])],1),e._v(" "),i("div",[i("span",{staticStyle:{color:"red","margin-left":"100px"}},[e._v("*注意: ")]),e._v("均设为0元，则为免运设置")])],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"mini"},on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary",size:"mini",disabled:e.isDisabled},on:{click:e.doSetFreightHandel}},[e._v("确定")])],1)],1)],1)},staticRenderFns:[]};var y=i("VU/8")(_,S,!1,function(e){i("F9hR")},null,null);t.default=y.exports}});
//# sourceMappingURL=128.4e89d4753227eb55db41.js.map