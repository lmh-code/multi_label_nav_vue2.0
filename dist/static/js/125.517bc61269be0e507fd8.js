webpackJsonp([125],{"ODh/":function(e,t){},QBzM:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("lHA8"),i=a.n(r),s=a("c/Tr"),n=a.n(s),o=a("Gu7T"),l=a.n(o),d=a("BO1k"),c=a.n(d),h=a("Dd8w"),p=a.n(h),u=a("ssT3"),m=a("bzuE"),f=a("oAV5"),g="/plateform/a/product/getPlatformList",v="/plateform/a/order/search/replenish",w="/plateform/a/order/replenish",b={data:function(){return{pageSizes:m.a.pageSizes20,isShowTip:!0,orderErrorMesgVisible:!1,makeUpOrdersDialogShow:!1,makeUpOrdersTitle:"",makeUpOrdersResDetail:"",loading:!1,pageNum:1,pageSize:20,total:0,tableData:[],searchContent:{regionCode:u.a.get("regionCode")||"",platformId:0,shopId:"",shopName:""},orderIdList:[],orderIdListTemp:[],singleOrderId:[],platformIdOptions:[{name:"全部",platformId:0}],errDetailMesg:null}},created:function(){this.getOrderOrigion()},mounted:function(){this.doSearchHandel(!0)},methods:{nullTreating:function(e,t,a){return null==a&&(a="-"),a},isShowTipHandel:function(){this.isShowTip=!1},getOrderOrigion:function(){var e=this;this.$http.get(g,{DIFFCITY:!0}).then(function(t){if(0!==t.code)throw new Error(t.msg);if(t.data&&t.data.length){t.data.unshift({name:"全部",platformId:0}),e.platformIdOptions=t.data}}).catch(function(e){console.log("提示(手动补单-获取平台列表):",e.message)})},changeSize:function(e){this.pageSize=e,this.doSearchHandel()},changeCurrent:function(e){this.pageNum=e,this.doSearchHandel()},doSearchHandel:function(e){var t=this;this.orderIdList=[],this.loading=!0,!0===e&&(this.pageNum=1),this.$http.post(v,p()({},this.searchContent,{pageNum:this.pageNum,pageSize:this.pageSize,DIFFCITY:!0})).then(function(e){if(t.loading=!1,0!==e.code)throw new Error(e.msg);if(e.data&&e.data.result&&e.data.result.length){var a=!0,r=!1,i=void 0;try{for(var s,n=c()(e.data.result);!(a=(s=n.next()).done);a=!0){var o=s.value;o.shopName&&""!==o.shopName||(o.shopName="暂无")}}catch(e){r=!0,i=e}finally{try{!a&&n.return&&n.return()}finally{if(r)throw i}}t.tableData=e.data.result}else t.tableData=[];1==t.pageNum&&(t.total=e.data.total)}).catch(function(e){t.loading=!1,t.$notify.error({title:"提示",message:e.message})})},showErrDetail:function(e){this.errDetailMesg=JSON.parse(e),this.orderErrorMesgVisible=!0},makeUpOrders:function(e){var t=this;this.singleOrderId=[],this.singleOrderId.push(e.orderId),this.$http.post(w,{orderIdList:this.singleOrderId,DIFFCITY:!0}).then(function(e){if(t.loading=!1,0===e.code)return t.$message.success("Oh yeah，补单成功！！"),void t.doSearchHandel();throw new Error(e.msg)}).catch(function(e){t.loading=!1,t.$notify.error({title:"提示",message:e.message})})},makeUpAllOrdersHandel:function(){var e=this;f.r(),this.$http.post(w,{orderIdList:this.orderIdList,DIFFCITY:!0}).then(function(t){if(f.c(),0===t.code)return e.makeUpOrdersDialogShow=!0,e.makeUpOrdersTitle="补单成功",e.makeUpOrdersResDetail="Oh yeah，补单成功！",void e.doSearchHandel();if(1===t.code)return e.makeUpOrdersDialogShow=!0,e.makeUpOrdersTitle="补单失败",void(e.makeUpOrdersResDetail="Sorry，补单失败，请在列表中查看失败原因并做相应处理！");if(2===t.code){e.makeUpOrdersDialogShow=!0,e.makeUpOrdersTitle="补单部分成功";var a="";return t.data&&t.data.length>0&&(a=t.data.join(",")),e.makeUpOrdersResDetail="批量处理补单部分成功！失败订单编号为："+a+"，请在列表中查看失败原因并做相应处理！",void e.doSearchHandel()}throw new Error(t.msg)}).catch(function(t){f.c(),e.$notify.error({title:"提示",message:t.message})})},handleSelect:function(e,t){var a=[];f.j(this.orderIdList,t.orderId)>-1?this.orderIdList=f.p(this.orderIdList,t.orderId):(a.push(t.orderId),this.orderIdListTemp=[].concat(a,l()(this.orderIdList)),this.orderIdList=n()(new i.a(this.orderIdListTemp)))},handleSelectAll:function(e){if(e.length>0){var t=!0,a=!1,r=void 0;try{for(var s,o=c()(e);!(t=(s=o.next()).done);t=!0){var d=s.value;this.orderIdList.push(d.orderId)}}catch(e){a=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(a)throw r}}this.orderIdList=n()(new i.a(this.orderIdList))}else{var h=[],p=!0,u=!1,m=void 0;try{for(var f,g=c()(this.tableData);!(p=(f=g.next()).done);p=!0){var v=f.value;h.push(v.orderId)}}catch(e){u=!0,m=e}finally{try{!p&&g.return&&g.return()}finally{if(u)throw m}}this.orderIdList=n()(new i.a([].concat(l()(this.orderIdList)).filter(function(e){return!new i.a(h).has(e)})))}}}},I={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowTip,expression:"isShowTip"}],staticClass:"error-t-w"},[a("i",{staticClass:"el-icon-warning"}),e._v("注意：请修复问题后再补单，请按门店检索后全选批量补单，或按三方平台检索后全选批量补单\n    "),a("span",{staticClass:"c-btn-w"},[a("i",{staticClass:"el-icon-close",on:{click:e.isShowTipHandel}})])]),e._v(" "),a("div",{staticClass:"search-form-wraper"},[a("el-form",{attrs:{model:e.searchContent,"label-position":"top"}},[a("el-form-item",{attrs:{label:"三方门店ID"}},[a("el-input",{staticClass:"search-input",attrs:{placeholder:"请输入三方门店ID",size:"small",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.doSearchHandel(!0)}},model:{value:e.searchContent.shopId,callback:function(t){e.$set(e.searchContent,"shopId","string"==typeof t?t.trim():t)},expression:"searchContent.shopId"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"门店名称"}},[a("el-input",{staticClass:"search-input",attrs:{placeholder:"请输入门店名称",size:"small",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.doSearchHandel(!0)}},model:{value:e.searchContent.shopName,callback:function(t){e.$set(e.searchContent,"shopName","string"==typeof t?t.trim():t)},expression:"searchContent.shopName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"三方平台"}},[a("el-select",{staticClass:"search-input",attrs:{filterable:"",placeholder:"请选择三方平台",clearable:"",size:"small"},on:{change:function(t){return e.doSearchHandel(!0)}},model:{value:e.searchContent.platformId,callback:function(t){e.$set(e.searchContent,"platformId",t)},expression:"searchContent.platformId"}},e._l(e.platformIdOptions,function(e){return a("el-option",{key:e.platformId,attrs:{label:e.name,value:e.platformId}})}),1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.doSearchHandel(!0)}}},[e._v("搜索")])],1)],1)],1),e._v(" "),a("div",{staticClass:"table-wraper"},[a("div",{staticClass:"sp-handel-w"},[a("el-button",{staticClass:"sup-mini",attrs:{size:"mini",disabled:0===this.orderIdList.length,icon:"el-icon-edit"},on:{click:e.makeUpAllOrdersHandel}},[e._v("批量补单")])],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticClass:"fixed-height",staticStyle:{width:"100%"},attrs:{data:e.tableData,"empty-text":"没有查询到您想要的数据",size:"small"},on:{select:e.handleSelect,"select-all":e.handleSelectAll}},[a("el-table-column",{attrs:{type:"selection",label:"全选",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"100px",prop:"platformName",label:"三方平台"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"178px",prop:"orderId",label:"订单号"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"110px",formatter:e.nullTreating,prop:"shopId",label:"三方门店ID"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"140px",prop:"shopName",label:"门店名称"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"220px",label:"详细信息"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"d-j-w"},[a("div",{staticClass:"detail-j-w"},[e._v(e._s(t.row.detailJson))]),e._v(" "),a("div",{staticClass:"s-d-m-w",on:{click:function(a){return e.showErrDetail(t.row.detailJson)}}},[e._v("查看信息")])])]}}])}),e._v(" "),a("el-table-column",{attrs:{"min-width":"150px",prop:"errMsg",label:"接入失败原因"}}),e._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",icon:"el-icon-edit"},on:{click:function(a){return e.makeUpOrders(t.row)}}},[e._v("补单")])]}}])})],1),e._v(" "),a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:e.tableData.length>0,expression:"tableData.length>0"}],staticClass:"tc mt20",attrs:{background:"","current-page":e.pageNum,"page-sizes":e.pageSizes,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.changeSize,"current-change":e.changeCurrent,"update:currentPage":function(t){e.pageNum=t},"update:current-page":function(t){e.pageNum=t}}})],1),e._v(" "),a("el-dialog",{attrs:{title:"详细信息",visible:e.orderErrorMesgVisible,width:"50%"},on:{"update:visible":function(t){e.orderErrorMesgVisible=t}}},[a("div",{staticClass:"dailog-e-m-d-w"},[a("pre",[e._v("        "+e._s(e.errDetailMesg)+"\n      ")])]),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){e.orderErrorMesgVisible=!1}}},[e._v("关 闭")])],1)]),e._v(" "),a("el-dialog",{attrs:{title:e.makeUpOrdersTitle,visible:e.makeUpOrdersDialogShow,width:"400px"},on:{"update:visible":function(t){e.makeUpOrdersDialogShow=t}}},[a("div",{staticClass:"dailog-e-m-d-w"},[e._v("\n      "+e._s(e.makeUpOrdersResDetail)+"\n    ")]),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){e.makeUpOrdersDialogShow=!1}}},[e._v("确 定")])],1)])],1)},staticRenderFns:[]};var k=a("VU/8")(b,I,!1,function(e){a("ODh/")},null,null);t.default=k.exports}});
//# sourceMappingURL=125.517bc61269be0e507fd8.js.map