webpackJsonp([73],{"b9+5":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("Dd8w"),o=a.n(n),r=a("BO1k"),l=a.n(r),s=a("oAV5"),i=a("NXPJ"),c=a("utSn"),u=a("ssT3"),h="/plateform/a/store/condition/search",d="/plateform/a/store/platform/show",p="/plateform/a/store/platform/newStore",f="/plateform/a/store/platform/updateStatus",m={data:function(){return{loading:!1,pageNum:1,pageSize:10,total:0,searchContent:{storeNo:"",openStatus:"",openOnline:"",saleType:"",platform:3},openStatusOptList:[{label:"全部",value:""},{label:"营业中",value:1},{label:"歇业中",value:2},{label:"待开业",value:0}],saleTypeOptList:[{label:"全部",value:""},{label:"直营",value:1},{label:"加盟",value:2},{label:"分销",value:3},{label:"自提",value:4}],openOnlineOptList:[{label:"全部",value:""},{label:"禁用",value:0},{label:"启用",value:1}],unOpenedPlatformOptList:[{name:"全部",platformId:""}],storeOptions:[],tableData:[]}},created:function(){this.getStoreList()},beforeMount:function(){var e=u.a.get("searchContentMtMgt");this.$route.meta.keepAlive&&e&&(this.searchContent=e.searchContent)},mounted:function(){this.doSearchHandel(!0)},components:{"open-on-jtp":c.a,"my-table":i.a},methods:{getStoreList:function(){var e=this;this.$http.post(h).then(function(t){if(0!==t.code)throw new Error(t.msg);if(t.data&&t.data.length){var a=[],n=!0,o=!1,r=void 0;try{for(var s,i=l()(t.data);!(n=(s=i.next()).done);n=!0){var c=s.value,u={value:c.storeNo,label:c.storeNo+"-"+c.storeName};a.push(u)}}catch(e){o=!0,r=e}finally{try{!n&&i.return&&i.return()}finally{if(o)throw r}}e.storeOptions=a}else e.storeOptions=[]}).catch(function(e){console.log("提示(获取门店列表):",e.message)})},doSearchHandel:function(e){var t=this;!0===e&&(this.pageNum=1),this.loading=!0,this.$http.post(d,o()({},this.searchContent,{pageSize:this.pageSize,pageNum:this.pageNum})).then(function(e){if(t.loading=!1,0!==e.code)throw new Error(e.msg);if(e.data){if(e.data.list&&e.data.list.length){var a=!0,n=!1,o=void 0;try{for(var r,s=l()(e.data.list);!(a=(r=s.next()).done);a=!0){var i=r.value;i.uniqueId=i.storeId+i.storeNo}}catch(e){n=!0,o=e}finally{try{!a&&s.return&&s.return()}finally{if(n)throw o}}t.tableData=e.data.list;var c={platformCode:t.searchContent.platform,tableData:t.tableData};t.$refs.myTable&&t.$refs.myTable.setDefaultMesg(c)}else{t.tableData=[];var u={platformCode:t.searchContent.platform,tableData:t.tableData};t.$refs.myTable&&t.$refs.myTable.setDefaultMesg(u)}1===t.pageNum&&(t.total=e.data.total)}else{t.tableData=[];var h={platformCode:t.searchContent.platform,tableData:t.tableData};t.$refs.myTable&&t.$refs.myTable.setDefaultMesg(h)}}).catch(function(e){t.loading=!1,t.$notify.error({title:"提示",message:e.message})})},changeSize:function(e){this.pageSize=e,this.doSearchHandel()},changeCurrent:function(e){this.pageNum=e,this.doSearchHandel()},openOnlineJob:function(e){var t={searchContent:this.searchContent};u.a.set("searchContentMtMgt",t);var a=e.platformId,n=e.storeNo,o=e.storeId;this.$router.push("/blx_store/o_ol_job/"+a+"/"+n+"/"+o)},openOnlineJobThirdP:function(e){e&&this.$refs.OpenOnlineJobThirdP.setDefaule(e)},sureCategorical:function(e){var t=this;if(e.storeNo){var a=e.storeNo;this.$http.get(p,{storeNo:a}).then(function(e){if(t.loading=!1,0!==e.code)throw new Error(e.msg);t.doSearchHandel()}).catch(function(e){t.loading=!1,t.$notify.error({title:"提示",message:e.message})})}},batchOpenHandel:function(e){var t=this,a=e.checkedList,n=[],o=!0,r=!1,i=void 0;try{for(var c,u=l()(a);!(o=(c=u.next()).done);o=!0){var h=c.value;if(0===h.openStatus)return void this.$notify.warning({title:"系统提示",message:"勾选的门店有待开业的，不能直接批量操作营业/歇业"});n.push(h.platformStoreId)}}catch(e){r=!0,i=e}finally{try{!o&&u.return&&u.return()}finally{if(r)throw i}}s.r(),this.$http.post(f,{ids:n,openStatus:1}).then(function(e){if(s.c(),0===e.code)return t.$message.success("批量营业成功"),void t.doSearchHandel();throw new Error(e.msg)}).catch(function(e){s.c(),t.$notify.error({title:"提示",message:e.message})})},batchCloseHandel:function(e){var t=this,a=e.checkedList,n=[],o=!0,r=!1,i=void 0;try{for(var c,u=l()(a);!(o=(c=u.next()).done);o=!0){var h=c.value;if(0===h.openStatus)return void this.$notify.warning({title:"系统提示",message:"勾选的门店有待开业的，不能直接批量操作营业/歇业"});n.push(h.platformStoreId)}}catch(e){r=!0,i=e}finally{try{!o&&u.return&&u.return()}finally{if(r)throw i}}s.r(),this.$http.post(f,{ids:n,openStatus:2}).then(function(e){if(s.c(),0===e.code)return t.$message.success("批量歇业成功"),void t.doSearchHandel();throw new Error(e.msg)}).catch(function(e){s.c(),t.$notify.error({title:"提示",message:e.message})})},batchEableHandel:function(e){var t=this,a=e.checkedList,n=[],o=[],r=!0,i=!1,c=void 0;try{for(var u,h=l()(a);!(r=(u=h.next()).done);r=!0){var d=u.value;if(0!=d.shopId&&!d.shopId&&5!==d.platformId)return void this.$notify.warning({title:"温馨提示",message:"勾选的门店存在三方门店ID为空的门店，不能直接操作启用/禁用"});if(!d.phone)return void this.$notify.warning({title:"温馨提示",message:"【"+d.storeNo+"_"+d.storeName+"】的门店电话不能为空"});o.push(d.storeId),n.push(d.platformStoreId)}}catch(e){i=!0,c=e}finally{try{!r&&h.return&&h.return()}finally{if(i)throw c}}s.r(),this.$http.post(f,{ids:n,storeIds:o,openOnline:1}).then(function(e){if(s.c(),0===e.code)return t.$message.success("批量启用成功"),void t.doSearchHandel();throw new Error(e.msg)}).catch(function(e){s.c(),t.$notify.error({title:"提示",message:e.message})})},batchDisableHandel:function(e){var t=this,a=e.checkedList,n=[],o=[],r=!0,i=!1,c=void 0;try{for(var u,h=l()(a);!(r=(u=h.next()).done);r=!0){var d=u.value;if(0!=d.shopId&&!d.shopId&&5!==d.platformId)return void this.$notify.warning({title:"温馨提示",message:"勾选的门店存在三方门店ID为空的门店，不能直接操作启用/禁用"});o.push(d.storeId),n.push(d.platformStoreId)}}catch(e){i=!0,c=e}finally{try{!r&&h.return&&h.return()}finally{if(i)throw c}}s.r(),this.$http.post(f,{ids:n,storeIds:o,openOnline:0}).then(function(e){if(s.c(),0===e.code)return t.$message.success("批量禁用成功"),void t.doSearchHandel();throw new Error(e.msg)}).catch(function(e){s.c(),t.$notify.error({title:"提示",message:e.message})})}},beforeRouteLeave:function(e,t,a){t.meta.keepAlive=!1,a()}},v={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"search-form-wraper"},[a("el-form",{attrs:{model:e.searchContent,"label-position":"top"}},[a("el-form-item",{attrs:{label:"门店"}},[a("el-select",{staticClass:"search-input",attrs:{filterable:"",placeholder:"请选择门店",clearable:"",size:"small"},on:{change:function(t){return e.doSearchHandel(!0)}},model:{value:e.searchContent.storeNo,callback:function(t){e.$set(e.searchContent,"storeNo",t)},expression:"searchContent.storeNo"}},e._l(e.storeOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"门店类型"}},[a("el-select",{staticClass:"search-input",attrs:{placeholder:"请选择门店类型",size:"small"},on:{change:function(t){return e.doSearchHandel(!0)}},model:{value:e.searchContent.saleType,callback:function(t){e.$set(e.searchContent,"saleType",t)},expression:"searchContent.saleType"}},e._l(e.saleTypeOptList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"营业状态"}},[a("el-select",{staticClass:"search-input",attrs:{placeholder:"请选择营业状态",size:"small"},on:{change:function(t){return e.doSearchHandel(!0)}},model:{value:e.searchContent.openStatus,callback:function(t){e.$set(e.searchContent,"openStatus",t)},expression:"searchContent.openStatus"}},e._l(e.openStatusOptList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"启用状态"}},[a("el-select",{staticClass:"search-input",attrs:{placeholder:"请选择启用状态",size:"small"},on:{change:function(t){return e.doSearchHandel(!0)}},model:{value:e.searchContent.openOnline,callback:function(t){e.$set(e.searchContent,"openOnline",t)},expression:"searchContent.openOnline"}},e._l(e.openOnlineOptList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.doSearchHandel(!0)}}},[e._v("搜索")])],1)],1)],1),e._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"table-wraper tab-wraper"},[a("my-table",{ref:"myTable",on:{openOnlineJobThirdP:e.openOnlineJobThirdP,sureCategorical:e.sureCategorical,openOnlineJob:e.openOnlineJob,batchOpenHandel:e.batchOpenHandel,batchCloseHandel:e.batchCloseHandel,batchEableHandel:e.batchEableHandel,batchDisableHandel:e.batchDisableHandel}})],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.tableData.length>0,expression:"tableData.length > 0"}],staticClass:"pagination"},[a("el-pagination",{attrs:{background:"","current-page":e.pageNum,"page-sizes":[10,50,100,150,200],layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.changeSize,"current-change":e.changeCurrent,"update:currentPage":function(t){e.pageNum=t},"update:current-page":function(t){e.pageNum=t}}})],1),e._v(" "),a("div",[a("open-on-jtp",{ref:"OpenOnlineJobThirdP",on:{doSearchHandel:e.doSearchHandel}})],1)])},staticRenderFns:[]};var g=a("VU/8")(m,v,!1,function(e){a("d6vx")},null,null);t.default=g.exports},d6vx:function(e,t){}});
//# sourceMappingURL=73.f31a7ecfc6944a346dbd.js.map