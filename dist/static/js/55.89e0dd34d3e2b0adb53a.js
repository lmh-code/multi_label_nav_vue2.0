webpackJsonp([55],{"K/i0":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("Dd8w"),i=a.n(n),s=a("Gu7T"),o=a.n(s),r=a("oAV5"),l=a("bzuE"),c=a("u6Xy"),u=a("ssT3"),d=a("XfvZ"),h=a("8uth"),p={data:function(){return{pageSizes:l.a.pageSizes10,loading:!1,exportLoading:!1,pageNum:1,pageSize:10,total:0,tableData:[],searchContent:{DIFFCITY:!0,regionCode:u.a.get("regionCode")||"",checkStatus:0,activityPlatCityGoodsId:"",goodsName:"",vendorNo:"",activityStatus:"",defaultRangeReq:[r.u(Date.parse(new Date))+" 00:00:00",r.u(Date.parse(new Date))+" 23:59:59"],reqStartTime:r.u(Date.parse(new Date))+" 00:00:00",reqEndTime:r.u(Date.parse(new Date))+" 23:59:59",defaultRangeCheck:[],checkStartTime:"",checkEndTime:""},vendorList:[],statusOptions:[{label:"全部",value:""},{label:"进行中",value:3},{label:"未发布",value:0},{label:"未开始",value:2},{label:"已结束",value:4},{label:"已终止",value:5}],checkStatusOptions:[{label:"待审核",value:0},{label:"已审核",value:1}],checkedList:[],exportConfig:{skuNo:"SKU编码",goodsNo:"商品编码",activityPlatCityGoodsId:"活动商品ID",activityGoodsName:"活动商品名称",spec:"规格",activityStatusStr:"活动状态",oldPrice:"原售价",newPrice:"新售价",checkStatusStr:"审核状态",checkTime:"审核时间",checkUser:"审核人"},checkLoading:!1}},mounted:function(){this.getVendorlist(),this.doSearchHandel(!0)},components:{"date-picker-range":d.a},methods:{getVendorlist:function(){var t=this;this.$http.post(c.a.vendorlist,{regionCode:this.searchContent.regionCode,DIFFCITY:this.searchContent.DIFFCITY}).then(function(e){if(0!==e.code)throw new Error(e.msg);t.vendorList=e.data&&e.data.length?[{vendorNo:"",vendorName:"全部"}].concat(o()(e.data)):[]}).catch(function(t){console.log("获取供应商编码及名称（编码[vendorCode]，名称[vendorName]）报错：",t.message)})},defaultRangeReqChange:function(t){this.searchContent.defaultRangeReq=t?[].concat(o()(t)):t,this.searchContent.reqStartTime=t?t[0]:"",this.searchContent.reqEndTime=t?t[1]:"",this.doSearchHandel(!0)},defaultRangeCheckChange:function(t){this.searchContent.defaultRangeCheck=t?[].concat(o()(t)):t,this.searchContent.checkStartTime=t?t[0]:"",this.searchContent.checkEndTime=t?t[1]:"",this.doSearchHandel(!0)},changeSize:function(t){this.pageSize=t,this.doSearchHandel()},changeCurrent:function(t){this.pageNum=t,this.doSearchHandel()},handleSelect:function(t,e){if(t.includes(e))this.checkedList.push(e);else{var a=this.checkedList.findIndex(function(t){return t.storeNo===e.storeNo});this.checkedList.splice(a,1)}},handleSelectAll:function(t){this.checkedList=[].concat(o()(t))},doSearchHandel:function(t){var e=this;!0===t&&(this.pageNum=1),this.loading=!0,this.checkStatusStr=[],this.$http.post(c.a.quoteList,i()({},this.searchContent,{pageNum:this.pageNum,pageSize:this.pageSize})).then(function(t){if(e.loading=!1,0!==t.code)throw new Error(t.msg);t.data?(e.tableData=t.data.result&&t.data.result.length?t.data.result:[],e.total=t.data.total):(e.total=0,e.tableData=[])}).catch(function(t){e.loading=!1,e.$notify.error({title:"提示",message:t.message})})},activityStatusFormatter:function(t,e,a,n){return 0===a?"未发布":1==a?"已发布":2==a?"未开始[发布中]":3==a?"进行中[发布中]":4==a?11===t.activityType?"已结束[发布中]":"已结束":5==a?"已终止":6==a?"已失效":void 0},exportData:function(){var t=this;this.exportLoading=!0,this.$http.post(c.a.quoteExport,i()({},this.searchContent)).then(function(e){if(t.exportLoading=!1,0!==e.code)throw new Error(e.msg);var a=e.data&&e.data.result&&e.data.result.length?e.data.result:[];if(a.forEach(function(t){0===t.activityStatus?t.activityStatusStr="未发布":1==t.activityStatus?t.activityStatusStr="已发布":2==t.activityStatus?t.activityStatusStr="未开始[发布中]":3==t.activityStatus?t.activityStatusStr="进行中[发布中]":4==t.activityStatus?11===t.activityType?t.activityStatusStr="已结束[发布中]":t.activityStatusStr="已结束":5==t.activityStatus?t.activityStatusStr="已终止":6==t.activityStatus&&(t.activityStatusStr="已失效"),t.checkStatusStr=1===t.checkStatus?"已审核":0===t.checkStatus?"待审核":""}),0===a.length)t.$notify.warning({title:"温馨提示",message:"没有查询到要导出的数据"}),t.isDisabled=!1;else{var n=r.o(t.exportConfig,!1),i=r.o(t.exportConfig,!0);h.a.ExportJsonToExcel({header:n,filterVal:i,data:a,filename:"报价审核商品"}),setTimeout(function(){t.$notify.success({title:"温馨提示",message:"报价审核商品导出成功"}),t.isDisabled=!1},500)}}).catch(function(e){t.exportLoading=!1,t.$notify.error({title:"提示",message:e.message})})},checkHandel:function(t,e){var a=this,n={DIFFCITY:!0},s=[];t?(s.push(e.id),n.ids=s):(s=this.checkedList.map(function(t){return t.id}),n.ids=s),this.$confirm("您确定要审核所选商品吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.checkLoading=!0,r.r(),a.$http.post(c.a.checkPrice,i()({},n)).then(function(t){if(a.checkLoading=!1,r.c(),0===t.code)return a.$message.success("审核成功"),void a.doSearchHandel();throw new Error(t.msg)}).catch(function(t){a.checkLoading=!1,r.c(),a.$notify.error({title:"提示",message:t.message})})}).catch(function(){})}}},v={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"search-form-wraper"},[a("el-form",{attrs:{model:t.searchContent,"label-position":"top"}},[a("el-form-item",{attrs:{label:"申请时间"}},[a("date-picker-range",{attrs:{defaultRange:t.searchContent.defaultRangeReq},on:{datePickerRangeChange:t.defaultRangeReqChange}})],1),t._v(" "),a("el-form-item",{attrs:{label:"审核时间"}},[a("date-picker-range",{attrs:{defaultRange:t.searchContent.defaultRangeCheck},on:{datePickerRangeChange:t.defaultRangeCheckChange}})],1),t._v(" "),a("el-form-item",{attrs:{label:"审核状态"}},[a("el-select",{staticClass:"search-input",attrs:{filterable:"",placeholder:"请选择审核状态",size:"small",clearable:""},on:{change:function(e){return t.doSearchHandel(!0)}},model:{value:t.searchContent.checkStatus,callback:function(e){t.$set(t.searchContent,"checkStatus",e)},expression:"searchContent.checkStatus"}},t._l(t.checkStatusOptions,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"活动商品ID"}},[a("el-input",{staticClass:"search-input",attrs:{placeholder:"活动商品ID",size:"small",clearable:""},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.doSearchHandel(!0)}},model:{value:t.searchContent.activityPlatCityGoodsId,callback:function(e){t.$set(t.searchContent,"activityPlatCityGoodsId","string"==typeof e?e.trim():e)},expression:"searchContent.activityPlatCityGoodsId"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"SKU编码/商品名称"}},[a("el-input",{staticClass:"search-input",attrs:{placeholder:"SKU编码/商品名称",size:"small",clearable:""},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.doSearchHandel(!0)}},model:{value:t.searchContent.goodsName,callback:function(e){t.$set(t.searchContent,"goodsName","string"==typeof e?e.trim():e)},expression:"searchContent.goodsName"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"供应商专供"}},[a("el-select",{staticClass:"search-input",attrs:{filterable:"",placeholder:"供应商专供",size:"small",clearable:""},on:{change:function(e){return t.doSearchHandel(!0)}},model:{value:t.searchContent.vendorNo,callback:function(e){t.$set(t.searchContent,"vendorNo",e)},expression:"searchContent.vendorNo"}},t._l(t.vendorList,function(t){return a("el-option",{key:t.vendorNo,attrs:{label:t.vendorName,value:t.vendorNo}})}),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"活动状态"}},[a("el-select",{staticClass:"search-input",attrs:{filterable:"",placeholder:"请选择状态",clearable:"",size:"small"},on:{change:function(e){return t.doSearchHandel(!0)}},model:{value:t.searchContent.activityStatus,callback:function(e){t.$set(t.searchContent,"activityStatus",e)},expression:"searchContent.activityStatus"}},t._l(t.statusOptions,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.doSearchHandel(!0)}}},[t._v("搜索")]),t._v(" "),a("el-button",{attrs:{size:"mini",icon:"el-icon-download",loading:t.exportLoading},on:{click:t.exportData}},[t._v("导出")])],1)],1)],1),t._v(" "),a("div",{staticClass:"table-wraper"},[a("div",{staticClass:"batch-handel-w"},[a("el-button",{staticClass:"sup-mini",attrs:{size:"mini",icon:"el-icon-circle-check",disabled:0===t.checkedList.length||t.checkLoading},on:{click:function(e){return t.checkHandel(!1,t.checkedList)}}},[t._v("批量审核")])],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"fixed-height",staticStyle:{width:"100%"},attrs:{data:t.tableData,"empty-text":"没有查询到您想要的数据",size:"small"},on:{select:t.handleSelect,"select-all":t.handleSelectAll}},[a("el-table-column",{attrs:{type:"selection",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{"min-width":"110px",label:"申请时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.reqTime?a("div",[a("p",[t._v(t._s(e.row.reqTime.substr(0,10)))]),t._v(" "),a("p",[t._v(t._s(e.row.reqTime.substr(11,8)))])]):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{"min-width":"140px",label:"ID"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[a("p",{staticClass:"ll-erp-p-no"},[t._v("活动ID: "+t._s(e.row.activityId))]),t._v(" "),a("p",{staticClass:"ll-erp-p-no"},[t._v("活动商品ID: "+t._s(e.row.activityPlatCityGoodsId))]),t._v(" "),a("p",{staticClass:"ll-erp-p-no"},[t._v("SKU编码: "+t._s(e.row.skuNo))])])]}}])}),t._v(" "),a("el-table-column",{attrs:{"min-width":"280px",label:"商品信息"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"ll-p-m-w"},[a("div",{staticClass:"sf-pre-goods-img-w"},[e.row.presaleImageUrl&&""!=e.row.presaleImageUrl?a("img",{attrs:{src:e.row.presaleImageUrl,alt:"",onerror:"onerror=null;src='/shop/static/img_error.png'"}}):a("img",{attrs:{src:"/shop/static/img_error.png",alt:""}}),t._v(" "),e.row.vendorName?a("div",{staticClass:"vendor-tag"},[t._v(t._s(e.row.vendorName)+"专供")]):t._e()]),t._v(" "),a("div",{staticClass:"ll-p-m-c-r"},[a("div",[t._v(t._s(e.row.activityGoodsName||"-"))]),t._v(" "),a("div",{staticClass:"ll-erp-p-no"},[t._v("商品编码："+t._s(e.row.goodsNo||"--"))]),t._v(" "),a("div",{staticClass:"ll-erp-p-no"},[t._v("区域商品ID："+t._s(e.row.platformCityGoodsId||"--"))])])])]}}])}),t._v(" "),a("el-table-column",{attrs:{"min-width":"100px",prop:"spec",label:"规格"}}),t._v(" "),a("el-table-column",{attrs:{"min-width":"120px",prop:"activityStatus",label:"活动状态",formatter:t.activityStatusFormatter}}),t._v(" "),a("el-table-column",{attrs:{"min-width":"90px",prop:"oldPrice",label:"原售价"}}),t._v(" "),a("el-table-column",{attrs:{"min-width":"90px",prop:"newPrice",label:"新售价"}}),t._v(" "),a("el-table-column",{attrs:{"min-width":"90px",label:"审核状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[t._v(t._s(1===e.row.checkStatus?"已审核":0===e.row.checkStatus?"待审核":""))])]}}])}),t._v(" "),a("el-table-column",{attrs:{"min-width":"110px",label:"审核时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.checkTime?a("div",[a("p",[t._v(t._s(e.row.checkTime.substr(0,10)))]),t._v(" "),a("p",[t._v(t._s(e.row.checkTime.substr(11,8)))])]):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{"min-width":"90px",prop:"checkUser",label:"审核人"}}),t._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[0===e.row.checkStatus?a("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-circle-check",disabled:t.checkLoading},on:{click:function(a){return t.checkHandel(!0,e.row)}}},[t._v("审核")]):t._e()]}}])})],1),t._v(" "),t.total>0?a("el-pagination",{staticClass:"tc mt20",attrs:{background:"","current-page":t.pageNum,"page-sizes":t.pageSizes,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.changeSize,"current-change":t.changeCurrent,"update:currentPage":function(e){t.pageNum=e},"update:current-page":function(e){t.pageNum=e}}}):t._e()],1)])},staticRenderFns:[]};var m=a("VU/8")(p,v,!1,function(t){a("uwm0")},null,null);e.default=m.exports},uwm0:function(t,e){}});
//# sourceMappingURL=55.89e0dd34d3e2b0adb53a.js.map