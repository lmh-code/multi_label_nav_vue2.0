webpackJsonp([74],{"U+b7":function(e,t){},x8vS:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=a("Dd8w"),r=a.n(l),n=a("BO1k"),o=a.n(n),s=a("FzCZ"),i=a("oAV5"),u="/plateform/a/store/condition/search",c="/plateform/a/mall/reportForm/payOrder/search",p="/plateform/a/mall/reportForm/payOrder/export",d={data:function(){return{exportLoading:!1,loading:!1,pageNum:1,pageSize:20,total:0,searchContent:{storeType:"",storeNo:null,tradeStartDate:i.u((new Date).getTime())+" 00:00:00",tradeEndDate:i.u((new Date).getTime())+" 23:59:59",phone:null,payOrderId:null,payChannel:"",tradeOrderType:"",serNo:null,tradeSource:"",tradeStatus:""},storeTypeOptions:[{label:"全部",value:""},{label:"直营",value:1},{label:"加盟",value:2}],tradeOrderTypeOptions:[{label:"全部",value:""},{label:"消费",value:1},{label:"充值",value:2}],payChannelOptions:[{label:"全部",value:""},{label:"微信支付",value:"WECHAT"},{label:"银行支付",value:"BANK"},{label:"支付宝支付",value:"ALIPAY"},{label:"现金支付",value:"CASH"},{label:"线下老版本余额支付",value:"DEPOSIT"},{label:"本来支付",value:"BLAPI"},{label:"线下积分支付",value:"POINT"},{label:"线上积分支付",value:"OL_POINT"},{label:"线上会员余额支付",value:"OL_DEPOSIT"},{label:"支付宝代支付",value:"ALIPAY_AGENT"},{label:"微信代支付",value:"WECHAT_AGENT"},{label:"其他支付",value:"OTHER"}],tradeSourceOptions:[{label:"全部",value:""},{label:"线下",value:1},{label:"线上",value:2}],tradeStatusOptions:[{label:"全部",value:""},{label:"待支付",value:0},{label:"支付中",value:1},{label:"支付成功",value:2},{label:"支付失败",value:3},{label:"支付取消",value:4},{label:"支付关闭",value:5},{label:"退款中",value:6},{label:"部分退款中",value:7},{label:"退款成功",value:8},{label:"部分退款成功",value:9},{label:"退款失败",value:10},{label:"未知状态",value:99}],storeOptions:[],tableData:[],exportConfig:{cityName:"城市",storeNo:"门店编码",storeTypeStr:"门店类型",storeName:"门店名称",tradeDate:"交易时间",phone:"会员手机号",tradeOrderTypeStr:"交易类型",tradeSourceStr:"交易来源",payAmount:"交易金额",tradeStatusStr:"交易状态",refundAmount:"退款金额",leftStoreAmount:"账号余额",payChannelStr:"支付渠道",payOrderId:"交易流水号",payThirdOrderId:"三方流水号",serNo:"小票号"}}},created:function(){this.getStoreList()},mounted:function(){this.doSearchHandel(!0)},methods:{emptyFormater:function(e,t,a){return a||"-"},storeTypeFormater:function(e,t,a){return 1===a?"直营":2===a?"加盟":"-"},tradeOrderTypeFormater:function(e,t,a){return 1===a?"消费":2===a?"充值":"-"},tradeSourceFormater:function(e,t,a){return 1===a?"线下":2===a?"线上":"-"},getStoreList:function(){var e=this;this.$http.post(u).then(function(t){if(0!==t.code)throw new Error(t.msg);if(t.data&&t.data.length){var a=[],l=!0,r=!1,n=void 0;try{for(var s,i=o()(t.data);!(l=(s=i.next()).done);l=!0){var u=s.value,c={value:u.storeNo,label:u.storeNo+"-"+u.storeName};a.push(c)}}catch(e){r=!0,n=e}finally{try{!l&&i.return&&i.return()}finally{if(r)throw n}}a.unshift({value:null,label:"全部"}),e.storeOptions=a}}).catch(function(e){console.log("提示(获取门店列表):",e.message)})},changeSize:function(e){this.pageSize=e,this.doSearchHandel()},changeCurrent:function(e){this.pageNum=e,this.doSearchHandel()},doSearchHandel:function(e){var t=this;this.loading=!0,!0===e&&(this.pageNum=1),this.$http.post(c,r()({},this.searchContent,{pageNum:this.pageNum,pageSize:this.pageSize})).then(function(e){if(t.loading=!1,0!==e.code)throw new Error(e.msg);if(e.data&&e.data.result&&e.data.result.length){var a=e.data.result.map(function(e,a){var l=t.payChannelOptions.filter(function(t){return t.value===e.payChannel})[0];e.payChannelStr=l&&l.label?l.label:"";var r=t.tradeStatusOptions.filter(function(t){return t.value===e.tradeStatus})[0];return e.tradeStatusStr=r&&r.label?r.label:"-",e});t.tableData=a}else t.tableData=[];t.total=e.data.total}).catch(function(e){t.loading=!1,t.$notify.error({title:"提示(会员基础数据):",message:e.message})})},exportData:function(){var e=this;this.exportLoading=!0,this.$http.post(p,r()({},this.searchContent)).then(function(t){if(e.exportLoading=!1,0!==t.code)throw new Error(t.msg);if(t.data&&t.data.result&&t.data.result.length){var a=t.data.result.map(function(t,a){var l=e.storeTypeOptions.filter(function(e){return e.value===t.storeType})[0];t.storeTypeStr=l&&l.label?l.label:"";var r=e.tradeOrderTypeOptions.filter(function(e){return e.value===t.tradeOrderType})[0];t.tradeOrderTypeStr=r&&r.label?r.label:"";var n=e.tradeSourceOptions.filter(function(e){return e.value===t.tradeSource})[0];t.tradeSourceStr=n&&n.label?n.label:"";var o=e.payChannelOptions.filter(function(e){return e.value===t.payChannel})[0];t.payChannelStr=o&&o.label?o.label:"";var s=e.tradeStatusOptions.filter(function(e){return e.value===t.tradeStatus})[0];return t.tradeStatusStr=s&&s.label?s.label:"",t});s.a.exportFileByConfig(a,"财务明细报表.xlsx",e.exportConfig),setTimeout(function(){e.$message.success("导出成功")},500)}else e.$notify.warning({title:"温馨提示",message:"没有查询到要导出的数据"})}).catch(function(t){e.exportLoading=!1,e.$notify.error({title:"提示(导出数据)：",message:t.message})})}}},m={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"search-form-wraper"},[a("el-form",{attrs:{model:e.searchContent,"label-position":"top"}},[a("el-form-item",{attrs:{label:"门店类型"}},[a("el-select",{staticClass:"search-input",attrs:{filterable:"",placeholder:"门店类型",clearable:"",size:"small"},on:{change:function(t){return e.doSearchHandel(!0)}},model:{value:e.searchContent.storeType,callback:function(t){e.$set(e.searchContent,"storeType",t)},expression:"searchContent.storeType"}},e._l(e.storeTypeOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"分店名称"}},[a("el-select",{staticClass:"search-input",attrs:{filterable:"",placeholder:"请选择分店名称",clearable:"",size:"small"},on:{change:function(t){return e.doSearchHandel(!0)}},model:{value:e.searchContent.storeNo,callback:function(t){e.$set(e.searchContent,"storeNo",t)},expression:"searchContent.storeNo"}},e._l(e.storeOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"交易开始时间"}},[a("el-date-picker",{staticClass:"search-input",attrs:{type:"datetime",placeholder:"交易开始时间",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss",size:"small"},on:{change:function(t){return e.doSearchHandel(!0)}},model:{value:e.searchContent.tradeStartDate,callback:function(t){e.$set(e.searchContent,"tradeStartDate",t)},expression:"searchContent.tradeStartDate"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"交易结束时间"}},[a("el-date-picker",{staticClass:"search-input",attrs:{type:"datetime",placeholder:"交易结束时间",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss",size:"small"},on:{change:function(t){return e.doSearchHandel(!0)}},model:{value:e.searchContent.tradeEndDate,callback:function(t){e.$set(e.searchContent,"tradeEndDate",t)},expression:"searchContent.tradeEndDate"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"客户手机号"}},[a("el-input",{staticClass:"search-input",attrs:{placeholder:"客户手机号",size:"small",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.doSearchHandel(!0)}},model:{value:e.searchContent.phone,callback:function(t){e.$set(e.searchContent,"phone","string"==typeof t?t.trim():t)},expression:"searchContent.phone"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"流水号"}},[a("el-input",{staticClass:"search-input",attrs:{placeholder:"流水号",size:"small",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.doSearchHandel(!0)}},model:{value:e.searchContent.payOrderId,callback:function(t){e.$set(e.searchContent,"payOrderId","string"==typeof t?t.trim():t)},expression:"searchContent.payOrderId"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"交易来源"}},[a("el-select",{staticClass:"search-input",attrs:{filterable:"",placeholder:"交易类型",clearable:"",size:"small"},on:{change:function(t){return e.doSearchHandel(!0)}},model:{value:e.searchContent.tradeSource,callback:function(t){e.$set(e.searchContent,"tradeSource",t)},expression:"searchContent.tradeSource"}},e._l(e.tradeSourceOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"交易类型"}},[a("el-select",{staticClass:"search-input",attrs:{filterable:"",placeholder:"交易类型",clearable:"",size:"small"},on:{change:function(t){return e.doSearchHandel(!0)}},model:{value:e.searchContent.tradeOrderType,callback:function(t){e.$set(e.searchContent,"tradeOrderType",t)},expression:"searchContent.tradeOrderType"}},e._l(e.tradeOrderTypeOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"支付渠道"}},[a("el-select",{staticClass:"search-input",attrs:{filterable:"",placeholder:"支付渠道",clearable:"",size:"small"},on:{change:function(t){return e.doSearchHandel(!0)}},model:{value:e.searchContent.payChannel,callback:function(t){e.$set(e.searchContent,"payChannel",t)},expression:"searchContent.payChannel"}},e._l(e.payChannelOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"小票号"}},[a("el-input",{staticClass:"search-input",attrs:{placeholder:"小票号",size:"small",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.doSearchHandel(!0)}},model:{value:e.searchContent.serNo,callback:function(t){e.$set(e.searchContent,"serNo","string"==typeof t?t.trim():t)},expression:"searchContent.serNo"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"交易状态"}},[a("el-select",{staticClass:"search-input",attrs:{filterable:"",placeholder:"交易状态",clearable:"",size:"small"},on:{change:function(t){return e.doSearchHandel(!0)}},model:{value:e.searchContent.tradeStatus,callback:function(t){e.$set(e.searchContent,"tradeStatus",t)},expression:"searchContent.tradeStatus"}},e._l(e.tradeStatusOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.doSearchHandel(!0)}}},[e._v("搜索")]),e._v(" "),a("el-button",{attrs:{size:"mini",loading:e.exportLoading},on:{click:e.exportData}},[e._v("导出")])],1)],1)],1),e._v(" "),a("div",{staticClass:"table-wraper"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"fixed-height",staticStyle:{width:"100%"},attrs:{data:e.tableData,"empty-text":"没有查询到您想要的数据",size:"small"}},[a("el-table-column",{attrs:{label:"序号",type:"index",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"80px",prop:"cityName",label:"城市",formatter:e.emptyFormater}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"80px",prop:"storeNo",label:"门店编码",formatter:e.emptyFormater}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"80px",prop:"storeType",label:"门店类型",formatter:e.storeTypeFormater}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"100px",prop:"storeName",label:"门店名称",formatter:e.emptyFormater}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"160px",prop:"tradeDate",label:"交易时间",formatter:e.emptyFormater}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"120px",prop:"phone",label:"会员手机号",formatter:e.emptyFormater}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"80px",prop:"tradeOrderType",label:"交易类型",formatter:e.tradeOrderTypeFormater}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"80px",prop:"tradeSource",label:"交易来源",formatter:e.tradeSourceFormater}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"80px",prop:"payAmount",label:"交易金额"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"80px",prop:"tradeStatusStr",label:"交易状态"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"80px",prop:"refundAmount",label:"退款金额"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"100px",prop:"leftStoreAmount",label:"账号余额"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"100px",prop:"payChannelStr",label:"支付渠道"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"160px",prop:"payOrderId",label:"交易流水号",formatter:e.emptyFormater}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"180px",prop:"payThirdOrderId",label:"三方流水号",formatter:e.emptyFormater}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"90px",prop:"serNo",label:"小票号",formatter:e.emptyFormater}})],1),e._v(" "),a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:e.tableData.length>0,expression:"tableData.length>0"}],staticClass:"tc mt20",attrs:{background:"","current-page":e.pageNum,"page-sizes":[20,50,100,150,200],layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.changeSize,"current-change":e.changeCurrent,"update:currentPage":function(t){e.pageNum=t},"update:current-page":function(t){e.pageNum=t}}})],1)])},staticRenderFns:[]};var h=a("VU/8")(d,m,!1,function(e){a("U+b7")},null,null);t.default=h.exports}});
//# sourceMappingURL=74.d53744b1146217eafcd5.js.map