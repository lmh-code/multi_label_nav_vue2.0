webpackJsonp([6],{"95L2":function(e,t,a){"use strict";var s=a("Gu7T"),r=a.n(s),o=a("Dd8w"),i=a.n(o),l=a("BO1k"),n=a.n(l),c=a("mvHQ"),d=a.n(c),u=a("oAV5"),h="/plateform/a/category/getCategoryTree",p="/plateform/a/product/goods/search",m={data:function(){return{isShow:!1,title:"选择商品",loading:!1,pageNum:1,pageSize:10,total:0,searchContent:{queryString:"",isByCityId:!0,goodsIds:[],categoryIdList:[],categoryId:""},tableData:[],checkedList:[],cateDefaultProps:{children:"categoryVoList",label:"categoryName",value:"categoryId"},categoryList:[]}},components:{"goods-select":a("VMhH").a},methods:{setDefault:function(e){var t=this;e&&(this.title=e.title,this.checkedList=JSON.parse(d()(e.checkedList))),this.isShow=!0,this.getCategoryId(),this.doSearchHandel(!0),setTimeout(function(){t.goodsSelectInit()},200)},getCategoryId:function(){var e=this;this.$http.post(h).then(function(t){if(0!==t.code)throw new Error(t.msg);if(t.data&&t.data.length){var a=!0,s=!1,r=void 0;try{for(var o,i=n()(t.data);!(a=(o=i.next()).done);a=!0){var l=o.value;l.categoryVoList&&0===l.categoryVoList.length&&(l.categoryVoList=null)}}catch(e){s=!0,r=e}finally{try{!a&&i.return&&i.return()}finally{if(s)throw r}}e.categoryList=t.data}else e.categoryList=[]}).catch(function(e){console.log("提示(三方平台店内分类):",e.message)})},changeSize:function(e){this.pageSize=e,this.doSearchHandel()},changeCurrent:function(e){this.pageNum=e,this.doSearchHandel()},doSearchHandel:function(e){var t=this,a=this.searchContent.categoryIdList.length-1;this.searchContent.categoryId=this.searchContent.categoryIdList[a],this.loading=!0,!0===e&&(this.pageNum=1),this.$http.post(p,i()({},this.searchContent,{pageNum:this.pageNum,pageSize:this.pageSize})).then(function(e){if(t.loading=!1,0===e.code){if(e.data&&e.data.result&&e.data.result.length){var a=!0,s=!1,r=void 0;try{for(var o,i=n()(e.data.result);!(a=(o=i.next()).done);a=!0){var l=o.value;l.uniqueId=l.id+""+l.goodsNo,l.goodsId=l.id,l.goodsName=l.skuName,l.price="",l.presalePrice="",l.stock="",l.platformCurStock=l.platformCurStock||"",l.memberLimitNum=""}}catch(e){s=!0,r=e}finally{try{!a&&i.return&&i.return()}finally{if(s)throw r}}t.tableData=e.data.result}else t.tableData=[];return t.defauleSelectFun(),void(1==t.pageNum&&(t.total=e.data.total))}throw new Error(e.msg)}).catch(function(e){t.loading=!1,t.$notify.error({title:"提示",message:e.message})})},handleSelect:function(e,t){var a={},s=[];if(u.m(t.uniqueId,"uniqueId",this.checkedList))this.checkedList=u.q("uniqueId",t.uniqueId,this.checkedList);else{s.push(t);var o=[].concat(s,r()(this.checkedList));this.checkedList=o.reduceRight(function(e,t){return!a[t.uniqueId]&&(a[t.uniqueId]=e.push(t)),e},[])}},handleSelectAll:function(e){var t={};if(e.length>0){var a=!0,s=!1,r=void 0;try{for(var o,i=n()(e);!(a=(o=i.next()).done);a=!0){var l=o.value;this.checkedList.push(l)}}catch(e){s=!0,r=e}finally{try{!a&&i.return&&i.return()}finally{if(s)throw r}}this.checkedList=this.checkedList.reduceRight(function(e,a){return!t[a.uniqueId]&&(t[a.uniqueId]=e.push(a)),e},[])}else{var c=[],d=!0,h=!1,p=void 0;try{for(var m,f=n()(this.tableData);!(d=(m=f.next()).done);d=!0){var g=m.value;c.push(g)}}catch(e){h=!0,p=e}finally{try{!d&&f.return&&f.return()}finally{if(h)throw p}}var v=u.i(this.checkedList,c,"uniqueId");this.checkedList=v&&v.length>0?v:[]}},defauleSelectFun:function(){var e=this,t=[],a=!0,s=!1,r=void 0;try{for(var o,i=n()(this.tableData);!(a=(o=i.next()).done);a=!0){var l=o.value,c=!0,d=!1,u=void 0;try{for(var h,p=n()(this.checkedList);!(c=(h=p.next()).done);c=!0){var m=h.value;l.uniqueId===m.uniqueId&&(l.platformCityId=m.platformCityId,l.goodsId=m.goodsId,l.goodsName=m.goodsName,l.presalePrice=m.presalePrice,l.price=m.price,l.stock=m.stock,l.platformCurStock=m.platformCurStock,l.memberLimitNum=m.memberLimitNum,l.disabledVal=m.disabledVal||!1,t.push(l))}}catch(e){d=!0,u=e}finally{try{!c&&p.return&&p.return()}finally{if(d)throw u}}}}catch(e){s=!0,r=e}finally{try{!a&&i.return&&i.return()}finally{if(s)throw r}}t.length>0?(this.$refs.multipleTable.clearSelection(),setTimeout(function(){t.forEach(function(t){e.$refs.multipleTable.toggleRowSelection(t)})},100)):this.$refs.multipleTable.clearSelection()},confirmClose:function(){var e={checkedList:this.checkedList};this.$emit("confirmChooseGoods",e),this.isShow=!1},doCategorysChangeHandel:function(){this.goodsSelectInit(),this.doSearchHandel(!0)},goodsSelectInit:function(){if(this.$refs.GoodsSelect){var e={queryString:this.searchContent.queryString,categoryIdList:this.searchContent.categoryIdList,goodsIds:this.searchContent.goodsIds};this.$refs.GoodsSelect.setDefaultMesg(e)}},DoSelectGoodsHandel:function(e){var t=e.checkedList,a=e.queryString,s=[],r=!0,o=!1,i=void 0;try{for(var l,c=n()(t);!(r=(l=c.next()).done);r=!0){var d=l.value;s.push(d.goodsId)}}catch(e){o=!0,i=e}finally{try{!r&&c.return&&c.return()}finally{if(o)throw i}}this.searchContent.goodsIds=s,this.searchContent.queryString=a,this.doSearchHandel(!0)},selectable:function(e,t){return!0!==e.disabledVal}}},f={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:e.title,visible:e.isShow,width:"720px"},on:{"update:visible":function(t){e.isShow=t}}},[a("div",{staticClass:"search-form-wraper c-g-sfw"},[a("el-form",{attrs:{model:e.searchContent,"label-position":"top"}},[a("el-form-item",[a("el-cascader",{staticClass:"search-input",attrs:{placeholder:"请选择分类",options:e.categoryList,"change-on-select":"",size:"small",clearable:"",filterable:"",props:e.cateDefaultProps},on:{change:e.doCategorysChangeHandel},model:{value:e.searchContent.categoryIdList,callback:function(t){e.$set(e.searchContent,"categoryIdList",t)},expression:"searchContent.categoryIdList"}})],1),e._v(" "),a("el-form-item",[a("goods-select",{ref:"GoodsSelect",on:{DoSelectGoodsHandel:e.DoSelectGoodsHandel}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.doSearchHandel(!0)}}},[e._v("搜索")])],1)],1)],1),e._v(" "),a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticClass:"fixed-height",staticStyle:{width:"100%"},attrs:{data:e.tableData,"empty-text":"没有查询到您想要的数据",height:"300",size:"small"},on:{select:e.handleSelect,"select-all":e.handleSelectAll}},[a("el-table-column",{attrs:{selectable:e.selectable,type:"selection",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"226px",label:"商品信息"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"ll-p-m-w"},[a("div",{staticClass:"ll-img-w"},[t.row.imgUrl&&""!=t.row.imgUrl?a("img",{attrs:{src:t.row.imgUrl,alt:"",onerror:"onerror=null;src='/shop/static/img_error.png'"}}):a("img",{attrs:{src:"/shop/static/img_error.png",alt:""}})]),e._v(" "),a("div",{staticClass:"ll-p-m-c-r"},[a("div",[e._v(e._s(t.row.skuName||"--"))]),e._v(" "),a("div",{staticClass:"ll-erp-p-no"},[e._v("SKU编码："+e._s(t.row.goodsNo))])])])]}}])}),e._v(" "),a("el-table-column",{attrs:{"min-width":"120px",prop:"spec",label:"规格"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"120px",prop:"categoryName",label:"分类"}})],1),e._v(" "),a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:e.tableData.length>0,expression:"tableData.length>0"}],staticClass:"tc mt20",attrs:{background:"","current-page":e.pageNum,"page-sizes":[10,50,100,150,200],layout:"total, sizes, prev, pager, next, jumper","pager-count":5,total:e.total},on:{"size-change":e.changeSize,"current-change":e.changeCurrent,"update:currentPage":function(t){e.pageNum=t},"update:current-page":function(t){e.pageNum=t}}})],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"mini"},on:{click:function(t){e.isShow=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini",disabled:0===e.checkedList.length},on:{click:e.confirmClose}},[e._v("导 入")])],1)])],1)},staticRenderFns:[]};var g=a("VU/8")(m,f,!1,function(e){a("VgSN")},null,null);t.a=g.exports},VgSN:function(e,t){},ZidK:function(e,t){},"jhx/":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("mvHQ"),r=a.n(s),o=a("BO1k"),i=a.n(o),l=a("Dd8w"),n=a.n(l),c=a("bOdI"),d=a.n(c),u=(a("ssT3"),a("oAV5"),a("95L2")),h=a("sA/b"),p="/plateform/a/mall/saleActivity/saveActivity",m={data:function(){var e;return{isDisabled:!1,addParamMesg:(e={platformId:5,activityName:""},d()(e,"activityName",""),d()(e,"startDate",""),d()(e,"endDate",""),d()(e,"pickUpStartDate",""),d()(e,"pickUpEndDate",""),d()(e,"goodsReqList",[]),d()(e,"storeNoList",[]),e),pickerOptions:{disabledDate:function(e){return e.getTime()<Date.now()-864e5}},checkedList:[],activityStoresCheckedList:[]}},components:{"choose-goods":u.a,"choose-store":h.a},mounted:function(){},methods:{doSaveHandel:function(){var e=this,t=/^[1-9]*[1-9][0-9]*$/,a=/((^[1-9]\d*)|^0)(\.\d{0,2}){0,1}$/;if(this.addParamMesg.activityName)if(this.addParamMesg.activityName.length>20)this.$message("预售周期名称,限制20个字");else if(this.addParamMesg.startDate)if(this.addParamMesg.endDate){var s=Date.parse(new Date(this.addParamMesg.startDate)),r=Date.parse(new Date(this.addParamMesg.endDate));if(r<=s)this.$message("起止时间结束日期不能早于或等于开始日期");else if(this.addParamMesg.pickUpStartDate){var o=Date.parse(new Date(this.addParamMesg.pickUpStartDate));if(o<=r)this.$message("提货日期不能早于起止时间");else if(this.addParamMesg.pickUpEndDate)if(Date.parse(new Date(this.addParamMesg.pickUpEndDate))<o)this.$message("提货日期结束日期不能早于开始日期");else{var l=this.activityStoresCheckedList.map(function(e){return e.erpStoreNo});if(this.addParamMesg.storeNoList=l,0!==this.addParamMesg.storeNoList.length){var c=[],d=!0,u=!1,h=void 0;try{for(var m,f=i()(this.checkedList);!(d=(m=f.next()).done);d=!0){var g=m.value;if(""===g.goodsName)return void this.$message("请输入("+g.goodsName+")商品名称");if(!g.price||0==g.price)return void this.$message("请输入("+g.goodsName+")的原价");if(!a.test(g.price))return void this.$message("原价是大于0，小数保留小数点后2位");if(!g.presalePrice||0==g.presalePrice)return void this.$message("请输入("+g.goodsName+")的预售价");if(!a.test(g.presalePrice))return void this.$message("预售价是大于0，小数保留小数点后2位");if(parseFloat(g.presalePrice)>parseFloat(g.price))return void this.$message("("+g.goodsName+")的原价必须大于预售价");if(0!=g.platformCurStock&&g.platformCurStock){if(!t.test(g.platformCurStock))return void this.$message("门店限售库存格式不正确");if(g.platformCurStock<0)return void this.$message("区域限售库存不能小于0");if(g.platformCurStock>9999)return void this.$message("区域限售库存不能大于9999")}if(0!=g.stock&&g.stock){if(!t.test(g.stock))return void this.$message("门店限售库存格式不正确");if(g.stock<0)return void this.$message("门店限售库存不能小于0")}if(0!=g.memberLimitNum&&g.memberLimitNum){if(!t.test(g.memberLimitNum))return void this.$message("输入限购数量格式不正确");if(g.memberLimitNum<0)return void this.$message("限购数量不能小于0")}var v={goodsId:g.goodsId,goodsName:g.goodsName,presalePrice:g.presalePrice,price:g.price,stock:g.stock,platformCurStock:g.platformCurStock,memberLimitNum:g.memberLimitNum};c.push(v)}}catch(e){u=!0,h=e}finally{try{!d&&f.return&&f.return()}finally{if(u)throw h}}this.addParamMesg.goodsReqList=c,0!==this.addParamMesg.goodsReqList.length?(this.isDisabled=!0,this.$http.post(p,n()({},this.addParamMesg)).then(function(t){if(setTimeout(function(){e.isDisabled=!1},800),0===t.code)return e.$message.success("保存成功"),void e.$router.push("/long_pgm");throw new Error(t.msg)}).catch(function(t){e.isDisabled=!1,e.$notify.error({title:"提示",message:t.message})})):this.$message("请先设置预售商品")}else this.$message("请选择参与门店")}else this.$message("请输入提货日期的结束日期")}else this.$message("请输入提货日期的开始日期")}else this.$message("请输入起止时间的结束日期");else this.$message("请输入起止时间的开始日期");else this.$message("请输入预售周期名称")},doCancelHandel:function(){var e=this;this.$confirm("确定取消吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$router.push("/long_pgm")}).catch(function(){})},goAddGoodsDialog:function(){if(this.$refs.chooseGoods){var e={title:"选择商品",checkedList:this.checkedList};this.$refs.chooseGoods.setDefault(e)}},confirmChooseGoods:function(e){e&&(this.checkedList=e.checkedList)},deleteItem:function(e){var t=e.uniqueId,a=this.checkedList.filter(function(e){return e.uniqueId!=t});this.checkedList=JSON.parse(r()(a))},platformCurStockHeader:function(){var e=this.$createElement;return e("el-popover",{attrs:{placement:"top-start",width:"260",trigger:"hover"}},[e("div",[e("p",["区域限售库存，即所有门店共享的总预售库存；"]),e("p",["门店限售即每个门店的预售库存，可在门店预售商品中调整门店库存；"]),e("p",["每个商品至少要设置一种限售库存方式，最大可设置9999；"]),e("p",["如果既设了区域限售，又设了门店限售，则先校验区域库存，再校验门店库存；"])]),e("span",{slot:"reference"},["区域限售库存",e("i",{class:"el-icon-question"})])])},chooseStoreOpen:function(){var e={title:"选择门店",checkedList:this.activityStoresCheckedList};this.$refs.chooseStore.setDefault(e)},deleteStoreItem:function(e){var t=e.erpStoreNo;this.activityStoresCheckedList=this.activityStoresCheckedList.filter(function(e){return e.erpStoreNo!==t})},confirmChooseStore:function(e){var t=[];t=e.checkedList&&e.checkedList.length?e.checkedList:[],this.activityStoresCheckedList=t}}},f={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"add-form-wraper"},[a("el-form",{ref:"form",attrs:{model:e.addParamMesg,"label-width":"160px"}},[a("el-form-item",{attrs:{label:"预售周期名称",required:""}},[a("el-input",{staticClass:"add-input",attrs:{size:"small",placeholder:"请输入预售周期名称"},model:{value:e.addParamMesg.activityName,callback:function(t){e.$set(e.addParamMesg,"activityName",t)},expression:"addParamMesg.activityName"}}),e._v(" "),a("span",[e._v("活动名称，限制20个字")])],1),e._v(" "),a("el-form-item",{attrs:{label:"开始时间",required:""}},[a("el-date-picker",{staticClass:"add-input",attrs:{size:"small",type:"datetime",format:"yyyy.MM.dd HH:mm:ss","value-format":"yyyy.MM.dd HH:mm:ss","picker-options":e.pickerOptions,placeholder:"请输入开始时间"},model:{value:e.addParamMesg.startDate,callback:function(t){e.$set(e.addParamMesg,"startDate",t)},expression:"addParamMesg.startDate"}}),e._v(" "),a("span",[e._v("长周期预售不能2期同时进行，多个长周期预售，起止时间不能重合，时间添加保存后不可修改")])],1),e._v(" "),a("el-form-item",{attrs:{label:"结束时间",required:""}},[a("el-date-picker",{staticClass:"add-input",attrs:{size:"small",type:"datetime",format:"yyyy.MM.dd HH:mm:ss","value-format":"yyyy.MM.dd HH:mm:ss","picker-options":e.pickerOptions,placeholder:"请输入结束时间"},model:{value:e.addParamMesg.endDate,callback:function(t){e.$set(e.addParamMesg,"endDate",t)},expression:"addParamMesg.endDate"}}),e._v(" "),a("span",[e._v("长周期预售不能2期同时进行，多个长周期预售，起止时间不能重合，时间添加保存后不可修改")])],1),e._v(" "),a("el-form-item",{attrs:{label:"提货日期",required:""}},[a("el-date-picker",{staticClass:"add-input-inline",attrs:{size:"small",type:"date",format:"yyyy.MM.dd","value-format":"yyyy.MM.dd","picker-options":e.pickerOptions,placeholder:"开始日期"},model:{value:e.addParamMesg.pickUpStartDate,callback:function(t){e.$set(e.addParamMesg,"pickUpStartDate",t)},expression:"addParamMesg.pickUpStartDate"}}),e._v("\n      -\n      "),a("el-date-picker",{staticClass:"add-input-inline",attrs:{size:"small",type:"date",format:"yyyy.MM.dd","value-format":"yyyy.MM.dd","picker-options":e.pickerOptions,placeholder:"结束日期"},model:{value:e.addParamMesg.pickUpEndDate,callback:function(t){e.$set(e.addParamMesg,"pickUpEndDate",t)},expression:"addParamMesg.pickUpEndDate"}}),e._v(" "),a("span",[e._v("提货日期添加保存后不可修改")])],1),e._v(" "),a("el-form-item",{attrs:{label:"参与门店",required:""}},[a("el-button",{attrs:{size:"small",icon:"el-icon-plus"},on:{click:e.chooseStoreOpen}},[e._v("选择门店")]),e._v(" "),e.activityStoresCheckedList.length>0?a("div",{staticClass:"store-check-wraper"},e._l(e.activityStoresCheckedList,function(t,s){return a("div",{key:s,staticClass:"check-store-item"},[e._v("\n          "+e._s(t.erpStoreNo)+"_"+e._s(t.erpStoreName)+"("+e._s(t.saleTypeName)+")\n          "),a("span",{staticClass:"del-store-icon-w",on:{click:function(a){return e.deleteStoreItem(t)}}},[a("i",{staticClass:"el-icon-error"})])])}),0):e._e()],1),e._v(" "),a("el-form-item",{attrs:{label:"设置预售商品",required:""}},[a("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-plus"},on:{click:e.goAddGoodsDialog}},[e._v("添加商品")]),e._v(" "),a("el-table",{staticClass:"fixed-height",staticStyle:{width:"100%"},attrs:{data:e.checkedList,"empty-text":"暂无选中任何商品",size:"small"}},[a("el-table-column",{attrs:{width:"226px",label:"商品信息"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"ll-p-m-w"},[a("div",{staticClass:"ll-img-w"},[t.row.imgUrl&&""!=t.row.imgUrl?a("img",{attrs:{src:t.row.imgUrl,alt:"",onerror:"onerror=null;src='/shop/static/img_error.png'"}}):a("img",{attrs:{src:"/shop/static/img_error.png",alt:""}})]),e._v(" "),a("div",{staticClass:"ll-p-m-c-r"},[a("div",[a("el-input",{attrs:{size:"small",placeholder:"输入商品名称"},model:{value:t.row.goodsName,callback:function(a){e.$set(t.row,"goodsName",a)},expression:"scope.row.goodsName"}})],1),e._v(" "),a("div",{staticClass:"ll-erp-p-no"},[e._v("SKU编码："+e._s(t.row.goodsNo||"--"))])])])]}}])}),e._v(" "),a("el-table-column",{attrs:{width:"120px",prop:"spec",label:"规格"}}),e._v(" "),a("el-table-column",{attrs:{width:"130px",label:"原价(必填)"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-input",{attrs:{size:"small",placeholder:"输入原价"},model:{value:t.row.price,callback:function(a){e.$set(t.row,"price",a)},expression:"scope.row.price"}})],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{width:"130px",label:"预售价(必填)"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-input",{attrs:{size:"small",placeholder:"输入预售价"},model:{value:t.row.presalePrice,callback:function(a){e.$set(t.row,"presalePrice",a)},expression:"scope.row.presalePrice"}})],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{"min-width":"130px","render-header":e.platformCurStockHeader},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-input",{attrs:{size:"small",placeholder:"区域限售库存"},model:{value:t.row.platformCurStock,callback:function(a){e.$set(t.row,"platformCurStock",a)},expression:"scope.row.platformCurStock"}})],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{width:"130px",label:"门店限售库存"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-input",{attrs:{size:"small",placeholder:"门店限售库存"},model:{value:t.row.stock,callback:function(a){e.$set(t.row,"stock",a)},expression:"scope.row.stock"}})],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{width:"160px",prop:"marketPrice",label:"每人限购(为空时不限)"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-input",{attrs:{size:"small",placeholder:"输入每人限购"},model:{value:t.row.memberLimitNum,callback:function(a){e.$set(t.row,"memberLimitNum",a)},expression:"scope.row.memberLimitNum"}})],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"操作",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-delete"},on:{click:function(a){return e.deleteItem(t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("p",[a("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v("长周期未开始时可以编辑商品，进行中后不可以再编辑商品；")])],1),e._v(" "),a("hr",{staticClass:"s-slip-tb"}),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small",disabled:e.isDisabled},on:{click:e.doSaveHandel}},[e._v("保存")]),e._v(" "),a("el-button",{attrs:{size:"small"},on:{click:e.doCancelHandel}},[e._v("取消")])],1)],1),e._v(" "),a("choose-goods",{ref:"chooseGoods",on:{confirmChooseGoods:e.confirmChooseGoods}}),e._v(" "),a("choose-store",{ref:"chooseStore",on:{confirmChooseStore:e.confirmChooseStore}})],1)},staticRenderFns:[]};var g=a("VU/8")(m,f,!1,function(e){a("ZidK")},null,null);t.default=g.exports},"sA/b":function(e,t,a){"use strict";var s=a("BO1k"),r=a.n(s),o=a("Dd8w"),i=a.n(o),l=a("Gu7T"),n=a.n(l),c=a("mvHQ"),d=a.n(c),u=a("oAV5"),h="/plateform/a/baseCommon/store/selectPlatfromStore",p="/backstage/storeGroup/storeGroupTypeList",m={data:function(){return{isShow:!1,title:"",loading:!1,searchContent:{searchValue:"",saleType:"",platform:5,storeGroupTypeNo:"",storeGroupNo:"",storeGroupTypeNoList:[]},saleTypeOptions:[{label:"直营店",value:1},{label:"加盟店",value:2},{label:"分销店",value:3},{label:"自提店",value:4}],storeGroupTypeNoOptions:[],defaultProps:{children:"storeGroupList",label:"labelName",value:"valueName"},tableData:[],checkedList:[],otherCheckedList:[],groupIndex:0}},methods:{setDefault:function(e){e&&(this.searchContent={searchValue:"",saleType:"",platform:5,storeGroupTypeNo:"",storeGroupNo:"",storeGroupTypeNoList:[]},this.title=e.title,this.checkedList=JSON.parse(d()(e.checkedList)),e.otherCheckedList&&e.otherCheckedList.length&&(this.otherCheckedList=[].concat(n()(e.otherCheckedList))),this.groupIndex=e.groupIndex||0),this.isShow=!0,this.getStoreGroupType(),this.doSearchHandel(!0)},storeGroupTypeNoChange:function(e){this.searchContent.storeGroupTypeNo=e[0],this.searchContent.storeGroupNo=e[1],this.doSearchHandel(!0)},getStoreGroupType:function(){var e=this;this.$http.get(p).then(function(t){if(0===t.code){var a=t.data&&t.data.length?t.data:[];return e.modifyStoreGroupeTree(a),void(e.storeGroupTypeNoOptions=a)}throw new Error(t.msg)}).catch(function(e){console.log("【提示】获取店组信息失败："+e.message)})},modifyStoreGroupeTree:function(e,t){var a=this;e.forEach(function(e){e.storeGroupList&&e.storeGroupTypeNo?(e.valueName=e.storeGroupTypeNo,e.labelName=e.storeGroupTypeName?e.storeGroupTypeNo+"."+e.storeGroupTypeName:"",e.storeGroupList.length&&a.modifyStoreGroupeTree(e.storeGroupList,e.storeGroupTypeNo)):e.storeGroupNo&&(e.valueName=e.storeGroupNo,e.labelName=e.storeGroupName?e.storeGroupNo+"."+e.storeGroupName:"",e.childrenList&&e.childrenList.length&&(e.storeGroupList=JSON.parse(d()(e.childrenList)),a.modifyStoreGroupeTree(e.storeGroupList)))})},doSearchHandel:function(){var e=this;this.loading=!0,this.$http.post(h,i()({},this.searchContent)).then(function(t){if(e.loading=!1,0===t.code){var a=t.data&&t.data.length?t.data:[];return e.tableData=u.i(a,e.otherCheckedList,"erpStoreNo"),void e.defaultSelectFun()}throw new Error(t.msg)}).catch(function(t){e.loading=!1,e.$notify.error({title:"提示",message:t.message})})},handleSelect:function(e,t){var a={},s=[];if(u.m(t.erpStoreNo,"erpStoreNo",this.checkedList))this.checkedList=u.q("erpStoreNo",t.erpStoreNo,this.checkedList);else{s.push(t);var r=[].concat(s,n()(this.checkedList));this.checkedList=r.reduceRight(function(e,t){return!a[t.erpStoreNo]&&(a[t.erpStoreNo]=e.push(t)),e},[])}},handleSelectAll:function(e){var t={};if(e.length>0){var a=!0,s=!1,o=void 0;try{for(var i,l=r()(e);!(a=(i=l.next()).done);a=!0){var n=i.value;this.checkedList.push(n)}}catch(e){s=!0,o=e}finally{try{!a&&l.return&&l.return()}finally{if(s)throw o}}this.checkedList=this.checkedList.reduceRight(function(e,a){return!t[a.erpStoreNo]&&(t[a.erpStoreNo]=e.push(a)),e},[])}else{var c=[],d=!0,h=!1,p=void 0;try{for(var m,f=r()(this.tableData);!(d=(m=f.next()).done);d=!0){var g=m.value;c.push(g)}}catch(e){h=!0,p=e}finally{try{!d&&f.return&&f.return()}finally{if(h)throw p}}var v=u.i(this.checkedList,c,"erpStoreNo");this.checkedList=v&&v.length>0?v:[]}},defaultSelectFun:function(){var e=this,t=[],a=!0,s=!1,o=void 0;try{for(var i,l=r()(this.tableData);!(a=(i=l.next()).done);a=!0){var n=i.value,c=!0,d=!1,u=void 0;try{for(var h,p=r()(this.checkedList);!(c=(h=p.next()).done);c=!0){var m=h.value;n.erpStoreNo===m.erpStoreNo&&t.push(n)}}catch(e){d=!0,u=e}finally{try{!c&&p.return&&p.return()}finally{if(d)throw u}}}}catch(e){s=!0,o=e}finally{try{!a&&l.return&&l.return()}finally{if(s)throw o}}t.length>0?(this.$refs.multipleTable.clearSelection(),setTimeout(function(){t.forEach(function(t){e.$refs.multipleTable.toggleRowSelection(t)})},100)):this.$refs.multipleTable.clearSelection()},confirmClose:function(){var e={checkedList:this.checkedList,groupIndex:this.groupIndex};this.$emit("confirmChooseStore",e),this.isShow=!1},saleTypeFormatter:function(e,t,a){return this.saleTypeOptions.filter(function(e){return e.value===a})[0].label}}},f={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:e.title,visible:e.isShow,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"620px"},on:{"update:visible":function(t){e.isShow=t}}},[a("div",{staticClass:"search-form-wraper c-g-sfw"},[a("el-form",{attrs:{model:e.searchContent,"label-position":"top"}},[a("el-form-item",[a("el-input",{staticClass:"add-input-inline",attrs:{placeholder:"门店编号/名称",clearable:"",size:"small"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.doSearchHandel(t)}},model:{value:e.searchContent.searchValue,callback:function(t){e.$set(e.searchContent,"searchValue",t)},expression:"searchContent.searchValue"}})],1),e._v(" "),a("el-form-item",[a("el-select",{staticClass:"search-input-small-width",attrs:{size:"small",clearable:"",placeholder:"门店类型"},on:{change:e.doSearchHandel},model:{value:e.searchContent.saleType,callback:function(t){e.$set(e.searchContent,"saleType",t)},expression:"searchContent.saleType"}},e._l(e.saleTypeOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",[a("el-cascader",{ref:"cascaderCategory",staticClass:"add-input-inline",attrs:{placeholder:"店组类型",options:e.storeGroupTypeNoOptions,size:"small",filterable:"",clearable:"",props:e.defaultProps},on:{change:e.storeGroupTypeNoChange},model:{value:e.searchContent.storeGroupTypeNoList,callback:function(t){e.$set(e.searchContent,"storeGroupTypeNoList",t)},expression:"searchContent.storeGroupTypeNoList"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.doSearchHandel}},[e._v("搜索")])],1)],1)],1),e._v(" "),a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticClass:"fixed-height",staticStyle:{width:"100%"},attrs:{data:e.tableData,"empty-text":"没有查询到您想要的数据",height:"270",size:"small"},on:{select:e.handleSelect,"select-all":e.handleSelectAll}},[a("el-table-column",{attrs:{type:"selection",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"170",label:"门店编码/名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v("\n              "+e._s(t.row.erpStoreNo)+"_"+e._s(t.row.erpStoreName)+"\n            ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{"min-width":"100",formatter:e.saleTypeFormatter,prop:"saleType",label:"门店类型"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"mini"},on:{click:function(t){e.isShow=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini",disabled:0===e.checkedList.length},on:{click:e.confirmClose}},[e._v("确 定")])],1)])],1)},staticRenderFns:[]};var g=a("VU/8")(m,f,!1,function(e){a("t4x1")},null,null);t.a=g.exports},t4x1:function(e,t){}});
//# sourceMappingURL=6.24b206678f7f05dc6b35.js.map