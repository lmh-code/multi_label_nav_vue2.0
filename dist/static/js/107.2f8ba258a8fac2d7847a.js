webpackJsonp([107],{lzt3:function(e,r){},pX2U:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var o=t("Gu7T"),n=t.n(o),a=t("8uth"),l={name:"tableColumn",props:{coloumnHeader:{type:Object,required:!1},tableColumnList:{type:Array,required:!1}}},d={render:function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("el-table-column",{attrs:{label:e.coloumnHeader.label,prop:e.coloumnHeader.property,align:"center"}},[e._l(e.coloumnHeader.children,function(r,o){return[r.children&&r.children.length?t("tableColumn",{key:o,attrs:{"coloumn-header":r}}):t("el-table-column",{key:o,attrs:{label:r.label,"min-width":r.width,align:"center"},scopedSlots:e._u([{key:"default",fn:function(o){return[t("div",["input"===r.showType?t("div",[t("el-input",{attrs:{placeholder:"输入内容",size:"small"},model:{value:o.row[r.property],callback:function(t){e.$set(o.row,r.property,t)},expression:"scope.row[item.property]"}})],1):"select"===r.showType?t("div",[t("el-select",{attrs:{placeholder:"请选择",size:"small"},model:{value:o.row[r.defaultVal],callback:function(t){e.$set(o.row,r.defaultVal,t)},expression:"scope.row[item.defaultVal]"}},e._l(o.row[r.property],function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1):t("div",["marketPrice"===r.property?t("div",e._l(o.row.marketMsg,function(o){return t("div",{key:o.marketNo},[r.marketNo===o.marketNo?t("span",[e._v(e._s(o[r.property]))]):e._e()])}),0):"vendorCurrentPrice"===r.property||"vendorReportPrice"===r.property||"vendorReportGoods"===r.property?t("div",e._l(o.row.vendorMsg,function(o){return t("div",{key:o.vendorNo},[r.vendorNo===o.vendorNo?t("span",[e._v("\n                  "+e._s(o[r.property])+"\n                ")]):e._e()])}),0):t("div",[e._v("\n              "+e._s(o.row[r.property])+"\n            ")])])])]}}],null,!0)})]})],2)},staticRenderFns:[]},i=t("VU/8")(l,d,!1,null,null,null).exports,s=t("oAV5"),p={data:function(){return{tHeaderList:[{label:"商品编码",property:"goodsNo",width:120},{label:"商品名称",property:"goodsName",width:130},{label:"规格",property:"spec",width:120},{label:"单位",property:"unit",width:120},{label:"原价",property:"price",width:120},{label:"输入可订货价",property:"currentPrice",showType:"input",width:130},{label:"选择供应商",property:"vendors",defaultVal:"defaultVendorNo",showType:"select",width:150},{label:"转换比",property:"radio",children:[{label:"市场转换比",property:"radio1",width:120},{label:"供应商转换比",property:"radio2",width:120}]}],tHeaderMarketList:[{marketNo:"600001",marketName:"市场1",label:"市场1",property:"marketPrice",width:120},{marketNo:"600002",marketName:"市场2",label:"市场2",property:"marketPrice",width:120},{marketNo:"600003",marketName:"市场3",label:"市场3",property:"marketPrice",width:120}],tHeaderVendorList:[{vendorNo:"80001",vendorName:"供应商1",label:"供应商1",property:"vendorNo",children:[{vendorNo:"80001",label:"当前进价",property:"vendorCurrentPrice",width:120},{vendorNo:"80001",label:"本次报价",property:"vendorReportPrice",width:120},{vendorNo:"80001",label:"报货量",property:"vendorReportGoods",width:120}]},{vendorNo:"80002",vendorName:"供应商2",label:"供应商2",property:"vendorNo",children:[{vendorNo:"80002",label:"当前进价",property:"vendorCurrentPrice",width:120},{vendorNo:"80002",label:"本次报价",property:"vendorReportPrice",width:120},{vendorNo:"80002",label:"报货量",property:"vendorReportGoods",width:120}]}],tableData:[{goodsNo:"100001",goodsName:"测试商品100001",spec:"1kg/份",unit:"kg",price:"12.5",currentPrice:"",defaultVendorNo:"50001",vendors:[{value:"50001",label:"供应商名称50001"},{value:"50002",label:"供应商名称50002"},{value:"50003",label:"供应商名称50003"}],radio:"10%",radio1:"5%",radio2:"5%",marketMsg:[{marketNo:"600001",marketName:"市场1",marketPrice:"9"}],vendorMsg:[{vendorNo:"80001",vendorName:"供应商1",vendorCurrentPrice:"55",vendorReportPrice:"23",vendorReportGoods:886}]},{goodsNo:"100002",goodsName:"测试商品100002",spec:"2kg/份",unit:"kg",price:"25",currentPrice:"",defaultVendorNo:"50002",vendors:[{value:"50001",label:"供应商名称50001"},{value:"50002",label:"供应商名称50002"},{value:"50003",label:"供应商名称50003"}],radio:"10%",radio1:"5%",radio2:"5%",marketMsg:[{marketNo:"600002",marketName:"市场2",marketPrice:"12"},{marketNo:"600003",marketName:"市场3",marketPrice:"10"}],vendorMsg:[{vendorNo:"80001",vendorName:"供应商1",vendorCurrentPrice:"11",vendorReportPrice:"9",vendorReportGoods:996},{vendorNo:"80002",vendorName:"供应商2",vendorCurrentPrice:"10",vendorReportPrice:"10.5",vendorReportGoods:1e4}]}]}},components:{"table-column":i},created:function(){},mounted:function(){this.doSearchHandel()},methods:{doSearchHandel:function(){var e=[].concat(n()(this.tHeaderList),n()(this.tHeaderMarketList),n()(this.tHeaderVendorList));this.tHeaderList=e},notificationMsg:function(){var e=this;this.$alert("<div><p>活动保存成功</p><p style='color: red;'>有商品在门店线上不可售</p></div>","温馨提示",{dangerouslyUseHTMLString:!0,showCancelButton:!0,cancelButtonText:"下载明细",showConfirmButton:!0,confirmButtonText:"关闭"}).then(function(){e.$message({type:"success",message:"你点击了关闭按钮!"})}).catch(function(){e.$message({type:"info",message:"你点击了下载明细按钮"})})},doExportDataHandel:function(){var e=this.tHeaderMarketList.map(function(e){return e.marketName}),r=[];this.tHeaderVendorList.map(function(e){return e.vendorName}).map(function(e){return[e,"",""]}).forEach(function(e){r=[].concat(n()(r),n()(e))});var t=[[].concat(n()(["商品名称","商品编码","规格","单位","原价","可订货价","供应商","转换比"]),n()(e),n()(r))];console.log("newMultiHeader:",t);var o=["","","","","","","",""];this.tHeaderMarketList.forEach(function(e){o.push("")}),this.tHeaderVendorList.forEach(function(e){o.push("当前进价"),o.push("本次报价"),o.push("报货量")}),console.log("tHeader:",o);var l=["goodsName","goodsNo","spec","unit","price","currentPrice","defaultVendorNo","radio"];this.tHeaderMarketList.forEach(function(e,r){l.push("marketPrice"+e.marketNo)}),this.tHeaderVendorList.forEach(function(e,r){l.push("vendorCurrentPrice"+e.vendorNo),l.push("vendorReportPrice"+e.vendorNo),l.push("vendorReportGoods"+e.vendorNo)}),console.log("tFilter:",l);var d=["A1:A2","B1:B2","C1:C2","D1:D2","E1:E2","F1:F2","G1:G2","H1:H2"];this.tHeaderMarketList.forEach(function(e,r){var t=s.k(8+r+1);d.push(t+"1:"+t+"2")});var i=8+this.tHeaderMarketList.length+1;this.tHeaderVendorList.forEach(function(e,r){var t=s.k(i),o=i+2,n=s.k(o);i=o+1,d.push(t+"1:"+n+"1")}),console.log("merges:",d),this.tableData.forEach(function(e,r){e.marketMsg&&e.marketMsg.length&&e.marketMsg.forEach(function(r){e["marketPrice"+r.marketNo]=r.marketPrice}),e.vendorMsg&&e.vendorMsg.length&&e.vendorMsg.forEach(function(r){e["vendorCurrentPrice"+r.vendorNo]=r.vendorCurrentPrice,e["vendorReportPrice"+r.vendorNo]=r.vendorReportPrice,e["vendorReportGoods"+r.vendorNo]=r.vendorReportGoods})}),console.log("this.tableData:",this.tableData),a.a.ExportJsonToExcel({multiHeader:t,merges:d,header:o,filterVal:l,data:this.tableData,filename:Date.parse(new Date)+"_测试excel导出合并单元格"})}}},c={render:function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",[t("el-button",{attrs:{size:"mini"},on:{click:function(r){return e.doExportDataHandel(!1)}}},[e._v("导出")]),e._v(" "),t("el-table",{attrs:{data:e.tableData,size:"small",border:""}},[e._l(e.tHeaderList,function(r,o){return[r.children&&r.children.length?t("table-column",{key:o,attrs:{"coloumn-header":r}}):t("el-table-column",{key:o,attrs:{label:r.label,"min-width":r.width,align:"center"},scopedSlots:e._u([{key:"default",fn:function(o){return[t("div",["input"===r.showType?t("div",[t("el-input",{attrs:{placeholder:"输入内容",size:"small"},model:{value:o.row[r.property],callback:function(t){e.$set(o.row,r.property,t)},expression:"scope.row[item.property]"}})],1):"select"===r.showType?t("div",[t("el-select",{attrs:{placeholder:"请选择",size:"small"},model:{value:o.row[r.defaultVal],callback:function(t){e.$set(o.row,r.defaultVal,t)},expression:"scope.row[item.defaultVal]"}},e._l(o.row[r.property],function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1):t("div",["marketPrice"===r.property?t("div",e._l(o.row.marketMsg,function(o){return t("div",{key:o.marketNo},[r.marketNo===o.marketNo?t("span",[e._v(e._s(o[r.property]))]):e._e()])}),0):"vendorCurrentPrice"===r.property||"vendorReportPrice"===r.property||"vendorReportGoods"===r.property?t("div",e._l(o.row.vendorMsg,function(o){return t("div",{key:o.vendorNo},[r.vendorNo===o.vendorNo?t("span",[e._v("\n                        "+e._s(o[r.property])+"\n                      ")]):e._e()])}),0):t("div",[e._v("\n                    "+e._s(o.row[r.property])+"\n                  ")])])])]}}],null,!0)})]})],2)],1)},staticRenderFns:[]};var u=t("VU/8")(p,c,!1,function(e){t("lzt3")},null,null);r.default=u.exports}});
//# sourceMappingURL=107.2f8ba258a8fac2d7847a.js.map