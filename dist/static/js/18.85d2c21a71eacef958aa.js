webpackJsonp([18],{JSI0:function(e,t){},cW7o:function(e,t){},gU83:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("BO1k"),r=a.n(n),s=a("Dd8w"),l=a.n(s),i="/member/erp/mermberProm/promList",o="/member/erp/memberProm/updateStatus",c={data:function(){return{loading:!1,pageNum:1,pageSize:20,total:0,searchContent:{phone:"",status:""},tableData:[],memeberMesg:{city:"-",vestStoreNo:"-",name:"-",phone:"-"},statusOptions:[{label:"全部",value:""},{label:"已失效",value:-1},{label:"未使用",value:0},{label:"已过期",value:1},{label:"已使用",value:2}]}},methods:{changeSize:function(e){this.pageSize=e,this.doSearchHandel()},changeCurrent:function(e){this.pageNum=e,this.doSearchHandel()},doSearchHandel:function(e){var t=this;this.searchContent.phone?(this.loading=!0,!0===e&&(this.pageNum=1),this.$http.post(i,l()({},this.searchContent,{pageNum:this.pageNum,pageSize:this.pageSize})).then(function(e){if(t.loading=!1,0!==e.code)throw new Error(e.msg);if(e.data)if(t.memeberMesg.phone=e.data.phone||"-",t.memeberMesg.vestStoreNo=e.data.vestStoreNo||"-",t.memeberMesg.name=e.data.name||"-",t.memeberMesg.city=e.data.city||"-",e.data.pageVo&&e.data.pageVo.result&&e.data.pageVo.result.length){var a=!0,n=!1,s=void 0;try{for(var l,i=r()(e.data.pageVo.result);!(a=(l=i.next()).done);a=!0){var o=l.value;o.redirectUrl="/discount_coupon/showcp/"+o.promCreateId}}catch(e){n=!0,s=e}finally{try{!a&&i.return&&i.return()}finally{if(n)throw s}}t.tableData=e.data.pageVo.result,t.total=e.data.pageVo.total}else t.tableData=[],t.total=0;else t.memeberMesg.phone="-",t.memeberMesg.vestStoreNo="-",t.memeberMesg.name="-",t.memeberMesg.city="-",t.tableData=[],t.total=0}).catch(function(e){t.loading=!1,t.$notify.error({title:"提示",message:e.message})})):this.$notify.warning({title:"温馨提示",message:"会员手机号不能为空"})},invalidate:function(e){var t=this,a={mpId:e.mpId,status:-1};this.$http.post(o,l()({},a)).then(function(e){if(0===e.code)return t.$message.success("优惠券作废成功"),void t.doSearchHandel();throw new Error(e.msg)}).catch(function(e){t.$notify.error({title:"提示",message:e.message})})}}},m={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"search-form-wraper"},[a("el-form",{attrs:{model:e.searchContent,"label-position":"top"},nativeOn:{submit:function(e){e.preventDefault()}}},[a("el-form-item",{attrs:{label:"会员手机号"}},[a("el-input",{staticClass:"search-input",attrs:{placeholder:"会员手机号",size:"small",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.doSearchHandel(!0)}},model:{value:e.searchContent.phone,callback:function(t){e.$set(e.searchContent,"phone","string"==typeof t?t.trim():t)},expression:"searchContent.phone"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"优惠券状态"}},[a("el-select",{staticClass:"search-input",attrs:{filterable:"",placeholder:"请选择优惠券状态",size:"small",clearable:""},on:{change:function(t){return e.doSearchHandel(!0)}},model:{value:e.searchContent.status,callback:function(t){e.$set(e.searchContent,"status",t)},expression:"searchContent.status"}},e._l(e.statusOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"mini",disabled:!e.searchContent.phone},on:{click:function(t){return e.doSearchHandel(!0)}}},[e._v("搜索")])],1)],1)],1),e._v(" "),a("hr",{staticClass:"s-slip"}),e._v(" "),a("div",{staticClass:"handel-wraper icon-add-wrap-i"},[a("div",{staticClass:"memeber-mesg-item"},[a("span",[e._v("会员手机号:")]),e._v(" "),a("span",[e._v(e._s(e.memeberMesg.phone))])]),e._v(" "),a("div",{staticClass:"memeber-mesg-item"},[a("span",[e._v("会员昵称:")]),e._v(" "),a("span",[e._v(e._s(e.memeberMesg.name))])]),e._v(" "),a("div",{staticClass:"memeber-mesg-item"},[a("span",[e._v("会员归属城市:")]),e._v(" "),a("span",[e._v(e._s(e.memeberMesg.city))])]),e._v(" "),a("div",{staticClass:"memeber-mesg-item"},[a("span",[e._v("会员归属门店:")]),e._v(" "),a("span",[e._v(e._s(e.memeberMesg.vestStoreNo))])])]),e._v(" "),a("div",{staticClass:"table-wraper"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"fixed-height",staticStyle:{width:"100%"},attrs:{data:e.tableData,"empty-text":"没有查询到您想要的数据",size:"small"}},[a("el-table-column",{attrs:{"min-width":"80px",prop:"promId",label:"优惠券id"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"120px",prop:"title",label:"优惠券名称"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"120px",prop:"ruleSource",label:"优惠券使用范围"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"90px",prop:"promType",label:"优惠券类型"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"160px",prop:"promDetail",label:"优惠券详情"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"120px",label:"优惠券有效期"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("div",[e._v("\n              "+e._s(t.row.beginTime)+"\n            ")]),e._v(" "),a("div",[e._v("\n              至 \n            ")]),e._v(" "),a("div",[e._v("\n              "+e._s(t.row.endTime)+"\n            ")])])]}}])}),e._v(" "),a("el-table-column",{attrs:{"min-width":"160px",prop:"createTime",label:"优惠券发送时间"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"100px",prop:"statusStr",label:"优惠券状态"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"110px",prop:"city",label:"活动归属城市"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"100px",label:"所属活动id",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("router-link",{attrs:{to:t.row.redirectUrl,target:"_blank"}},[e._v(e._s(t.row.promCreateId))])],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{"min-width":"100px",label:"操作",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[0==t.row.status?a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return e.invalidate(t.row)}}},[e._v("优惠券作废")]):e._e()]}}])})],1),e._v(" "),e.total>0?a("el-pagination",{staticClass:"tc mt20",attrs:{background:"","current-page":e.pageNum,"page-sizes":[20,50,100,150,200],layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.changeSize,"current-change":e.changeCurrent,"update:currentPage":function(t){e.pageNum=t},"update:current-page":function(t){e.pageNum=t}}}):e._e()],1)])},staticRenderFns:[]};var u={promCountTotal:"/member/erp/memberProm/promCountTotal"},d={data:function(){return{loading:!1,searchContent:{recordId:""},tableData:[]}},created:function(){this.searchContent.recordId=this.$route.params.id,this.doSearchHandel()},methods:{triggerTypeFormater:function(e,t,a){switch(a){case 1:return"直接发放";case 4:return"充值返券(单次)";case 42:return"充值返券(多次)";case 71:return"消费发放";case 2:return"分享返券";case 3:return"签到返券";case 6:return"领取活动";case 81:return"扫码送券";case 82:return"扫码消费送券";case 91:return"省钱礼包";case 12:return"指定客户";case 111:return"天降红包";case 121:return"积分换券";default:return"其它券"}},doSearchHandel:function(){var e=this;this.searchContent.recordId&&(this.loading=!0,this.$http.post(u.promCountTotal,l()({},this.searchContent)).then(function(t){if(e.loading=!1,0!==t.code)throw new Error(t.msg);t.data&&t.data&&t.data.length?e.tableData=t.data:e.tableData=[]}).catch(function(t){e.loading=!1,e.$notify.error({title:"提示",message:t.message})}))},invalidate:function(e){var t=this,a={mpId:e.mpId,status:e.status};this.$http.post(u.updateStatus,l()({},a)).then(function(e){if(0===e.code)return t.$message.success("优惠券作废成功"),void t.doSearchHandel();throw new Error(e.msg)}).catch(function(e){t.$notify.error({title:"提示",message:e.message})})}}},p={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"search-form-wraper"},[a("el-form",{attrs:{model:e.searchContent,"label-position":"top"},nativeOn:{submit:function(e){e.preventDefault()}}},[a("el-form-item",{attrs:{label:"优惠券活动编码"}},[a("el-input",{staticClass:"search-input",attrs:{placeholder:"请输入活动编码",size:"small",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.doSearchHandel()}},model:{value:e.searchContent.recordId,callback:function(t){e.$set(e.searchContent,"recordId","string"==typeof t?t.trim():t)},expression:"searchContent.recordId"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"mini",disabled:!e.searchContent.recordId},on:{click:function(t){return e.doSearchHandel()}}},[e._v("搜索")])],1)],1)],1),e._v(" "),a("div",{staticClass:"table-wraper"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"fixed-height",staticStyle:{width:"100%"},attrs:{data:e.tableData,"empty-text":"没有查询到您想要的数据",size:"small"}},[a("el-table-column",{attrs:{"min-width":"110px",prop:"triggerType",label:"活动类型",formatter:e.triggerTypeFormater}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"80px",prop:"id",label:"活动编码"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"120px",prop:"title",label:"活动名称"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"120px",label:"活动时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("div",[e._v("\n              "+e._s(t.row.beginTime.slice(0,10))+"\n            ")]),e._v(" "),a("div",[e._v("\n              至 \n            ")]),e._v(" "),a("div",[e._v("\n              "+e._s(t.row.endTime.slice(0,10))+"\n            ")])])]}}])}),e._v(" "),a("el-table-column",{attrs:{"min-width":"80px",prop:"cityName",label:"参与区域"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"120px",label:"优惠券有效期"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.useDayCount?a("div",[e._v("\n            "+e._s(t.row.useDayCount)+" 天\n          ")]):t.row.useBeginTime&&t.row.useEndTime?a("div",[a("div",[e._v("\n              "+e._s(t.row.useBeginTime.slice(0,10))+"\n            ")]),e._v(" "),a("div",[e._v("\n              至 \n            ")]),e._v(" "),a("div",[e._v("\n              "+e._s(t.row.useEndTime.slice(0,10))+"\n            ")])]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{"min-width":"110px",prop:"totalCount",label:"优惠券总张数"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"80px",prop:"statusStr",label:"活动状态"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"80px",prop:"sendMemberCount",label:"发放人数"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"80px",prop:"sendMemberPromCount",label:"发放张数"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"90px",prop:"usedPromCount",label:"已使用张数"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"90px",prop:"unUsedPromCount",label:"未使用张数"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"90px",prop:"overPromCount",label:"已过期张数"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"90px",prop:"losePromCount",label:"已失效张数"}})],1)],1)])},staticRenderFns:[]};var h={data:function(){return{activeName:"first"}},components:{"member-search":a("VU/8")(c,m,!1,function(e){a("JSI0")},null,null).exports,"activity-search":a("VU/8")(d,p,!1,function(e){a("cW7o")},null,null).exports},created:function(){this.activeName=this.$route.params.id?"second":"first"},methods:{}},v={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-tabs",{staticClass:"common-tab",attrs:{type:"card"},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"会员查询",name:"first"}},[a("member-search",{ref:"memberSearch"})],1),e._v(" "),a("el-tab-pane",{attrs:{label:"活动查询",name:"second"}},[a("activity-search",{ref:"activitySearch"})],1)],1)],1)},staticRenderFns:[]};var b=a("VU/8")(h,v,!1,function(e){a("iX+u")},null,null);t.default=b.exports},"iX+u":function(e,t){}});
//# sourceMappingURL=18.85d2c21a71eacef958aa.js.map