{"version":3,"sources":["webpack:///src/components/Activity/DisCoupon/Add/AddSavePackage.vue","webpack:///./src/components/Activity/DisCoupon/Add/AddSavePackage.vue?c07f","webpack:///./src/components/Activity/DisCoupon/Add/AddSavePackage.vue"],"names":["reqUrl","AddSavePackage","data","isDisabled","addParamMesg","triggerType","triggerTypeName","cardType","title","beginTime","endTime","triggerAmount","triggerIntegral","triggerDisAmount","limitCount","setDisableTime","disabledDate","time","getTime","Date","now","triggerAmountChecked","triggerIntegralChecked","components","store-template","TemplateStore","prom-type-template","TemplatePromType","methods","changeStore","val","key","this","changePromType","promReqs","formattData","_this","countReg","countRegtofixed","$message","length","utils","useType","undefined","useBeginTime","useEndTime","useDayCount","test","disCount","disIsnull","promDiscounts","forEach","item","goodCount","goodIsnull","every","meetAmount","discAmount","sendPromCount","parseInt","needPayAmount","goodsNo","productQtyLimit","splice","doSaveHandel","_this2","$set","$http","post","extends_default","then","res","setTimeout","code","success","$router","push","Error","msg","catch","e","$notify","error","message","doCancelHandel","_this3","$confirm","confirmButtonText","cancelButtonText","type","Add_AddSavePackage","render","_vm","_h","$createElement","_c","_self","staticClass","ref","attrs","model","label-width","label","required","staticStyle","color","font-size","font-weight","_v","_s","size","placeholder","clearable","value","callback","$$v","expression","picker-options","disabled","slot","margin-left","_e","on","click","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/76.3d1dce4fe2578d430b2d.js","sourcesContent":["<style>\r\n.coupon-input{\r\n  width: 80px !important;\r\n}\r\n.coupon-input .el-input__inner,\r\n.coupon-input .el-input-group__append{\r\n  padding: 0 8px;\r\n}\r\n.prom-reqs .el-form-item__content .el-input-group{\r\n  vertical-align: middle;\r\n}\r\n.prom-reqs .el-form-item__content  .el-checkbox{\r\n  margin-right: 0\r\n}\r\n</style>\r\n<template>\r\n  <div>\r\n    <div class=\"add-form-wraper prom-reqs\">\r\n      <el-form ref=\"form\" :model=\"addParamMesg\" label-width=\"140px\">\r\n        <el-form-item label=\"活动类型\" required>\r\n          <p style=\"color: #222;font-size: 16px; font-weight: bold;\">{{addParamMesg.triggerTypeName}}</p>\r\n        </el-form-item>\r\n        <el-form-item label=\"活动名称\" required>\r\n          <el-input v-model=\"addParamMesg.title\" size=\"small\" class=\"add-input\" placeholder=\"请输入活动名称\" clearable></el-input>\r\n          <span>活动名称,限制30个汉字</span>\r\n        </el-form-item>\r\n        <el-form-item label=\"活动开始日期\" required>\r\n          <el-date-picker\r\n            class=\"add-input\"\r\n            v-model=\"addParamMesg.beginTime\"\r\n            type=\"date\"\r\n            placeholder=\"请选择活动开始日期\"\r\n            :picker-options=\"setDisableTime\"\r\n            size=\"small\">\r\n          </el-date-picker>\r\n          <span>活动开始日期</span>\r\n        </el-form-item>\r\n        <el-form-item label=\"活动结束日期\" required>\r\n          <el-date-picker\r\n            class=\"add-input\"\r\n            v-model=\"addParamMesg.endTime\"\r\n            type=\"date\"\r\n            placeholder=\"请选择活动结束日期\"\r\n            :picker-options=\"setDisableTime\"\r\n            size=\"small\">\r\n          </el-date-picker>\r\n          <span>活动结束日期</span>\r\n        </el-form-item>\r\n\r\n        <el-form-item label=\"购买方式\" required>\r\n          <el-checkbox v-model=\"triggerAmountChecked\" disabled>需要金额</el-checkbox>\r\n          <el-input size=\"small\" class=\"coupon-input\" v-model=\"addParamMesg.triggerAmount\">\r\n            <template slot=\"append\">元</template>\r\n          </el-input>\r\n          <span v-if=\"triggerIntegralChecked\">\r\n            <el-checkbox v-model=\"triggerIntegralChecked\" style=\"margin-left: 30px;\">积分购买</el-checkbox>\r\n            <el-input size=\"small\" class=\"coupon-input\" v-model=\"addParamMesg.triggerIntegral\">\r\n              <template slot=\"append\">分</template>\r\n            </el-input>\r\n          </span>\r\n          <span v-else-if=\"!triggerIntegralChecked\">\r\n            <el-checkbox v-model=\"triggerIntegralChecked\" style=\"margin-left: 30px;\">积分购买</el-checkbox>\r\n            <el-input size=\"small\" class=\"coupon-input\" v-model=\"addParamMesg.triggerIntegral\" disabled>\r\n              <template slot=\"append\">分</template>\r\n            </el-input>\r\n          </span>\r\n        </el-form-item>\r\n\r\n        <el-form-item label=\"限制&展示\">\r\n          <span>每人限购数量</span>\r\n          <el-input size=\"small\" class=\"coupon-input\" v-model=\"addParamMesg.limitCount\">\r\n            <template slot=\"append\">次</template>\r\n          </el-input>\r\n\r\n          <span style=\"margin-left: 30px;\">最高可节省金额</span>\r\n          <el-input size=\"small\" class=\"coupon-input\" v-model=\"addParamMesg.triggerDisAmount\">\r\n            <template slot=\"append\">元</template>\r\n          </el-input>\r\n\r\n          <span style=\"color: red;\">*最高可节省金额只用于小程序展示吸引用户。</span>\r\n        </el-form-item>\r\n\r\n        <!-- 门店 -->\r\n        <store-template @changeStore=\"changeStore\"></store-template>\r\n        <!-- 卡券形式 满减券 商品券 -->\r\n        <prom-type-template @changePromType=\"changePromType\" :triggerType=\"addParamMesg.triggerType\"></prom-type-template>\r\n\r\n        <el-form-item>\r\n          <el-button type=\"primary\" size=\"small\" @click=\"doSaveHandel\" :disabled=\"isDisabled\">保存</el-button>\r\n          <el-button size=\"small\" @click=\"doCancelHandel\">取消</el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\n  import * as utils from '@/utils/utils'\r\n  import TemplateStore from \"../AddTemplate/TemplateStore\"\r\n  import TemplatePromType from \"../AddTemplate/TemplatePromType\"\r\n  const reqUrl = {\r\n    // 新增活动规则\r\n    batchAddProm: \"/member/erp/prom/batchAddProm\"\r\n  }\r\n  export default {\r\n    data() {\r\n      return {\r\n        isDisabled: false,\r\n        addParamMesg: {\r\n          triggerType: 91,\r\n          triggerTypeName: '省钱礼包',\r\n          cardType: 2,\r\n          title: '',\r\n          beginTime: '',\r\n          endTime: '',\r\n          triggerAmount: '', // 省钱礼包，购买金额（3.0.2\r\n          triggerIntegral: '', // 省钱礼包，购买积分（3.0.2）\r\n          triggerDisAmount: '', // 省钱礼包，优惠金额（3.0.2\r\n          limitCount: ''\r\n        },\r\n        setDisableTime: {\r\n          disabledDate(time) {\r\n            return time.getTime() < Date.now() - 8.64e7;\r\n          }\r\n        },\r\n        // 省钱礼包，购买金额（3.0.2 输入框\r\n        triggerAmountChecked: true,\r\n        // 省钱礼包，购买积分（3.0.2）\r\n        triggerIntegralChecked: false\r\n      }\r\n    },\r\n    components: {\r\n      \"store-template\": TemplateStore,\r\n      \"prom-type-template\": TemplatePromType\r\n    },\r\n    methods: {\r\n      changeStore(val) {\r\n        // 传值\r\n        if(val) {\r\n          for(let key in val) {\r\n            this.addParamMesg[key] = val[key]\r\n          }\r\n        }\r\n      },\r\n      changePromType(val) {\r\n        this.addParamMesg.promReqs = val\r\n      },\r\n      /**\r\n       * [formattData 数据格式化]\r\n       * @return {[type]} [description]\r\n       */\r\n      formattData() {\r\n        let countReg = /^\\+?[1-9][0-9]*$/;\r\n        let countRegtofixed = /(^[1-9]{1}[0-9]*$)|(^[0-9]*\\.[0-9]{1}$)|(^[0-9]*\\.[0-9]{2}$)/\r\n        // 活动名称 日期\r\n        if(!this.addParamMesg.title) {\r\n          this.$message(\"请输入活动名称\")\r\n          return false\r\n        }else if(this.addParamMesg.title.length > 30) {\r\n          this.$message(\"活动名称限制30个汉字\")\r\n          return false\r\n        }\r\n        if(this.addParamMesg.beginTime == \"\") {\r\n          this.$message(\"请选择活动开始日期\")\r\n          return false\r\n        }else {\r\n          this.addParamMesg.beginTime = utils.timestampToTimeNoHMS(new Date(this.addParamMesg.beginTime).getTime()) + ' 00:00:00'\r\n        }\r\n        if(this.addParamMesg.endTime == \"\") {\r\n          this.$message(\"请选择活动结束日期\")\r\n          return false\r\n        }else {\r\n          this.addParamMesg.endTime = utils.timestampToTimeNoHMS(new Date(this.addParamMesg.endTime).getTime()) + ' 23:59:59'\r\n        }\r\n        if(new Date(this.addParamMesg.endTime).getTime() <= new Date(this.addParamMesg.beginTime).getTime()) {\r\n          this.$message(\"活动结束日期不能早于或等于开始日期\")\r\n          return false\r\n        }\r\n\r\n        // 卡券有效时间\r\n        if(this.addParamMesg.useType === \"\" || this.addParamMesg.useType === undefined) {\r\n          this.$message(\"请选择卡券有效时间\")\r\n          return false\r\n        }else if(this.addParamMesg.useType === 1) {\r\n          if(this.addParamMesg.useBeginTime == \"\") {\r\n            this.$message(\"请选择卡券有效开始日期\")\r\n            return false\r\n          }else {\r\n            this.addParamMesg.useBeginTime = utils.timestampToTimeNoHMS(new Date(this.addParamMesg.useBeginTime).getTime()) + ' 00:00:00'\r\n          }\r\n          if(this.addParamMesg.useEndTime == \"\") {\r\n            this.$message(\"请选择卡券有效结束日期\")\r\n            return false\r\n          }else {\r\n            this.addParamMesg.useEndTime = utils.timestampToTimeNoHMS(new Date(this.addParamMesg.useEndTime).getTime()) + ' 23:59:59'\r\n          }\r\n          if(new Date(this.addParamMesg.useEndTime).getTime() <= new Date(this.addParamMesg.useBeginTime).getTime()) {\r\n            this.$message(\"卡券有效结束日期不能早于或等于开始日期\")\r\n            return false\r\n          }\r\n          if(new Date(this.addParamMesg.useEndTime).getTime() < new Date(this.addParamMesg.endTime).getTime()) {\r\n            this.$message(\"卡券有效结束日期不能早于活动结束时间\")\r\n            return false\r\n          }\r\n          delete this.addParamMesg['useDayCount']\r\n        }else if(this.addParamMesg.useType === 2) {\r\n          if(this.addParamMesg.useDayCount == \"\") {\r\n            this.$message(\"卡券有效使用天数不能为空\")\r\n            return false\r\n          }\r\n          if(countReg.test(this.addParamMesg.useDayCount) == false) {\r\n            this.$message(\"卡券有效使用天数为大于零的整数\");\r\n            return false\r\n          }\r\n          delete this.addParamMesg['useBeginTime']\r\n          delete this.addParamMesg['useEndTime']\r\n        }\r\n\r\n        if(!this.addParamMesg.triggerAmount) {\r\n          this.$message(\"请输入购买方式中的需要金额\");\r\n          return false\r\n        }else {\r\n          if(this.addParamMesg.triggerAmount != 0 && !countRegtofixed.test(this.addParamMesg.triggerAmount)) {\r\n            this.$message('购买方式中的需要金额，输入大于等于0的数字，允许输入两位小数。')\r\n            return false\r\n          }\r\n        }\r\n\r\n        if(this.addParamMesg.triggerIntegral) {\r\n          if(!countReg.test(this.addParamMesg.triggerIntegral)) {\r\n            this.$message('购买方式中的积分购买值为大于零的整数。')\r\n            return false\r\n          }\r\n        }\r\n\r\n        if(this.addParamMesg.limitCount) {\r\n          if(!countReg.test(this.addParamMesg.limitCount)) {\r\n            this.$message('每人限购数量的值为大于零的整数。')\r\n            return false\r\n          }\r\n        }\r\n\r\n        if(this.addParamMesg.triggerDisAmount) {\r\n          if(this.addParamMesg.triggerDisAmount != 0 && !countRegtofixed.test(this.addParamMesg.triggerDisAmount)) {\r\n            this.$message('最高可节省金额，输入大于等于0的数字，允许输入两位小数。')\r\n            return false\r\n          }\r\n        }\r\n\r\n        // 满减券\r\n        let disCount = this.addParamMesg.promReqs[0]\r\n        let disIsnull = true\r\n        if(disCount && disCount.promDiscounts && disCount.promDiscounts.length > 0) {\r\n          disCount.promDiscounts.forEach(item => {\r\n            for(let key in item) {\r\n              if((key == 'discAmount' || key == 'meetAmount' || key == 'sendPromCount') && item[key] != '') {\r\n                disIsnull = false\r\n              }\r\n            }        \r\n          })\r\n        }\r\n        // 商品券\r\n        let goodCount = this.addParamMesg.promReqs[1]\r\n        let goodIsnull = true\r\n        if(goodCount && goodCount.promDiscounts && goodCount.promDiscounts.length > 0) {\r\n          goodCount.promDiscounts.forEach(item => {\r\n            for(let key in item) {\r\n              if((key == 'range' || key == 'goodsType' || key == 'needPayAmount' || key == 'goodsNo' || key == 'sendPromCount') && item[key] != '') {\r\n                goodIsnull = false\r\n              }\r\n            }        \r\n          })\r\n        }\r\n        \r\n        if(disIsnull && goodIsnull) {\r\n          this.$message('请设置满减券卡券奖励')\r\n          return false\r\n        }\r\n        if(disIsnull == false) {\r\n          let dis = disCount && disCount.promDiscounts ? disCount.promDiscounts.every(item => {\r\n            if(item.meetAmount == '' || item.discAmount == '' || item.sendPromCount == '') {\r\n              this.$message(\"满减券卡券奖励-满减金额或张数不能为空\");\r\n              return false\r\n            }else if(countRegtofixed.test(item.meetAmount) === false || countRegtofixed.test(item.discAmount) === false) {\r\n              this.$message(\"满减券卡券奖励-满减金额大于零的数字，允许输入两位小数\");\r\n              return false\r\n            }else if(countReg.test(item.sendPromCount) === false) {\r\n              this.$message(\"满减券卡券奖励-满减金额或张数为大于零的整数\");\r\n              return false\r\n            }else if(parseInt(item.meetAmount) < parseInt(item.discAmount)) {\r\n              this.$message(\"满减券卡券奖励-减金额不能大于满金额\");\r\n              return false\r\n            }\r\n            return true\r\n          }) : false\r\n          if(dis == false) {\r\n            return false\r\n          }\r\n        }\r\n        if(goodIsnull == false) {\r\n          let good = goodCount && goodCount.promDiscounts ? goodCount.promDiscounts.every(item => {\r\n            if(item.needPayAmount == '' || item.needPayAmount == undefined) {\r\n              this.$message('商品券卡券奖励-商品应付价格不能为空')\r\n              return false\r\n            }else {\r\n              if(item.needPayAmount != 0 && !countRegtofixed.test(item.needPayAmount)) {\r\n                this.$message('商品券卡券奖励-商品应付价格输入大于等于0的数字，允许输入一位小数。')\r\n                return false\r\n              }\r\n            }\r\n            if(item.goodsNo == '' || item.goodsNo == undefined) {\r\n              this.$message('商品券卡券奖励-请选择商品')\r\n              return false\r\n            }\r\n            if(item.productQtyLimit == '' || item.productQtyLimit == undefined) {\r\n              this.$message('商品券卡券奖励-请输入选择商品数量小于等于的值')\r\n              return false\r\n            }else {\r\n              if(!countReg.test(item.productQtyLimit)) {\r\n                this.$message('商品券卡券奖励-选择商品数量小于等于的值格式不对，为大于零的整数')\r\n                return false\r\n              }\r\n            }\r\n            if(item.sendPromCount === '' || item.sendPromCount == undefined) {\r\n              this.$message('商品券卡券奖励-请输入发放优惠券数量')\r\n              return false\r\n            }else { \r\n              if(!countReg.test(item.sendPromCount)) {\r\n                this.$message('商品券卡券奖励-发放优惠券数量为大于零的整数')\r\n                return false\r\n              }\r\n            }\r\n            return true\r\n          }) : false\r\n          if(good == false) {\r\n            return false\r\n          }\r\n        }\r\n        // 删除空的满减券或者商品券\r\n        if(disIsnull == true) {\r\n          this.addParamMesg.promReqs.splice(0,1)\r\n        }\r\n        if(goodIsnull == true) {\r\n          this.addParamMesg.promReqs.splice(1,1)\r\n        }\r\n        return true        \r\n      },\r\n      /**\r\n       * [doSaveHandel 保存]\r\n       * @return {[type]} [description]\r\n       */\r\n      doSaveHandel() {\r\n        if(this.formattData() === false) {\r\n          return\r\n        }\r\n        // 商品类型传3、4、5\r\n        if(this.addParamMesg.promReqs[0]) {\r\n          this.$set(this.addParamMesg.promReqs[0], 'onlineGoodsType', '3;4;5')\r\n        }\r\n        if(this.addParamMesg.promReqs[1]) {\r\n          this.$set(this.addParamMesg.promReqs[1], 'onlineGoodsType', '3;4;5')\r\n        }\r\n        this.isDisabled = true\r\n        this.$http.post(reqUrl.batchAddProm, {...this.addParamMesg}).then(res => {\r\n          // 保存按钮可再次点击\r\n          setTimeout(() => {\r\n            this.isDisabled = false\r\n          }, 800)\r\n          if(res.code === 0) {\r\n            this.$message.success(\"保存成功\")\r\n            this.$router.push('/discount_coupon')\r\n            return\r\n          }\r\n          throw new Error(res.msg)\r\n        }).catch(e => {\r\n          this.isDisabled = false\r\n          this.$notify.error({\r\n            title: '提示',\r\n            message: e.message\r\n          })\r\n        })\r\n      },\r\n      doCancelHandel() {\r\n        this.$confirm('确定取消吗?', '提示', {\r\n          confirmButtonText: '确定',\r\n          cancelButtonText: '取消',\r\n          type: 'warning'\r\n        }).then(() => {\r\n          this.$router.push('/discount_coupon')\r\n        }).catch(() => {})\r\n      }\r\n    }\r\n  }\r\n\r\n</script>\n\n\n// WEBPACK FOOTER //\n// src/components/Activity/DisCoupon/Add/AddSavePackage.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('div',{staticClass:\"add-form-wraper prom-reqs\"},[_c('el-form',{ref:\"form\",attrs:{\"model\":_vm.addParamMesg,\"label-width\":\"140px\"}},[_c('el-form-item',{attrs:{\"label\":\"活动类型\",\"required\":\"\"}},[_c('p',{staticStyle:{\"color\":\"#222\",\"font-size\":\"16px\",\"font-weight\":\"bold\"}},[_vm._v(_vm._s(_vm.addParamMesg.triggerTypeName))])]),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"活动名称\",\"required\":\"\"}},[_c('el-input',{staticClass:\"add-input\",attrs:{\"size\":\"small\",\"placeholder\":\"请输入活动名称\",\"clearable\":\"\"},model:{value:(_vm.addParamMesg.title),callback:function ($$v) {_vm.$set(_vm.addParamMesg, \"title\", $$v)},expression:\"addParamMesg.title\"}}),_vm._v(\" \"),_c('span',[_vm._v(\"活动名称,限制30个汉字\")])],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"活动开始日期\",\"required\":\"\"}},[_c('el-date-picker',{staticClass:\"add-input\",attrs:{\"type\":\"date\",\"placeholder\":\"请选择活动开始日期\",\"picker-options\":_vm.setDisableTime,\"size\":\"small\"},model:{value:(_vm.addParamMesg.beginTime),callback:function ($$v) {_vm.$set(_vm.addParamMesg, \"beginTime\", $$v)},expression:\"addParamMesg.beginTime\"}}),_vm._v(\" \"),_c('span',[_vm._v(\"活动开始日期\")])],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"活动结束日期\",\"required\":\"\"}},[_c('el-date-picker',{staticClass:\"add-input\",attrs:{\"type\":\"date\",\"placeholder\":\"请选择活动结束日期\",\"picker-options\":_vm.setDisableTime,\"size\":\"small\"},model:{value:(_vm.addParamMesg.endTime),callback:function ($$v) {_vm.$set(_vm.addParamMesg, \"endTime\", $$v)},expression:\"addParamMesg.endTime\"}}),_vm._v(\" \"),_c('span',[_vm._v(\"活动结束日期\")])],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"购买方式\",\"required\":\"\"}},[_c('el-checkbox',{attrs:{\"disabled\":\"\"},model:{value:(_vm.triggerAmountChecked),callback:function ($$v) {_vm.triggerAmountChecked=$$v},expression:\"triggerAmountChecked\"}},[_vm._v(\"需要金额\")]),_vm._v(\" \"),_c('el-input',{staticClass:\"coupon-input\",attrs:{\"size\":\"small\"},model:{value:(_vm.addParamMesg.triggerAmount),callback:function ($$v) {_vm.$set(_vm.addParamMesg, \"triggerAmount\", $$v)},expression:\"addParamMesg.triggerAmount\"}},[_c('template',{slot:\"append\"},[_vm._v(\"元\")])],2),_vm._v(\" \"),(_vm.triggerIntegralChecked)?_c('span',[_c('el-checkbox',{staticStyle:{\"margin-left\":\"30px\"},model:{value:(_vm.triggerIntegralChecked),callback:function ($$v) {_vm.triggerIntegralChecked=$$v},expression:\"triggerIntegralChecked\"}},[_vm._v(\"积分购买\")]),_vm._v(\" \"),_c('el-input',{staticClass:\"coupon-input\",attrs:{\"size\":\"small\"},model:{value:(_vm.addParamMesg.triggerIntegral),callback:function ($$v) {_vm.$set(_vm.addParamMesg, \"triggerIntegral\", $$v)},expression:\"addParamMesg.triggerIntegral\"}},[_c('template',{slot:\"append\"},[_vm._v(\"分\")])],2)],1):(!_vm.triggerIntegralChecked)?_c('span',[_c('el-checkbox',{staticStyle:{\"margin-left\":\"30px\"},model:{value:(_vm.triggerIntegralChecked),callback:function ($$v) {_vm.triggerIntegralChecked=$$v},expression:\"triggerIntegralChecked\"}},[_vm._v(\"积分购买\")]),_vm._v(\" \"),_c('el-input',{staticClass:\"coupon-input\",attrs:{\"size\":\"small\",\"disabled\":\"\"},model:{value:(_vm.addParamMesg.triggerIntegral),callback:function ($$v) {_vm.$set(_vm.addParamMesg, \"triggerIntegral\", $$v)},expression:\"addParamMesg.triggerIntegral\"}},[_c('template',{slot:\"append\"},[_vm._v(\"分\")])],2)],1):_vm._e()],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"限制&展示\"}},[_c('span',[_vm._v(\"每人限购数量\")]),_vm._v(\" \"),_c('el-input',{staticClass:\"coupon-input\",attrs:{\"size\":\"small\"},model:{value:(_vm.addParamMesg.limitCount),callback:function ($$v) {_vm.$set(_vm.addParamMesg, \"limitCount\", $$v)},expression:\"addParamMesg.limitCount\"}},[_c('template',{slot:\"append\"},[_vm._v(\"次\")])],2),_vm._v(\" \"),_c('span',{staticStyle:{\"margin-left\":\"30px\"}},[_vm._v(\"最高可节省金额\")]),_vm._v(\" \"),_c('el-input',{staticClass:\"coupon-input\",attrs:{\"size\":\"small\"},model:{value:(_vm.addParamMesg.triggerDisAmount),callback:function ($$v) {_vm.$set(_vm.addParamMesg, \"triggerDisAmount\", $$v)},expression:\"addParamMesg.triggerDisAmount\"}},[_c('template',{slot:\"append\"},[_vm._v(\"元\")])],2),_vm._v(\" \"),_c('span',{staticStyle:{\"color\":\"red\"}},[_vm._v(\"*最高可节省金额只用于小程序展示吸引用户。\")])],1),_vm._v(\" \"),_c('store-template',{on:{\"changeStore\":_vm.changeStore}}),_vm._v(\" \"),_c('prom-type-template',{attrs:{\"triggerType\":_vm.addParamMesg.triggerType},on:{\"changePromType\":_vm.changePromType}}),_vm._v(\" \"),_c('el-form-item',[_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"small\",\"disabled\":_vm.isDisabled},on:{\"click\":_vm.doSaveHandel}},[_vm._v(\"保存\")]),_vm._v(\" \"),_c('el-button',{attrs:{\"size\":\"small\"},on:{\"click\":_vm.doCancelHandel}},[_vm._v(\"取消\")])],1)],1)],1)])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-764bd872\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/Activity/DisCoupon/Add/AddSavePackage.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-764bd872\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../../../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./AddSavePackage.vue\")\n}\nvar normalizeComponent = require(\"!../../../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./AddSavePackage.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./AddSavePackage.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-764bd872\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../../../node_modules/vue-loader/lib/selector?type=template&index=0!./AddSavePackage.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/Activity/DisCoupon/Add/AddSavePackage.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}