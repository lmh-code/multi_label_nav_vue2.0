webpackJsonp([12],{"2RB4":function(e,t){},U9L3:function(e,t){},ZbaY:function(t,a,n){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var s=n("Dd8w"),i=n.n(s),o=n("NYxO"),l=n("Gu7T"),r=n.n(l),c=n("WorT"),d=n("ZAFg"),h=n("oAV5"),u=n("8uth"),m=n("Zbyc"),p={mixins:[c.a],data:function(){return{loading:!1,pageNum:1,pageSize:10,total:0,searchContent:{vendorNos:[],startTime:Object(h.b)("yyyy-MM-dd",(new Date).getTime())+" 00:00:00",endTime:Object(h.b)("yyyy-MM-dd",(new Date).getTime()+864e5)+" 23:59:59",showStatus:"",quoteNo:""},statusOptions:m.a.statusOptions,exportLoading:!1,checkedList:[],columns:[{title:"供应商",dataIndex:"vendorName",minWidth:120},{title:"报价单号",dataIndex:"quoteNo",ellipsis:!0,minWidth:170},{title:"最新报价时间",dataIndex:"updateTime",ellipsis:!0,minWidth:170},{title:"生效时间",dataIndex:"validTimeRange",ellipsis:!0,minWidth:170},{title:"状态",dataIndex:"showStatus",minWidth:80,formatData:this.showStatusFormat},{title:"操作",fixed:"right",width:150,operation:[{label:"查看",icon:"el-icon-view",clickFunc:this.goDetailPage},{label:"编辑",icon:"el-icon-edit",clickFunc:this.goEditPage,isShow:this.showEdit},{label:"发布",icon:"el-icon-top",clickFunc:this.publishHandel,isShow:this.showPublishAndDelete},{label:"删除",icon:"el-icon-delete",clickFunc:this.deleteHandel,isShow:this.showPublishAndDelete}]}],tableData:[],exportConfig:{vendorName:"供应商",quoteNo:"报价单号",updateTime:"最新报价时间",validTimeRange:"生效时间",statusDesc:"状态"}}},methods:{doAddHandel:function(){this.$router.push("/sale_mgt/add")},changeSize:function(e){this.pageSize=e,this.doSearchHandle()},changeCurrent:function(e){this.pageNum=e,this.doSearchHandle()},doSearchHandle:function(e){var t=this;this.checkedList=[],!0===e&&(this.pageNum=1),this.searchContent.startTime&&this.searchContent.endTime&&Object(h.a)(this.searchContent.startTime)>Object(h.a)(this.searchContent.endTime)?this.$tip.message("价格有效起始时间不能早于终止时间","warning"):(this.loading=!0,this.$http.post(d.a.getQuoteList,i()({},this.searchContent,{pageNum:this.pageNum,pageSize:this.pageSize})).then(function(e){if(t.loading=!1,0===e.code){var a=e.data&&e.data.result&&e.data.result.length?e.data.result:[];return a.forEach(function(e){e.validTimeRange=e.startTime+" ~ "+e.endTime}),t.tableData=a,void(t.total=e.data&&e.data.total?e.data.total:0)}throw new Error(e.msg)}).catch(function(e){t.loading=!1,t.$tip.notify(e.message||"","error","系统提示")}))},selectionChangeHandel:function(e){var t=e.selection;this.checkedList=[].concat(r()(t))},doExortHandel:function(){var e=this,t=Object(h.i)(this.exportConfig,!1),a=Object(h.i)(this.exportConfig,!0);this.checkedList.forEach(function(t){t.statusDesc=e.showStatusFormat(t.showStatus)}),u.a.ExportJsonToExcel({header:t,filterVal:a,data:this.checkedList,filename:"报价单汇总"})},goDetailPage:function(e){this.$router.push("/sale_mgt/see/"+e.quoteNo)},showEdit:function(e){return 0===e.showStatus||1===e.showStatus||2===e.showStatus},goEditPage:function(e){this.$router.push("/sale_mgt/edit/"+e.quoteNo)},showPublishAndDelete:function(e){return 0===e.showStatus},publishHandel:function(t){var a=this;this.$confirm("确定要执行发布操作吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.$http.post(d.a.publish,{quoteNo:t.quoteNo}).then(function(e){if(e&&0===e.code)return a.$tip.message("发布成功","success"),void a.doSearchHandle();throw new Error(e.msg)}).catch(function(t){a.$tip.notify(e.message||"","error","系统提示")})}).catch(function(){})},deleteHandel:function(t){var a=this;this.$confirm("确定要执行删除操作吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.$http.post(d.a.deleteQuote,{quoteNo:t.quoteNo}).then(function(e){if(e&&0===e.code)return a.$tip.message("删除成功","success"),void a.doSearchHandle();throw new Error(e.msg)}).catch(function(t){a.$tip.notify(e.message||"","error","系统提示")})}).catch(function(){})},showStatusFormat:function(e){var t=this.statusOptions.filter(function(t){return t.value===e})[0];return t?t.label:e}}},f={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"handel-wraper nopt"},[a("el-button",{attrs:{type:"primary",icon:"el-icon-plus",size:"mini"},on:{click:e.doAddHandel}},[e._v("新增报价单")])],1),e._v(" "),a("div",{staticClass:"search-form-wraper"},[a("el-form",{attrs:{model:e.searchContent,"label-position":"top"}},[a("el-form-item",{attrs:{label:"供应商"}},[a("el-select",{staticClass:"search-input",attrs:{placeholder:"选择供应商",multiple:"","collapse-tags":"",size:"small"},model:{value:e.searchContent.vendorNos,callback:function(t){e.$set(e.searchContent,"vendorNos",t)},expression:"searchContent.vendorNos"}},e._l(e.vendors,function(e){return a("el-option",{key:e.vendorNo,attrs:{label:e.vendorName,value:e.vendorNo}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"价格有效起始时间"}},[a("el-date-picker",{staticClass:"search-input",attrs:{type:"datetime",placeholder:"价格有效起始时间",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss",size:"small"},model:{value:e.searchContent.startTime,callback:function(t){e.$set(e.searchContent,"startTime",t)},expression:"searchContent.startTime"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"价格有效终止时间"}},[a("el-date-picker",{staticClass:"search-input",attrs:{type:"datetime",placeholder:"价格有效终止时间",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss",size:"small"},model:{value:e.searchContent.endTime,callback:function(t){e.$set(e.searchContent,"endTime",t)},expression:"searchContent.endTime"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"价格状态"}},[a("el-select",{staticClass:"search-input",attrs:{placeholder:"选择状态",filterable:"",clearable:"",size:"small"},model:{value:e.searchContent.showStatus,callback:function(t){e.$set(e.searchContent,"showStatus",t)},expression:"searchContent.showStatus"}},e._l(e.statusOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"报价单号"}},[a("el-input",{staticClass:"search-input",attrs:{size:"small",placeholder:"报价单号",clearable:""},model:{value:e.searchContent.quoteNo,callback:function(t){e.$set(e.searchContent,"quoteNo","string"==typeof t?t.trim():t)},expression:"searchContent.quoteNo"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.doSearchHandle(!0)}}},[e._v("搜索")])],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{disabled:0===e.checkedList.length,size:"mini",loading:e.exportLoading},on:{click:e.doExortHandel}},[e._v("导出")])],1)],1)],1),e._v(" "),a("div",{staticClass:"table-wraper"},[a("bl-table",{attrs:{loading:e.loading,border:!1,selection:!0,dataSource:e.tableData,columns:e.columns},on:{"selection-change":e.selectionChangeHandel}}),e._v(" "),a("bl-pagination",{attrs:{showPagination:e.tableData.length>0,pageNum:e.pageNum,total:e.total},on:{"size-change":e.changeSize,"current-change":e.changeCurrent}})],1)])},staticRenderFns:[]};var g=n("VU/8")(p,f,!1,function(e){n("2RB4")},"data-v-49c6e56d",null).exports,v=n("8e4C"),b={mixins:[c.a],data:function(){return{loading:!1,pageNum:1,pageSize:20,pageSizes:v.a.pageSizeStart20,total:0,searchContent:{vendorNos:[],startTime:Object(h.b)("yyyy-MM-dd",(new Date).getTime())+" 00:00:00",endTime:Object(h.b)("yyyy-MM-dd",(new Date).getTime()+864e5)+" 23:59:59",showStatus:"",quoteNo:"",goodsName:""},statusOptions:m.a.statusOptions,exportLoading:!1,checkedList:[],columns:[{title:"供应商",dataIndex:"vendorName",minWidth:120},{title:"条形码",dataIndex:"barCode",ellipsis:!0,minWidth:120},{title:"商品编码",dataIndex:"erpGoodsNo",ellipsis:!0,minWidth:120},{title:"货号",dataIndex:"vendorGoodsNo",ellipsis:!0,minWidth:110},{title:"商品名称",dataIndex:"goodsName",minWidth:120},{title:"规格",dataIndex:"spec",minWidth:90},{title:"单位",dataIndex:"unit",minWidth:90},{title:"报价单号",dataIndex:"quoteNo",ellipsis:!0,minWidth:170},{title:"市场参考价",dataIndex:"showPrice",minWidth:90},{title:"销售价",dataIndex:"salePrice",minWidth:90},{title:"日均可订货量",dataIndex:"qty",minWidth:110},{title:"价格有效期",dataIndex:"validTimeRange",ellipsis:!0,minWidth:170},{title:"报价时间",dataIndex:"updateTime",ellipsis:!0,minWidth:170}],tableData:[],exportConfig:{vendorName:"供应商",barCode:"条形码",erpGoodsNo:"商品编码",vendorGoodsNo:"货号",goodsName:"商品名称",spec:"规格",unit:"单位",quoteNo:"报价单号",showPrice:"市场参考价",salePrice:"销售价",qty:"日均可订货量",validTimeRange:"价格有效期",updateTime:"报价时间"}}},methods:{changeSize:function(e){this.pageSize=e,this.doSearchHandle()},changeCurrent:function(e){this.pageNum=e,this.doSearchHandle()},doSearchHandle:function(e){var t=this;this.checkedList=[],!0===e&&(this.pageNum=1),this.searchContent.startTime&&this.searchContent.endTime&&Object(h.a)(this.searchContent.startTime)>Object(h.a)(this.searchContent.endTime)?this.$tip.message("价格有效起始时间不能早于终止时间","warning"):(this.loading=!0,this.$http.post(d.a.getListByProduct,i()({},this.searchContent,{pageNum:this.pageNum,pageSize:this.pageSize})).then(function(e){if(t.loading=!1,0===e.code){var a=e.data&&e.data.result&&e.data.result.length?e.data.result:[];return a.forEach(function(e){e.validTimeRange=e.startTime+" ~ "+e.endTime}),t.tableData=a,void(t.total=e.data&&e.data.total?e.data.total:0)}throw new Error(e.msg)}).catch(function(e){t.loading=!1,t.$tip.notify(e.message||"","error","系统提示")}))},selectionChangeHandel:function(e){var t=e.selection;this.checkedList=[].concat(r()(t))},doExortHandel:function(){var e=Object(h.i)(this.exportConfig,!1),t=Object(h.i)(this.exportConfig,!0);u.a.ExportJsonToExcel({header:e,filterVal:t,data:this.checkedList,filename:"报价单汇总（商品维度）"})}}},y={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"search-form-wraper"},[a("el-form",{attrs:{model:e.searchContent,"label-position":"top"}},[a("el-form-item",{attrs:{label:"供应商"}},[a("el-select",{staticClass:"search-input",attrs:{placeholder:"选择供应商",multiple:"","collapse-tags":"",size:"small"},model:{value:e.searchContent.vendorNos,callback:function(t){e.$set(e.searchContent,"vendorNos",t)},expression:"searchContent.vendorNos"}},e._l(e.vendors,function(e){return a("el-option",{key:e.vendorNo,attrs:{label:e.vendorName,value:e.vendorNo}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"商品名称或编码"}},[a("el-input",{staticClass:"search-input",attrs:{size:"small",placeholder:"商品名称或编码",clearable:""},model:{value:e.searchContent.goodsName,callback:function(t){e.$set(e.searchContent,"goodsName","string"==typeof t?t.trim():t)},expression:"searchContent.goodsName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"报价单号"}},[a("el-input",{staticClass:"search-input",attrs:{size:"small",placeholder:"报价单号",clearable:""},model:{value:e.searchContent.quoteNo,callback:function(t){e.$set(e.searchContent,"quoteNo","string"==typeof t?t.trim():t)},expression:"searchContent.quoteNo"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"价格有效起始时间"}},[a("el-date-picker",{staticClass:"search-input",attrs:{type:"datetime",placeholder:"价格有效起始时间",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss",size:"small"},model:{value:e.searchContent.startTime,callback:function(t){e.$set(e.searchContent,"startTime",t)},expression:"searchContent.startTime"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"价格有效终止时间"}},[a("el-date-picker",{staticClass:"search-input",attrs:{type:"datetime",placeholder:"价格有效终止时间",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss",size:"small"},model:{value:e.searchContent.endTime,callback:function(t){e.$set(e.searchContent,"endTime",t)},expression:"searchContent.endTime"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"价格状态"}},[a("el-select",{staticClass:"search-input",attrs:{placeholder:"选择状态",filterable:"",clearable:"",size:"small"},model:{value:e.searchContent.showStatus,callback:function(t){e.$set(e.searchContent,"showStatus",t)},expression:"searchContent.showStatus"}},e._l(e.statusOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.doSearchHandle(!0)}}},[e._v("搜索")])],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{disabled:0===e.checkedList.length,size:"mini",loading:e.exportLoading},on:{click:e.doExortHandel}},[e._v("导出")])],1)],1)],1),e._v(" "),a("div",{staticClass:"table-wraper"},[a("bl-table",{attrs:{loading:e.loading,border:!1,selection:!0,dataSource:e.tableData,columns:e.columns},on:{"selection-change":e.selectionChangeHandel}}),e._v(" "),a("bl-pagination",{attrs:{showPagination:e.tableData.length>0,pageNum:e.pageNum,total:e.total,pageSizes:e.pageSizes},on:{"size-change":e.changeSize,"current-change":e.changeCurrent}})],1)])},staticRenderFns:[]},C={components:{LookByGoods:n("VU/8")(b,y,!1,null,null,null).exports,LookByPrice:g},data:function(){return{activeName:"first"}},mounted:function(){this.$refs.lookByPrice&&this.$refs.lookByPrice.doSearchHandle(!0),this.$refs.lookByGoods&&this.$refs.lookByGoods.doSearchHandle(!0)},activated:function(){this.researchMap[this.$route.path]&&("first"===this.activeName?this.$refs.lookByPrice&&this.$refs.lookByPrice.doSearchHandle():this.$refs.lookByGoods&&this.$refs.lookByGoods.doSearchHandle(),this.$jump.researched(this.$route.path))},computed:i()({},Object(o.b)({researchMap:"research/RESEARCH_MAP"}))},N={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"main-wrapper pt4"},[a("el-tabs",{attrs:{type:"card"},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"按报价单查看",name:"first"}},[a("look-by-price",{ref:"lookByPrice"})],1),e._v(" "),a("el-tab-pane",{attrs:{label:"按商品查看",name:"second"}},[a("look-by-goods",{ref:"lookByGoods"})],1)],1)],1)},staticRenderFns:[]};var x=n("VU/8")(C,N,!1,function(e){n("U9L3")},"data-v-76527968",null);a.default=x.exports}});
//# sourceMappingURL=12.c70489a029cf4d66926c.1615898974438.js.map