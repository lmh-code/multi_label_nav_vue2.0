webpackJsonp([30],{"2gmK":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("BO1k"),n=a.n(i),s=a("Dd8w"),c=a.n(s),r=a("ylbZ"),o=a("ssT3"),l=(a("oAV5"),a("bzuE")),u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-table",{staticClass:"fixed-height",staticStyle:{width:"100%"},attrs:{data:t.tableData,"empty-text":"没有查询到您想要的数据",size:"small"}},[a("el-table-column",{attrs:{"min-width":"70px",prop:"id",label:"活动ID"}}),t._v(" "),a("el-table-column",{attrs:{"min-width":"90px",prop:"activityType",label:"活动类型",formatter:t.activityTypeFormater}}),t._v(" "),a("el-table-column",{attrs:{"min-width":"160px",prop:"activityCode",label:"活动编码"}}),t._v(" "),a("el-table-column",{attrs:{"min-width":"150px",prop:"activityName",label:"活动名称"}}),t._v(" "),a("el-table-column",{attrs:{"min-width":"170px",label:"活动时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[a("p",[t._v(t._s(e.row.activityStartDate))]),t._v(" "),a("p",[t._v("至")]),t._v(" "),a("p",[t._v(t._s(e.row.activityEndDate))])])]}}])}),t._v(" "),a("el-table-column",{attrs:{"min-width":"86px",prop:"regionName",label:"活动区域"}}),t._v(" "),a("el-table-column",{attrs:{"min-width":"90px",prop:"storeNum",label:"参与门店数"}}),t._v(" "),a("el-table-column",{attrs:{"min-width":"90px",prop:"goodsNum",label:"参与商品数"}}),t._v(" "),a("el-table-column",{attrs:{"min-width":"120px",prop:"activityStatus",label:"活动状态",formatter:t.activityStatusFormater}}),t._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"140"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[a("div",[0===e.row.activityStatus?a("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-delete"},on:{click:function(a){return t.deleteItem(e.row)}}},[t._v("删除")]):a("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-view"},on:{click:function(a){return t.showItem(e.row)}}},[t._v("查看")]),t._v(" "),a("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-tickets"},on:{click:function(a){return t.copyItem(e.row)}}},[t._v("复制")])],1),t._v(" "),a("div",[0===e.row.activityStatus||2===e.row.activityStatus&&11!==e.row.activityType||3===e.row.activityStatus&&11!==e.row.activityType?a("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-edit"},on:{click:function(a){return t.editItem(e.row)}}},[t._v("编辑")]):t._e(),t._v(" "),0===e.row.activityStatus?a("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-upload2"},on:{click:function(a){return t.publichItem(e.row)}}},[t._v("发布")]):t._e(),t._v(" "),2!==e.row.activityStatus&&3!==e.row.activityStatus&&4!==e.row.activityStatus||11!==e.row.activityType?t._e():a("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-warning"},on:{click:function(a){return t.stopItem(e.row)}}},[t._v("终止")]),t._v(" "),2!==e.row.activityStatus&&3!==e.row.activityStatus||21!==e.row.activityType&&31!==e.row.activityType&&41!==e.row.activityType&&61!==e.row.activityType?t._e():a("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-warning"},on:{click:function(a){return t.stopItem(e.row)}}},[t._v("终止")])],1)])]}}])})],1)],1)},staticRenderFns:[]};var v="/plateform/a/preSale/activity/delActivity",h="/plateform/a/activityRule/list",m="/plateform/a/activityRule/updateStatus",p="/plateform/a/preSale/activity/failActivity",d="/plateform/a/preSale/activity/publishActivity",y={data:function(){return{pageSizes:l.a.pageSizes10,loading:!1,pageNum:1,pageSize:10,total:0,searchContent:{DIFFCITY:!0,regionCode:o.a.get("regionCode")||"",activityName:"",activityStartDate:"",activityEndDate:"",activityType:"",activityStatus:""},activityTypeOptions:[{label:"全部",value:""},{label:"拼团",value:11},{label:"秒杀",value:21},{label:"包装折扣",value:31},{label:"新人专享",value:41},{label:"每日爆款",value:61}],activityStatusOptions:[{label:"全部",activeName:"all",activeCount:0,value:""},{label:"进行中",activeName:"activeName3",activeCount:0,value:3},{label:"未发布",activeName:"activeName0",activeCount:0,value:0},{label:"未开始",activeName:"activeName2",activeCount:0,value:2},{label:"已结束",activeName:"activeName4",activeCount:0,value:4},{label:"已终止",activeName:"activeName5",activeCount:0,value:5}],storeOptions:[],tableData:[],activeName:"all"}},mounted:function(){var t=o.a.get("searchContent");this.$route.meta.keepAlive&&t&&(this.pageNum=t.pageNum,this.searchContent=t.searchContent,this.activeName=t.tabName),o.a.remove("searchContent"),this.handleTabClick({name:this.activeName})},components:{"my-table":a("VU/8")({data:function(){return{tableData:[]}},methods:{setDefaultMesg:function(t){this.tableData=t.tableData},activityTypeFormater:function(t,e,a){return 11===a?"拼团":21===a?"秒杀":31===a?"包装折扣":41===a?"新人专享":61===a?"每日爆款":a},activityStatusFormater:function(t,e,a){return 0===a?"未发布":1==a?"已发布":2==a?"未开始[发布中]":3==a?"进行中[发布中]":4==a?11===t.activityType?"已结束[发布中]":"已结束":5==a?"已终止":6==a?"已失效":void 0},stopItem:function(t){this.$emit("stopItem",t)},editItem:function(t){this.$emit("editItem",t)},showItem:function(t){this.$emit("showItem",t)},copyItem:function(t){this.$emit("copyItem",t)},publichItem:function(t){this.$emit("publichItem",t)},deleteItem:function(t){this.$emit("deleteItem",t)}}},u,!1,function(t){a("tX+b")},null,null).exports,region:r.a},methods:{RegionChange:function(t){this.searchContent.regionCode=t.regionCode,this.doSearchHandel(!0)},addGbPage:function(){this.$router.push("/store_act/addgb/11")},addTbPage:function(){this.$router.push("/store_act/addtb/21")},addNUPage:function(){this.$router.push("/store_act/addnu/41")},addBKPage:function(){this.$router.push("/store_act/addbk/61")},handleTabClick:function(t){"all"==t.name?this.searchContent.activityStatus="":"activeName0"==t.name?this.searchContent.activityStatus=0:"activeName1"==t.name?this.searchContent.activityStatus=1:"activeName2"==t.name?this.searchContent.activityStatus=2:"activeName3"==t.name?this.searchContent.activityStatus=3:"activeName4"==t.name?this.searchContent.activityStatus=4:"activeName5"==t.name?this.searchContent.activityStatus=5:"activeName6"==t.name&&(this.searchContent.activityStatus=6),this.activeName=t.name,this.doSearchHandel(!0)},changeSize:function(t){this.pageSize=t,this.doSearchHandel()},changeCurrent:function(t){this.pageNum=t,this.doSearchHandel()},doSearchHandel:function(t){var e=this,a=this.searchContent.activityStartDate?Date.parse(new Date(this.searchContent.activityStartDate.replace(/-/g,"/"))):0,i=this.searchContent.activityEndDate?Date.parse(new Date(this.searchContent.activityEndDate.replace(/-/g,"/"))):0;this.searchContent.activityStartDate&&this.searchContent.activityEndDate&&!isNaN(a)&&!isNaN(i)&&a>i?this.$message("结束时间不能早于开始时间"):(this.loading=!0,!0===t&&(this.pageNum=1),this.$http.post(h,c()({},this.searchContent,{pageSize:this.pageSize,pageNum:this.pageNum})).then(function(t){if(e.loading=!1,0!==t.code)throw new Error(t.msg);if(t.data&&t.data.pageVo&&t.data.pageVo.result&&t.data.pageVo.result.length){e.tableData=t.data.pageVo.result;var a={tableData:e.tableData};e.$refs.myTable&&e.$refs.myTable.setDefaultMesg(a),e.total=t.data.pageVo.total}else{e.tableData=[];var i={tableData:e.tableData};e.$refs.myTable&&e.$refs.myTable.setDefaultMesg(i);var s=!0,c=!1,r=void 0;try{for(var o,l=n()(e.activityStatusOptions);!(s=(o=l.next()).done);s=!0){o.value.activeCount=0}}catch(t){c=!0,r=t}finally{try{!s&&l.return&&l.return()}finally{if(c)throw r}}e.total=0}var u=!0,v=!1,h=void 0;try{for(var m,p=n()(e.activityStatusOptions);!(u=(m=p.next()).done);u=!0){var d=m.value;""===d.value?d.activeCount=t.data.allCount||0:3===d.value?d.activeCount=t.data.goingCount||0:0===d.value?d.activeCount=t.data.unPublishedCount||0:2===d.value?d.activeCount=t.data.startedCount||0:4===d.value?d.activeCount=t.data.endCount||0:5===d.value&&(d.activeCount=t.data.stopCount||0)}}catch(t){v=!0,h=t}finally{try{!u&&p.return&&p.return()}finally{if(v)throw h}}}).catch(function(t){e.loading=!1,e.$notify.error({title:"提示",message:t.message})}))},editItem:function(t){var e={pageNum:this.pageNum,tabName:this.activeName,searchContent:this.searchContent};o.a.set("searchContent",e);var a=t.id,i=t.activityType,n=t.activityStatus;11===i?this.$router.push("/store_act/editgb/"+a+"/edit?status="+n):21===i?this.$router.push("/store_act/edittb/"+a+"/edit?status="+n):31===i?this.$router.push("/store_act/editdis/"+a+"/edit?status="+n):41===i?this.$router.push("/store_act/editnu/"+a+"/edit?status="+n):61===i?this.$router.push("/store_act/editbk/"+a+"/edit?status="+n):this.$notify.warning({title:"温馨提示",message:"不存在改活动类型！"})},showItem:function(t){var e={pageNum:this.pageNum,activeName:this.activeName,searchContent:this.searchContent};o.a.set("searchContent",e);var a=t.id,i=t.activityType;11===i?this.$router.push("/store_act/showgb/"+a):21===i?this.$router.push("/store_act/showtb/"+a):31===i?this.$router.push("/store_act/showdis/"+a):41===i?this.$router.push("/store_act/shownu/"+a):61===i?this.$router.push("/store_act/showbk/"+a):this.$notify.warning({title:"温馨提示",message:"不存在改活动类型！"})},copyItem:function(t){var e={pageNum:this.pageNum,activeName:this.activeName,searchContent:this.searchContent};o.a.set("searchContent",e);var a=t.id,i=t.activityType;11===i?this.$router.push("/store_act/editgb/"+a+"/copy"):21===i?this.$router.push("/store_act/edittb/"+a+"/copy"):31===i?this.$router.push("/store_act/editdis/"+a+"/copy"):41===i?this.$router.push("/store_act/editnu/"+a+"/copy"):61===i?this.$router.push("/store_act/editbk/"+a+"/copy"):this.$notify.warning({title:"温馨提示",message:"不存在改活动类型！"})},publichItem:function(t){var e=this,a=t.activityEndDate||"",i=Date.parse(new Date(a.replace(/-/g,"/"))),n=(new Date).getTime();a&&!isNaN(i)&&(n>i?this.$confirm("该活动已过期，是否继续发布？","提示",{confirmButtonText:"继续",cancelButtonText:"取消",type:"warning"}).then(function(){e.publichItemHandel(t)}).catch(function(){}):this.$confirm("您确定要发布所选活动吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.publichItemHandel(t)}).catch(function(){}))},publichItemHandel:function(t){var e=this,a={DIFFCITY:!0,activityId:t.id,activityStatus:1},i=41===t.activityType?d:m;this.$http.post(i,c()({},a)).then(function(t){if(0===t.code)return e.$message.success("发布成功"),void e.doSearchHandel();throw new Error(t.msg)}).catch(function(t){e.$notify.error({title:"提示",message:t.message})})},stopItem:function(t){var e=this,a={DIFFCITY:!0,activityId:t.id,activityStatus:5},i=41===t.activityType?p:m;this.$confirm("您确定要终止所选活动吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$http.post(i,c()({},a)).then(function(t){if(0===t.code)return e.$message.success("终止成功"),void e.doSearchHandel();throw new Error(t.msg)}).catch(function(t){e.$notify.error({title:"提示",message:t.message})})}).catch(function(){})},deleteItem:function(t){var e=this,a=t.id;this.$confirm("您确认删除当前未发布的活动吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$http.post(v,{activityId:a,DIFFCITY:!0}).then(function(t){if(0===t.code)return e.$message.success("删除成功"),void e.doSearchHandel();throw new Error(t.msg)}).catch(function(t){e.$notify.error({title:"提示",message:t.message})})}).catch(function(){})}},beforeRouteLeave:function(t,e,a){e.meta.keepAlive=!1,a()}},f={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"handel-search-wraper"},[a("div",{staticClass:"handel-wraper icon-add-wrap-i"},[a("div",{staticClass:"group-buy-add-wraper"},[t._m(0),t._v(" "),t._m(1),t._v(" "),a("div",[a("el-button",{staticClass:"sup-mini",attrs:{type:"primary",size:"mini"},on:{click:t.addGbPage}},[t._v("立即创建")])],1)]),t._v(" "),a("div",{staticClass:"group-buy-add-wraper"},[t._m(2),t._v(" "),t._m(3),t._v(" "),a("div",[a("el-button",{staticClass:"sup-mini",attrs:{type:"primary",size:"mini"},on:{click:t.addTbPage}},[t._v("立即创建")])],1)]),t._v(" "),a("div",{staticClass:"group-buy-add-wraper"},[t._m(4),t._v(" "),t._m(5),t._v(" "),a("div",[a("el-button",{staticClass:"sup-mini",attrs:{type:"primary",size:"mini"},on:{click:t.addBKPage}},[t._v("立即创建")])],1)]),t._v(" "),a("div",{staticClass:"group-buy-add-wraper"},[t._m(6),t._v(" "),t._m(7),t._v(" "),a("div",[a("el-button",{staticClass:"sup-mini",attrs:{type:"primary",size:"mini"},on:{click:t.addNUPage}},[t._v("立即创建")])],1)])]),t._v(" "),a("hr",{staticClass:"s-slip"}),t._v(" "),a("div",{staticClass:"search-form-wraper"},[a("el-form",{attrs:{model:t.searchContent,"label-position":"top"}},[a("region",{staticClass:"region-wrap",attrs:{refresh:!1},on:{RegionChange:t.RegionChange}}),t._v(" "),a("el-form-item",{attrs:{label:"活动名称"}},[a("el-input",{staticClass:"search-input",attrs:{placeholder:"请输入活动名称",size:"small",clearable:""},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.doSearchHandel(!0)}},model:{value:t.searchContent.activityName,callback:function(e){t.$set(t.searchContent,"activityName","string"==typeof e?e.trim():e)},expression:"searchContent.activityName"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"开始时间"}},[a("el-date-picker",{staticClass:"search-input",attrs:{type:"datetime",placeholder:"请选择开始时间",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss",size:"small"},on:{change:function(e){return t.doSearchHandel(!0)}},model:{value:t.searchContent.activityStartDate,callback:function(e){t.$set(t.searchContent,"activityStartDate",e)},expression:"searchContent.activityStartDate"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"结束时间"}},[a("el-date-picker",{staticClass:"search-input",attrs:{type:"datetime",placeholder:"请选择结束时间",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss",size:"small"},on:{change:function(e){return t.doSearchHandel(!0)}},model:{value:t.searchContent.activityEndDate,callback:function(e){t.$set(t.searchContent,"activityEndDate",e)},expression:"searchContent.activityEndDate"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"活动类型"}},[a("el-select",{staticClass:"search-input",attrs:{filterable:"",placeholder:"请选择类型",clearable:"",size:"small"},on:{change:function(e){return t.doSearchHandel(!0)}},model:{value:t.searchContent.activityType,callback:function(e){t.$set(t.searchContent,"activityType",e)},expression:"searchContent.activityType"}},t._l(t.activityTypeOptions,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.doSearchHandel(!0)}}},[t._v("搜索")])],1)],1)],1)]),t._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"table-wraper tab-wraper"},[a("el-tabs",{on:{"tab-click":t.handleTabClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[t._l(t.activityStatusOptions,function(e,i){return a("el-tab-pane",{key:i,attrs:{name:e.activeName}},[a("span",{attrs:{slot:"label"},slot:"label"},[t._v(t._s(e.label)+" "+t._s(e.activeCount))])])}),t._v(" "),a("my-table",{ref:"myTable",on:{editItem:t.editItem,showItem:t.showItem,copyItem:t.copyItem,publichItem:t.publichItem,stopItem:t.stopItem,deleteItem:t.deleteItem}})],2),t._v(" "),t.total>0?a("el-pagination",{staticClass:"tc mt20",attrs:{background:"","current-page":t.pageNum,"page-sizes":t.pageSizes,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.changeSize,"current-change":t.changeCurrent,"update:currentPage":function(e){t.pageNum=e},"update:current-page":function(e){t.pageNum=e}}}):t._e()],1)])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"act-img-wrap"},[e("img",{staticClass:"act-img-w-h",attrs:{src:"/shop/static/imgs/gb.png",alt:""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"act-tip-txt"},[e("p",[this._v("拼团活动")]),this._v(" "),e("p",[this._v("引流&促销")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"act-img-wrap"},[e("img",{staticClass:"act-img-w-h",attrs:{src:"/shop/static/imgs/tb.png",alt:""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"act-tip-txt"},[e("p",[this._v("秒杀活动")]),this._v(" "),e("p",[this._v("引流&促销")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"act-img-wrap"},[e("img",{staticClass:"act-img-w-h",attrs:{src:"/shop/static/imgs/dis.png",alt:""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"act-tip-txt"},[e("p",[this._v("爆款活动")]),this._v(" "),e("p",[this._v("引流&促销")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"act-img-wrap"},[e("img",{staticClass:"act-img-w-h",attrs:{src:"/shop/static/imgs/newuser.png",alt:""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"act-tip-txt"},[e("p",[this._v("新人专享")]),this._v(" "),e("p",[this._v("引流&促销")])])}]};var g=a("VU/8")(y,f,!1,function(t){a("bGbc")},null,null);e.default=g.exports},bGbc:function(t,e){},"tX+b":function(t,e){}});
//# sourceMappingURL=30.c3955cd4c600b9d19d6f.js.map