webpackJsonp([70],{KBj9:function(a,e){},lpC3:function(a,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=t("Dd8w"),d=t.n(s),r=t("mvHQ"),m=t.n(r),o=t("oAV5"),i=(t("ssT3"),"/plateform/a/store/platform/info"),l="/plateform/a/store/platform/online",n={data:function(){return{isDisabled:!1,platformId:"",addParamMesg:{platform:"",platformName:"",openDc:1,dcTimeTemp:["",""],dcOpenTime:"",dcCloseTime:"",dcScope:"",storeId:"",outerPlatformId:"",storeNo:"",openStatus:1},openStatusRadioOpt:[{label:1,labelName:"营业中"},{label:2,labelName:"歇业中"}]}},created:function(){this.platformId=this.$route.params.platformId,this.addParamMesg.platform=this.$route.params.platformId,this.addParamMesg.storeId=this.$route.params.storeId,this.addParamMesg.storeNo=this.$route.params.storeNo,1==this.platformId?this.addParamMesg.platformName="有赞":2==this.platformId?this.addParamMesg.platformName="京东到家":3==this.platformId?this.addParamMesg.platformName="美团外卖":4==this.platformId?this.addParamMesg.platformName="饿了么":5==this.platformId&&(this.addParamMesg.platformName="本来鲜"),this.getDetailMesg()},methods:{openDcChange:function(a){this.addParamMesg.openDc=parseInt(a),0==a&&(this.addParamMesg.dcTimeTemp=["",""],this.addParamMesg.dcOpenTime="",this.addParamMesg.dcCloseTime="",this.addParamMesg.dcScope="")},getDetailMesg:function(){var a=this;o.r(),this.$http.post(i,{platformId:this.platformId,storeNo:this.addParamMesg.storeNo}).then(function(e){if(o.c(),0!==e.code)throw new Error(e.msg);e.data&&(a.addParamMesg.platform=e.data.platform,a.addParamMesg.platformName=e.data.platformName,e.data.openStatus?a.addParamMesg.openStatus=parseInt(e.data.openStatus):a.addParamMesg.openStatus=1,a.addParamMesg.outerPlatformId=e.data.outerPlatformId,e.data.openDc?a.addParamMesg.openDc=parseInt(e.data.openDc):a.addParamMesg.openDc=0,e.data.dcOpenTime&&(a.addParamMesg.dcTimeTemp[0]=e.data.dcOpenTime,a.addParamMesg.dcOpenTime=e.data.dcOpenTime),e.data.dcCloseTime&&(a.addParamMesg.dcTimeTemp[1]=e.data.dcCloseTime,a.addParamMesg.dcCloseTime=e.data.dcCloseTime),0==a.addParamMesg.openDc&&(a.addParamMesg.dcTimeTemp=["",""],a.addParamMesg.dcOpenTime="",a.addParamMesg.dcCloseTime="",a.addParamMesg.dcScope=""),a.addParamMesg.dcScope=e.data.dcScope,a.addParamMesg.dcTimeTemp=JSON.parse(m()(a.addParamMesg.dcTimeTemp)))}).catch(function(e){o.c(),a.$notify.error({title:"提示",message:e.message})})},doSaveHandel:function(){var a=this;if(""!==this.addParamMesg.platform){if(this.addParamMesg.dcTimeTemp[0]&&""!=this.addParamMesg.dcTimeTemp[0]&&(this.addParamMesg.dcOpenTime=this.addParamMesg.dcTimeTemp[0]),this.addParamMesg.dcTimeTemp[1]&&""!=this.addParamMesg.dcTimeTemp[1]&&(this.addParamMesg.dcCloseTime=this.addParamMesg.dcTimeTemp[1]),5==this.platformId){if(""===this.addParamMesg.openDc)return void this.$message("请选择是否立即开启配送");if(1===this.addParamMesg.openDc){if(""===this.addParamMesg.dcOpenTime)return void this.$message("请选择可配送开始时间");if(""===this.addParamMesg.dcCloseTime)return void this.$message("请选择可配送结束时间");var e=o.b(this.addParamMesg.dcOpenTime);if(o.b(this.addParamMesg.dcCloseTime)<=e)return void this.$message("配送结束时间不能早于开始时间");if(""===this.addParamMesg.dcScope)return void this.$message("请选择可配送范围");if(!/^\d+(?=\.{0,1}\d+$|$)/.test(this.addParamMesg.dcScope))return void this.$message("可配送范围为大于0数字");if(parseFloat(this.addParamMesg.dcScope)<0)return void this.$message("可配送范围为大于0数字")}}else if(""===this.addParamMesg.outerPlatformId)return void this.$message("请输入三方门店ID");""!==this.addParamMesg.openStatus?(o.r(),this.isDisabled=!0,this.$http.post(l,d()({},this.addParamMesg)).then(function(e){if(o.c(),setTimeout(function(){a.isDisabled=!1},800),0===e.code)return a.$message.success("开启线上业务成功"),void a.$router.push("/blx_store");throw new Error(e.msg)}).catch(function(e){o.c(),a.isDisabled=!1,a.$notify.error({title:"提示",message:e.message})})):this.$message("请选择营业状态")}else this.$message("请选择平台")},doCancelHandel:function(){var a=this;this.$confirm("确定取消开启线上业务吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.$router.push("/blx_store")}).catch(function(){})}},beforeRouteLeave:function(a,e,t){a.meta.keepAlive=!0,t()}},p={render:function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("div",[t("div",{staticClass:"add-form-wraper"},[t("el-form",{ref:"form",attrs:{model:a.addParamMesg,"label-width":"160px"}},[t("el-form-item",{attrs:{label:"销售平台"}},[t("p",{staticStyle:{"font-size":"16px !important",color:"#555","font-weight":"bold"}},[a._v(a._s(a.addParamMesg.platformName))])]),a._v(" "),5==a.platformId?t("el-form-item",{attrs:{label:"开启配送",required:""}},[t("el-radio-group",{attrs:{size:"small"},on:{change:a.openDcChange},model:{value:a.addParamMesg.openDc,callback:function(e){a.$set(a.addParamMesg,"openDc",e)},expression:"addParamMesg.openDc"}},[t("el-radio-button",{attrs:{label:"1"}},[a._v("是")]),a._v(" "),t("el-radio-button",{attrs:{label:"0"}},[a._v("否")])],1)],1):a._e(),a._v(" "),5==a.platformId&&1===a.addParamMesg.openDc?t("el-form-item",{attrs:{label:"立即送时间",required:""}},[t("el-time-picker",{staticClass:"add-input",attrs:{"is-range":"","range-separator":"-","start-placeholder":"开始时间",size:"small",format:"HH:mm","value-format":"HH:mm","end-placeholder":"结束时间"},model:{value:a.addParamMesg.dcTimeTemp,callback:function(e){a.$set(a.addParamMesg,"dcTimeTemp",e)},expression:"addParamMesg.dcTimeTemp"}})],1):a._e(),a._v(" "),5==a.platformId&&1===a.addParamMesg.openDc?t("el-form-item",{attrs:{label:"配送范围",required:""}},[t("el-input",{staticClass:"add-input",attrs:{size:"small",placeholder:"请输入配送范围"},model:{value:a.addParamMesg.dcScope,callback:function(e){a.$set(a.addParamMesg,"dcScope",e)},expression:"addParamMesg.dcScope"}},[t("el-button",{attrs:{slot:"prepend"},slot:"prepend"},[a._v("半径")]),a._v(" "),t("el-button",{attrs:{slot:"append"},slot:"append"},[a._v("公里")])],1),a._v(" "),t("span",[a._v("配送范围为大于0的整数或小数")])],1):a._e(),a._v(" "),5!=a.platformId?t("el-form-item",{attrs:{label:"关联三方门店ID",required:""}},[t("el-input",{staticClass:"add-input",attrs:{size:"small",placeholder:"请输入三方门店ID"},model:{value:a.addParamMesg.outerPlatformId,callback:function(e){a.$set(a.addParamMesg,"outerPlatformId",e)},expression:"addParamMesg.outerPlatformId"}})],1):a._e(),a._v(" "),t("el-form-item",{attrs:{label:"营业状态",required:""}},[t("el-radio-group",{attrs:{size:"small"},model:{value:a.addParamMesg.openStatus,callback:function(e){a.$set(a.addParamMesg,"openStatus",e)},expression:"addParamMesg.openStatus"}},a._l(a.openStatusRadioOpt,function(e,s){return t("el-radio-button",{key:s,attrs:{label:e.label}},[a._v(a._s(e.labelName))])}),1)],1),a._v(" "),t("hr",{staticClass:"s-slip-tb"}),a._v(" "),t("el-form-item",[t("el-button",{attrs:{type:"primary",size:"small",disabled:a.isDisabled},on:{click:a.doSaveHandel}},[a._v("保存")]),a._v(" "),t("el-button",{attrs:{size:"small"},on:{click:a.doCancelHandel}},[a._v("取消")])],1)],1)],1)])},staticRenderFns:[]};var c=t("VU/8")(n,p,!1,function(a){t("KBj9")},null,null);e.default=c.exports}});
//# sourceMappingURL=70.bd1214588f6fc6aed263.js.map