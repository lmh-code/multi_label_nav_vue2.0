webpackJsonp([28],{K975:function(t,e){},f6J0:function(t,e,i){"use strict";var a=i("BO1k"),s=i.n(a),o=i("Gu7T"),r=i.n(o),n=i("oAV5"),c={data:function(){return{tableData:[],scene:"",checkedList:[]}},methods:{setDefaultMesg:function(t){this.tableData=t.tableData||[],this.checkedList=t.checkedList||[],this.scene=t.scene||"",this.defaultSelectFun()},handleSelect:function(t,e){var i={},a=[];if(n.m(e.platformCityGoodsId,"platformCityGoodsId",this.checkedList))this.checkedList=n.q("platformCityGoodsId",e.platformCityGoodsId,this.checkedList);else{a.push(e);var s=[].concat(a,r()(this.checkedList));this.checkedList=s.reduceRight(function(t,e){return!i[e.platformCityGoodsId]&&(i[e.platformCityGoodsId]=t.push(e)),t},[]);var o={scene:this.scene,checkedList:this.checkedList};this.$emit("setDefaultChecked",o)}},handleSelectAll:function(t){var e={};if(t.length>0){var i=!0,a=!1,o=void 0;try{for(var r,c=s()(t);!(i=(r=c.next()).done);i=!0){var l=r.value;this.checkedList.push(l)}}catch(t){a=!0,o=t}finally{try{!i&&c.return&&c.return()}finally{if(a)throw o}}this.checkedList=this.checkedList.reduceRight(function(t,i){return!e[i.platformCityGoodsId]&&(e[i.platformCityGoodsId]=t.push(i)),t},[])}else{var d=[],u=!0,m=!1,v=void 0;try{for(var f,h=s()(this.tableData);!(u=(f=h.next()).done);u=!0){var p=f.value;d.push(p)}}catch(t){m=!0,v=t}finally{try{!u&&h.return&&h.return()}finally{if(m)throw v}}var y=n.i(this.checkedList,d,"platformCityGoodsId");this.checkedList=y&&y.length>0?y:[]}var g={scene:this.scene,checkedList:this.checkedList};this.$emit("setDefaultChecked",g)},defaultSelectFun:function(){var t=this,e=[],i=!0,a=!1,o=void 0;try{for(var r,n=s()(this.tableData);!(i=(r=n.next()).done);i=!0){var c=r.value,l=!0,d=!1,u=void 0;try{for(var m,v=s()(this.checkedList);!(l=(m=v.next()).done);l=!0){var f=m.value;c.platformCityGoodsId==f.platformCityGoodsId&&(c.goodsName=f.goodsName,c.activityId=f.activityId,c.id=f.id,c.activityTimes=f.activityTimes,c.curStock=f.curStock,c.groupCount=f.groupCount,c.groupPrice=f.groupPrice,c.limitGroupType=f.limitGroupType,c.sortNum=f.sortNum,c.limitGoodsCount=f.limitGoodsCount,e.push(c))}}catch(t){d=!0,u=t}finally{try{!l&&v.return&&v.return()}finally{if(d)throw u}}}}catch(t){a=!0,o=t}finally{try{!i&&n.return&&n.return()}finally{if(a)throw o}}e.length>0?(this.$refs.multipleTable.clearSelection(),setTimeout(function(){e.forEach(function(e){t.$refs.multipleTable.toggleRowSelection(e)})},100)):this.$refs.multipleTable.clearSelection()},sfInStockHeader:function(){var t=this.$createElement;return t("el-popover",{attrs:{placement:"top-start",width:"260",trigger:"hover"}},[t("div",[t("p",["1、顺丰标品设为顺丰仓现货时，下单会校验仓库库存；"]),t("p",["2、本来鲜生鲜品无需设置；"])]),t("span",{slot:"reference"},["是否为顺丰仓现货",t("i",{class:"el-icon-question"})])])},deleteGoodsItem:function(t){var e={scene:this.scene,row:t};this.$emit("deleteGoodsItem",e)}}},l={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{directives:[{name:"show",rawName:"v-show",value:t.tableData.length>0,expression:"tableData.length > 0"}]},[i("el-table",{ref:"multipleTable",staticClass:"fixed-height",staticStyle:{width:"100%"},attrs:{data:t.tableData,"empty-text":"暂无选中任何商品","max-height":"400",size:"small"},on:{select:t.handleSelect,"select-all":t.handleSelectAll}},[i("el-table-column",{attrs:{"min-width":"220px",label:"商品信息"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",{staticClass:"ll-p-m-w"},[i("div",{staticClass:"ll-img-w"},[e.row.imgUrl&&""!=e.row.imgUrl?i("img",{attrs:{src:e.row.imgUrl,alt:"",onerror:"onerror=null;src='/shop/static/img_error.png'"}}):i("img",{attrs:{src:"/shop/static/img_error.png",alt:""}})]),t._v(" "),i("div",{staticClass:"ll-p-m-c-r"},[i("div",[t._v("\n                "+t._s(e.row.goodsName||"--")+"\n              ")]),t._v(" "),i("div",{staticClass:"ll-erp-p-no"},[t._v("SKU编码："+t._s(e.row.goodsNo||"--"))])])])]}}])}),t._v(" "),i("el-table-column",{attrs:{"min-width":"100px",prop:"spec",label:"规格"}}),t._v(" "),i("el-table-column",{attrs:{"min-width":"130px",label:"活动商品名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",[i("el-input",{attrs:{disabled:e.row.disabled,size:"small",placeholder:"输入名称"},model:{value:e.row.activityGoodsName,callback:function(i){t.$set(e.row,"activityGoodsName",i)},expression:"scope.row.activityGoodsName"}})],1)]}}])}),t._v(" "),i("el-table-column",{attrs:{"min-width":"90px",prop:"price",label:"原价"}}),t._v(" "),i("el-table-column",{attrs:{"min-width":"110px",label:"活动价"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",[i("el-input",{attrs:{size:"small",placeholder:"输入价格",disabled:e.row.disabled},model:{value:e.row.groupPrice,callback:function(i){t.$set(e.row,"groupPrice",i)},expression:"scope.row.groupPrice"}})],1)]}}])}),t._v(" "),i("el-table-column",{attrs:{"min-width":"150px",label:"限购数量(为空不限)"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",[i("el-input",{attrs:{size:"small",placeholder:"输入限购数量",disabled:e.row.disabled},model:{value:e.row.limitGoodsCount,callback:function(i){t.$set(e.row,"limitGoodsCount",i)},expression:"scope.row.limitGoodsCount"}})],1)]}}])}),t._v(" "),i("el-table-column",{attrs:{"min-width":"110px",label:"活动库存"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",[i("el-input",{attrs:{size:"small",placeholder:"输入库存",disabled:e.row.disabled},model:{value:e.row.curStock,callback:function(i){t.$set(e.row,"curStock",i)},expression:"scope.row.curStock"}})],1)]}}])}),t._v(" "),i("el-table-column",{attrs:{"min-width":"110px",label:"排序权重"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",[i("el-input",{attrs:{size:"small",placeholder:"输入权重",disabled:e.row.disabled},model:{value:e.row.sortNum,callback:function(i){t.$set(e.row,"sortNum",i)},expression:"scope.row.sortNum"}})],1)]}}])}),t._v(" "),i("el-table-column",{attrs:{"min-width":"190px","render-header":t.sfInStockHeader},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",[i("el-radio",{attrs:{disabled:e.row.disabled,label:!0},model:{value:e.row.sfInStock,callback:function(i){t.$set(e.row,"sfInStock",i)},expression:"scope.row.sfInStock"}},[t._v("是")]),t._v(" "),i("el-radio",{attrs:{disabled:e.row.disabled,label:!1},model:{value:e.row.sfInStock,callback:function(i){t.$set(e.row,"sfInStock",i)},expression:"scope.row.sfInStock"}},[t._v("否")])],1)]}}])}),t._v(" "),i("el-table-column",{attrs:{align:"center",label:"操作",fixed:"right",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-delete",disabled:e.row.disabled},on:{click:function(i){return t.deleteGoodsItem(e.row)}}},[t._v("删除")])]}}])})],1),t._v(" "),t._m(0)],1)])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("span",{staticStyle:{color:"red"}},[this._v("*")]),this._v("注意：权重排序，先创建的活动商品在前；剩余的按前端规则走。\n    ")])}]},d=i("VU/8")(c,l,!1,null,null,null);e.a=d.exports},lGtR:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("Gu7T"),s=i.n(a),o=i("Dd8w"),r=i.n(o),n=i("BO1k"),c=i.n(n),l=i("oAV5"),d=i("8uth"),u=i("ssT3"),m=i("hR2Z"),v=i("VZ4h"),f=i("f6J0"),h=i("ylbZ"),p=i("enjp"),y="/plateform/a/preSale/goods/checkPreGoodsInsert",g="/plateform/a/activityRule/add",S=/^[1-9]*[1-9][0-9]*$/,k=/((^[1-9]\d*)|^0)(\.\d{0,2}){0,1}$/,b={data:function(){return{pickerOptions:{disabledDate:function(t){return t.getTime()<Date.now()-864e5}},isDisabled:!1,addParamMesg:{DIFFCITY:!0,platformId:5,regionCode:u.a.get("regionCode")||"",activityType:21,activityTypeName:"秒杀",activityName:"",activityStartDate:"",activityEndDate:"",activityCode:"",activityStoreList:[],activityStoreGroupList:[],activityScenes:[]},activeName:"first",scene:1,activityScenes:[{scene:1,activeName:"first",label:"第一场",activityStartTime:"",activityEndTime:"",platCityGoodsInfos:[],checkedList:[],discount:""},{scene:2,activeName:"second",label:"第二场",activityStartTime:"",activityEndTime:"",platCityGoodsInfos:[],checkedList:[],discount:""},{scene:3,activeName:"third",label:"第三场",activityStartTime:"",activityEndTime:"",platCityGoodsInfos:[],checkedList:[],discount:""},{scene:4,activeName:"fourth",label:"第四场",activityStartTime:"",activityEndTime:"",platCityGoodsInfos:[],checkedList:[],discount:""}],activityStoreGroupList:[{performanceDate:"",activityStoresCheckedList:[]}],tempConfig:{platformCityGoodsId:"区域商品id(必填)",goodsNo:"SKU编码(选填)",skuNo:"ERP商品编码(选填)",activityGoodsName:"活动商品名称(可修改，必填)",preSalePrice:"活动价(必填)",platformCurStock:"活动库存（必填）",limitCount:"每人每期限购(选填，为空时不限)",sortNum:"排序(必填)",sfInStockStr:"顺丰仓现货（选填，填是/否，空时为是）"},showTipErrorMsg:!1,hasErrorMsgData:[]}},components:{"choose-store":m.a,"choose-goods":v.a,"join-goods-table":f.a,region:h.a,"excel-add":p.a},methods:{chooseStoreOpen:function(t){var e={title:"选择门店",platformId:this.addParamMesg.platformId,regionCode:this.addParamMesg.regionCode,groupIndex:t,checkedList:this.activityStoreGroupList[t].activityStoresCheckedList,otherCheckedList:this.getCheckedStores(t)};this.$refs.chooseStore.setDefault(e)},chooseGoodsOpen:function(t){if(t.activityStartTime&&t.activityEndTime){var e={title:"选择商品",regionCode:this.addParamMesg.regionCode,checkedList:t.platCityGoodsInfos};this.$refs.chooseGoods.setDefault(e)}else this.$message.warning("请先选择本场次的开始时间和结束时间")},handleTabClick:function(t){"first"==t.name?this.scene=1:"second"==t.name?this.scene=2:"third"==t.name?this.scene=3:"fourth"==t.name&&(this.scene=4),this.activeName=t.name,this.setJoinGoodsMesg(this.scene)},setJoinGoodsMesg:function(t){var e=[],i=[],a=!0,s=!1,o=void 0;try{for(var r,n=c()(this.activityScenes);!(a=(r=n.next()).done);a=!0){var l=r.value;l.scene===t&&(e=l.platCityGoodsInfos,i=l.checkedList)}}catch(t){s=!0,o=t}finally{try{!a&&n.return&&n.return()}finally{if(s)throw o}}var d={scene:t,checkedList:i,tableData:e};this.$refs.joinGoodsTable.setDefaultMesg(d)},confirmChooseStore:function(t){var e=t.checkedList||[],i=t.groupIndex||0;this.activityStoreGroupList[i].activityStoresCheckedList=e},confirmChooseGoods:function(t){var e=[];e=t.checkedList&&t.checkedList.length?t.checkedList:[];var i=!0,a=!1,s=void 0;try{for(var o,r=c()(this.activityScenes);!(i=(o=r.next()).done);i=!0){var n=o.value;n.scene===this.scene&&(n.platCityGoodsInfos=e)}}catch(t){a=!0,s=t}finally{try{!i&&r.return&&r.return()}finally{if(a)throw s}}this.setJoinGoodsMesg(this.scene)},deleteStoreItem:function(t,e){var i=e.erpStoreNo,a=this.activityStoreGroupList[t].activityStoresCheckedList;this.activityStoreGroupList[t].activityStoresCheckedList=a.filter(function(t){return t.erpStoreNo!==i})},deleteGoodsItem:function(t){var e=(t.row?t.row:{}).platformCityGoodsId,i=t.scene?t.scene:"",a=!0,s=!1,o=void 0;try{for(var r,n=c()(this.activityScenes);!(a=(r=n.next()).done);a=!0){var l=r.value;l.scene===i&&(l.platCityGoodsInfos=l.platCityGoodsInfos.filter(function(t){return t.platformCityGoodsId!==e}))}}catch(t){s=!0,o=t}finally{try{!a&&n.return&&n.return()}finally{if(s)throw o}}this.setJoinGoodsMesg(i)},setDefaultChecked:function(t){var e=t.checkedList?t.checkedList:{},i=t.scene?t.scene:"",a=!0,s=!1,o=void 0;try{for(var r,n=c()(this.activityScenes);!(a=(r=n.next()).done);a=!0){var l=r.value;l.scene===i&&(l.checkedList=e)}}catch(t){s=!0,o=t}finally{try{!a&&n.return&&n.return()}finally{if(s)throw o}}},setDiscountBatch:function(t){var e=!0,i=!1,a=void 0;try{for(var s,o=c()(this.activityScenes);!(e=(s=o.next()).done);e=!0){var r=s.value;if(r.scene===t){if(!r.discount)return void this.$message("请输入拼团价折扣");if(!S.test(r.discount))return void this.$message("拼团价折扣为(0-100整数)");if(0===r.checkedList.length)return void this.$message("请选择商品");var n=!0,l=!1,d=void 0;try{for(var u,m=c()(r.platCityGoodsInfos);!(n=(u=m.next()).done);n=!0){var v=u.value,f=!0,h=!1,p=void 0;try{for(var y,g=c()(r.checkedList);!(f=(y=g.next()).done);f=!0){var k=y.value;v.platformCityGoodsId===k.platformCityGoodsId&&(v.groupPrice=(parseFloat(r.discount)*parseFloat(v.price)/100).toFixed(2))}}catch(t){h=!0,p=t}finally{try{!f&&g.return&&g.return()}finally{if(h)throw p}}}}catch(t){l=!0,d=t}finally{try{!n&&m.return&&m.return()}finally{if(l)throw d}}r.checkedList=[]}}}catch(t){i=!0,a=t}finally{try{!e&&o.return&&o.return()}finally{if(i)throw a}}this.setJoinGoodsMesg(t)},doSaveHandel:function(){var t=this;if(this.addParamMesg.activityName)if(this.addParamMesg.activityName.length>30)this.$message("活动名称限制30个汉字");else if(this.addParamMesg.activityStartDate)if(this.addParamMesg.activityEndDate){this.addParamMesg.activityStartDate.substr(11)||(this.addParamMesg.activityStartDate=this.addParamMesg.activityStartDate+" 00:00:00"),this.addParamMesg.activityEndDate.substr(11)||(this.addParamMesg.activityEndDate=this.addParamMesg.activityEndDate+" 23:59:59");var e=Date.parse(new Date(this.addParamMesg.activityStartDate.replace(/\-/g,"/"))),i=Date.parse(new Date(this.addParamMesg.activityEndDate.replace(/\-/g,"/")));if(i<(new Date).getTime())this.$message("活动结束时间不能早于当前时间");else if(e>i)this.$message("活动结束时间不能早于开始时间");else{this.addParamMesg.activityStoreGroupList=this.activityStoreGroupList.map(function(t,e){return{index:e,performanceDate:t.performanceDate,storeNoList:t.activityStoresCheckedList.map(function(t){return t.erpStoreNo})}});var a=!0,s=!1,o=void 0;try{for(var n,d=c()(this.addParamMesg.activityStoreGroupList);!(a=(n=d.next()).done);a=!0){var u=n.value;if(!u.storeNoList||!u.storeNoList.length)return void this.$message("请选择参与门店/履约时间组中【第"+(u.index+1)+"组】的参与门店");if(!u.performanceDate)return void this.$message("请选择参与门店/履约时间组中【第"+(u.index+1)+"组】的履约时间");if(i>Date.parse(new Date((u.performanceDate+" 23:59:59").replace(/\-/g,"/"))))return void this.$message("参与门店/履约时间组中【第"+(u.index+1)+"组】的履约时间不能早于活动结束时间");u.performanceDatetime=u.performanceDate+" 23:59:59"}}catch(t){s=!0,o=t}finally{try{!a&&d.return&&d.return()}finally{if(s)throw o}}this.addParamMesg.activityStoreList=this.getCheckedStores().map(function(t){return t.erpStoreNo});var m="",v=[],f=!0,h=!1,p=void 0;try{for(var y,b=c()(this.activityScenes);!(f=(y=b.next()).done);f=!0){var C=y.value;if(1===C.scene?m="第一场":2===C.scene?m="第二场":3===C.scene?m="第三场":4===C.scene&&(m="第四场"),C.activityStartTime||(C.activityStartTime=""),C.activityEndTime||(C.activityEndTime=""),C.platCityGoodsInfos&&C.platCityGoodsInfos.length){if(!C.activityStartTime||!C.activityEndTime)return void this.$message("请选择【"+m+"】的开始时间和结束时间");if(l.b(C.activityEndTime)<=l.b(C.activityStartTime))return void this.$message("请选择【"+m+"】的结束时间必须晚于开始时间");var _=!0,w=!1,G=void 0;try{for(var D,x=c()(C.platCityGoodsInfos);!(_=(D=x.next()).done);_=!0){var M=D.value;if(!M.goodsName)return void this.$message("请输入【"+m+"】中("+M.goodsName+")的活动商品名称");if(!M.groupPrice)return void this.$message("请输入【"+m+"】中("+M.goodsName+")的活动价");if(!k.test(M.groupPrice))return void this.$message("【"+m+"】中("+M.goodsName+")的活动价是大于0，小数保留小数点后2位");if("0.00"==parseFloat(M.groupPrice))return void this.$message("【"+m+"】中("+M.goodsName+")的活动价是大于0，小数保留小数点后2位");if(parseFloat(M.groupPrice)>M.price)return void this.$message("【"+m+"】中("+M.goodsName+")的活动价必须小于或等于原价");if(M.limitGoodsCount&&!S.test(M.limitGoodsCount))return void this.$message("【"+m+"】中("+M.goodsName+")的限购数量为大于零的正整数");if(!M.curStock)return void this.$message("请输入【"+m+"】中("+M.goodsName+")的活动库存");if(!S.test(M.curStock))return void this.$message("【"+m+"】中("+M.goodsName+")的活动库存为大于零的正整数");if(!M.sortNum)return void this.$message("请输入【"+m+"】中("+M.goodsName+")的排序权重");if(!S.test(M.sortNum))return void this.$message("【"+m+"】中("+M.goodsName+")的排序权重为1—100正整数");if(M.sortNum<1||M.sortNum>100)return void this.$message("【"+m+"】中("+M.goodsName+")的排序权重为1—100正整数");M.activityStartDate=this.addParamMesg.activityStartDate,M.activityEndDate=this.addParamMesg.activityEndDate,M.activityStartTime=C.activityStartTime,M.activityEndTime=C.activityEndTime}}catch(t){w=!0,G=t}finally{try{!_&&x.return&&x.return()}finally{if(w)throw G}}v.push(C)}}}catch(t){h=!0,p=t}finally{try{!f&&b.return&&b.return()}finally{if(h)throw p}}var T=[],$=[],L=!0,N=!1,I=void 0;try{for(var E,P=c()(v);!(L=(E=P.next()).done);L=!0){var z=E.value;T.push(l.b(z.activityStartTime)),$.push(l.b(z.activityEndTime))}}catch(t){N=!0,I=t}finally{try{!L&&P.return&&P.return()}finally{if(N)throw I}}l.d(T,$)?(this.addParamMesg.activityScenes=[].concat(v),0!==this.addParamMesg.activityScenes.length?(this.isDisabled=!0,this.$http.post(g,r()({},this.addParamMesg)).then(function(e){if(setTimeout(function(){t.isDisabled=!1},800),0===e.code)return t.$message.success("保存成功"),void t.$router.push("/store_act");throw new Error(e.msg)}).catch(function(e){t.isDisabled=!1,t.$notify.error({title:"提示",message:e.message})})):this.$message("请选择参与商品")):this.$message("活动各场次的开始时间和结束时间有冲突")}}else this.$message("请输入活动结束时间");else this.$message("请输入活动开始时间");else this.$message("请输入活动名称")},doCancelHandel:function(){var t=this;this.$confirm("确定取消吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$router.push("/store_act")}).catch(function(){})},doAddStoreGroupHandel:function(){this.activityStoreGroupList.push({performanceDate:"",activityStoresCheckedList:[]})},doMinusStoreGroupHandel:function(t){this.activityStoreGroupList.splice(t,1)},getCheckedStores:function(t){var e=[];return t||0===t?this.activityStoreGroupList.forEach(function(i,a){a!=t&&(e=[].concat(s()(e),s()(i.activityStoresCheckedList)))}):this.activityStoreGroupList.forEach(function(t){e=[].concat(s()(e),s()(t.activityStoresCheckedList))}),e},showExcelBatchInsertDialog:function(t){if(t.activityStartTime&&t.activityEndTime){if(this.$refs.excelAdd){var e={title:"Excel 批量导入",tempConfig:this.tempConfig};this.$refs.excelAdd.setDefaultMsg(e)}}else this.$message.warning("请先选择本场次的开始时间和结束时间")},doConfirmHandel:function(t){var e=this,i=t.dataList||[];i.forEach(function(t){t.activityType=21}),this.$http.post(y,[].concat(s()(i))).then(function(t){if(e.$refs.excelAdd.closeDisabled(),e.$refs.excelAdd.closeDialog(),0!==t.code)throw new Error(t.msg);if(e.hasErrorMsgData=t.data&&t.data.length?t.data:[],e.hasErrorMsgData.forEach(function(t){t.groupPrice=t.preSalePrice,t.curStock=t.platformCurStock,t.limitGoodsCount=t.limitCount}),e.hasErrorMsgData.some(function(t){return 1===t.msgType}))e.showTipErrorMsg=!0;else{var i=[].concat(s()(e.activityScenes[e.scene-1].platCityGoodsInfos));i.forEach(function(t){e.hasErrorMsgData.forEach(function(e){t.goodsId===e.goodsId&&t.goodsNo===e.goodsNo&&t.platformCityGoodsId===e.platformCityGoodsId&&t.skuNo===e.skuNo&&(t.activityGoodsName=e.activityGoodsName,t.groupPrice=e.groupPrice,t.curStock=e.curStock,t.limitGoodsCount=e.limitGoodsCount,t.sortNum=e.sortNum,t.sfInStock=e.sfInStock)})});var a={};e.activityScenes[e.scene-1].platCityGoodsInfos=[].concat(s()(i),s()(e.hasErrorMsgData)).reduceRight(function(t,e){return!a[e.platformCityGoodsId]&&(a[e.platformCityGoodsId]=t.push(e)),t},[]),e.setJoinGoodsMesg(e.scene)}}).catch(function(t){e.$refs.excelAdd.closeDisabled(),e.$refs.excelAdd.closeDialog(),e.$notify.error({title:"提示",message:t.message})})},downLoadErrorMsg:function(){var t=this,e=r()({},this.tempConfig);e.msgTypeStr="验证结果",e.msg="失败原因",this.hasErrorMsgData.forEach(function(t){t.msgTypeStr=1===t.msgType?"验证失败":"验证成功",t.sfInStockStr=t.sfInStock?"是":"否"});var i=l.o(e,!1),a=l.o(e,!0);d.a.ExportJsonToExcel({header:i,filterVal:a,data:this.hasErrorMsgData,filename:"Excel批量导入模板"}),setTimeout(function(){t.$notify.success({title:"温馨提示",message:"Excel批量导入模板下载成功"}),t.isDisabled=!1},500)}}},C={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"add-form-wraper"},[i("el-form",{ref:"form",attrs:{model:t.addParamMesg,"label-width":"140px"}},[i("el-form-item",{attrs:{label:"活动类型",required:""}},[i("p",{staticStyle:{color:"#222","font-size":"16px","font-weight":"bold"}},[t._v(t._s(t.addParamMesg.activityTypeName))])]),t._v(" "),i("region",{staticClass:"region-wrap",attrs:{className:"add-input",label:"选择区域",required:!0}}),t._v(" "),i("el-form-item",{attrs:{label:"活动名称",required:""}},[i("el-input",{staticClass:"add-input",attrs:{size:"small",placeholder:"请输入活动名称",clearable:""},model:{value:t.addParamMesg.activityName,callback:function(e){t.$set(t.addParamMesg,"activityName",e)},expression:"addParamMesg.activityName"}}),t._v(" "),i("span",[t._v("活动名称,限制30个汉字")])],1),t._v(" "),i("el-form-item",{attrs:{label:"开始时间",required:""}},[i("el-date-picker",{staticClass:"add-input",attrs:{type:"date",placeholder:"请选择活动开始时间",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",size:"small","picker-options":t.pickerOptions},model:{value:t.addParamMesg.activityStartDate,callback:function(e){t.$set(t.addParamMesg,"activityStartDate",e)},expression:"addParamMesg.activityStartDate"}}),t._v(" "),i("span",[t._v("活动开始时间")])],1),t._v(" "),i("el-form-item",{attrs:{label:"结束时间",required:""}},[i("el-date-picker",{staticClass:"add-input",attrs:{type:"date",placeholder:"请选择活动结束时间",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",size:"small","picker-options":t.pickerOptions},model:{value:t.addParamMesg.activityEndDate,callback:function(e){t.$set(t.addParamMesg,"activityEndDate",e)},expression:"addParamMesg.activityEndDate"}}),t._v(" "),i("span",[t._v("活动结束时间")])],1),t._v(" "),i("el-form-item",{attrs:{label:"门店/履约时间",required:""}},t._l(t.activityStoreGroupList,function(e,a){return i("div",{key:a,staticClass:"store-pre-time-item-wrap",class:a>0?"mt10":null},[i("div",{staticClass:"item-right"},[i("div",[i("span",[t._v("参与门店")]),t._v(" "),i("el-button",{attrs:{size:"small",icon:"el-icon-plus"},on:{click:function(e){return t.chooseStoreOpen(a)}}},[t._v("选择门店")]),t._v(" "),e.activityStoresCheckedList.length>0?i("div",[i("el-table",{staticClass:"fixed-height",attrs:{data:e.activityStoresCheckedList,"empty-text":"暂无选中任何门店","max-height":"250",size:"small"}},[i("el-table-column",{attrs:{"min-width":"220px",label:"门店编码/名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",[t._v("\n                        "+t._s(e.row.erpStoreNo)+"_"+t._s(e.row.erpStoreName)+"\n                      ")])]}}],null,!0)}),t._v(" "),i("el-table-column",{attrs:{"min-width":"80",prop:"cityName",label:"城市"}}),t._v(" "),i("el-table-column",{attrs:{"min-width":"80",prop:"saleTypeName",label:"门店类型"}}),t._v(" "),i("el-table-column",{attrs:{align:"center",label:"操作",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-delete"},on:{click:function(i){return t.deleteStoreItem(a,e.row)}}},[t._v("删除")])]}}],null,!0)})],1)],1):t._e()],1),t._v(" "),i("div",{staticClass:"mt10"},[i("span",[t._v("履约时间")]),t._v(" "),i("el-date-picker",{staticClass:"search-input",attrs:{type:"date",placeholder:"请选择履约时间",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",size:"small","picker-options":t.pickerOptions},model:{value:e.performanceDate,callback:function(i){t.$set(e,"performanceDate",i)},expression:"item.performanceDate"}}),t._v(" "),i("span",[t._v("门店仅支持自提则为自提时间")])],1)]),t._v(" "),i("div",{staticClass:"item-left"},[i("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-plus",circle:""},on:{click:t.doAddStoreGroupHandel}}),t._v("\n             \n            "),t.activityStoreGroupList.length>1?i("el-button",{attrs:{size:"mini",icon:"el-icon-minus",circle:""},on:{click:function(e){return t.doMinusStoreGroupHandel(a)}}}):t._e()],1)])}),0),t._v(" "),i("el-form-item",{attrs:{label:"参与商品",required:""}},[i("el-tabs",{on:{"tab-click":t.handleTabClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[t._l(t.activityScenes,function(e,a){return i("el-tab-pane",{key:a,attrs:{name:e.activeName}},[i("span",{attrs:{slot:"label"},slot:"label"},[t._v("\n              "+t._s(e.label)+" \n              "),e.activityStartTime&&e.activityEndTime?i("span",[t._v("\n                "+t._s(e.activityStartTime)+"-"+t._s(e.activityEndTime)+"\n              ")]):t._e()]),t._v(" "),i("span",[t._v("\n              开始时间:\n            ")]),t._v(" "),i("el-time-picker",{staticClass:"add-input-inline",attrs:{format:"HH:mm","value-format":"HH:mm",size:"small",clearable:"",placeholder:"开始时间"},model:{value:e.activityStartTime,callback:function(i){t.$set(e,"activityStartTime",i)},expression:"item.activityStartTime"}}),t._v(" "),i("span",[t._v("\n              结束时间:\n            ")]),t._v(" "),i("el-time-picker",{staticClass:"add-input-inline",attrs:{format:"HH:mm","value-format":"HH:mm",size:"small",clearable:"",placeholder:"结束时间","picker-options":t.pickerOptions},model:{value:e.activityEndTime,callback:function(i){t.$set(e,"activityEndTime",i)},expression:"item.activityEndTime"}}),t._v(" "),i("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-plus"},on:{click:function(i){return t.chooseGoodsOpen(e)}}},[t._v("选择商品")]),t._v(" "),i("el-button",{attrs:{size:"mini",icon:"el-icon-plus"},on:{click:function(i){return t.showExcelBatchInsertDialog(e)}}},[t._v("Excel批量导入")])],1)}),t._v(" "),i("join-goods-table",{ref:"joinGoodsTable",on:{deleteGoodsItem:t.deleteGoodsItem,setDefaultChecked:t.setDefaultChecked}})],2)],1),t._v(" "),i("hr",{staticClass:"s-slip-tb"}),t._v(" "),i("el-form-item",[i("el-button",{attrs:{type:"primary",size:"small",disabled:t.isDisabled},on:{click:t.doSaveHandel}},[t._v("保存")]),t._v(" "),i("el-button",{attrs:{size:"small"},on:{click:t.doCancelHandel}},[t._v("取消")])],1)],1)],1),t._v(" "),i("choose-store",{ref:"chooseStore",on:{confirmChooseStore:t.confirmChooseStore}}),t._v(" "),i("choose-goods",{ref:"chooseGoods",on:{confirmChooseGoods:t.confirmChooseGoods}}),t._v(" "),i("excel-add",{ref:"excelAdd",on:{doConfirmHandel:t.doConfirmHandel}}),t._v(" "),i("el-dialog",{attrs:{title:"批量导入失败",visible:t.showTipErrorMsg,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"450px"},on:{"update:visible":function(e){t.showTipErrorMsg=e}}},[i("div",[t._v("\n      部分商品不符合要求，请按要求修改后再重新导入。"),i("el-button",{attrs:{type:"text",size:"mini"},on:{click:t.downLoadErrorMsg}},[t._v("下载查看失败原因")])],1),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"mini"},on:{click:function(e){t.showTipErrorMsg=!1}}},[t._v("关 闭")])],1)])],1)},staticRenderFns:[]};var _=i("VU/8")(b,C,!1,function(t){i("K975")},null,null);e.default=_.exports}});
//# sourceMappingURL=28.614f2134661b1d70dca5.js.map