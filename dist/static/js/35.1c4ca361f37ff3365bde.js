webpackJsonp([35],{ZyFy:function(t,e){},aDhs:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=a("BO1k"),r=a.n(o),s=a("Dd8w"),i=a.n(s),n=(a("ssT3"),a("oAV5")),l=a("Gu7T"),c=a.n(l),d=a("d7hP"),u="/plateform/a/category/getCategoryTree",h="/plateform/a/mall/pageTemp/selectPageGoodsList",m="/plateform/a/mall/recommend/saveRecommend",p={data:function(){return{isDisabled:!1,isShow:!1,title:"选择商品",loading:!1,pageNum:1,pageSize:10,total:0,searchContent:{queryString:"",platformCityGoodsIds:[],platformId:5,saleType:3,categoryIdList:[],categoryId:""},tableData:[],cateDefaultProps:{children:"categoryVoList",label:"categoryName",value:"categoryId"},categoryList:[],checkedList:[]}},components:{"goods-select-for-dialog":d.a},methods:{setDefault:function(t){var e=this;t&&(this.title=t.title,this.checkedList=[]),this.isShow=!0,this.getCategoryId(),this.doSearchHandel(!0),setTimeout(function(){e.goodsSelectForDialogInit()},200)},getCategoryId:function(){var t=this;this.$http.post(u).then(function(e){if(0!==e.code)throw new Error(e.msg);if(e.data&&e.data.length){var a=!0,o=!1,s=void 0;try{for(var i,n=r()(e.data);!(a=(i=n.next()).done);a=!0){var l=i.value;l.categoryVoList&&0===l.categoryVoList.length&&(l.categoryVoList=null)}}catch(t){o=!0,s=t}finally{try{!a&&n.return&&n.return()}finally{if(o)throw s}}t.categoryList=e.data}else t.categoryList=[]}).catch(function(t){console.log("提示(三方平台店内分类):",t.message)})},presaleStatusFormatter:function(t,e,a,o){return 0===a?"已失效":1===a?"未开始":2===a?"进行中":3===a?"售罄":void 0},changeSize:function(t){this.pageSize=t,this.doSearchHandel()},changeCurrent:function(t){this.pageNum=t,this.doSearchHandel()},doSearchHandel:function(t){var e=this,a=this.searchContent.categoryIdList.length-1;this.searchContent.categoryId=this.searchContent.categoryIdList[a],this.loading=!0,!0===t&&(this.pageNum=1),this.$http.post(h,i()({},this.searchContent,{pageNum:this.pageNum,pageSize:this.pageSize})).then(function(t){if(e.loading=!1,0===t.code){if(t.data&&t.data.result&&t.data.result.length){var a=!0,o=!1,s=void 0;try{for(var i,n=r()(t.data.result);!(a=(i=n.next()).done);a=!0){var l=i.value;l.uniqueId=l.platformCityGoodsId+""+l.skuNo}}catch(t){o=!0,s=t}finally{try{!a&&n.return&&n.return()}finally{if(o)throw s}}e.tableData=t.data.result}else e.tableData=[];return 1==e.pageNum&&(e.total=t.data.total),void e.defauleSelectFun()}throw new Error(t.msg)}).catch(function(t){e.loading=!1,e.$notify.error({title:"提示",message:t.message})})},handleSelect:function(t,e){var a={},o=[];if(n.m(e.uniqueId,"uniqueId",this.checkedList))this.checkedList=n.q("uniqueId",e.uniqueId,this.checkedList);else{o.push(e);var r=[].concat(o,c()(this.checkedList));this.checkedList=r.reduceRight(function(t,e){return!a[e.uniqueId]&&(a[e.uniqueId]=t.push(e)),t},[])}},handleSelectAll:function(t){var e={};if(t.length>0){var a=!0,o=!1,s=void 0;try{for(var i,l=r()(t);!(a=(i=l.next()).done);a=!0){var c=i.value;this.checkedList.push(c)}}catch(t){o=!0,s=t}finally{try{!a&&l.return&&l.return()}finally{if(o)throw s}}this.checkedList=this.checkedList.reduceRight(function(t,a){return!e[a.uniqueId]&&(e[a.uniqueId]=t.push(a)),t},[])}else{var d=[],u=!0,h=!1,m=void 0;try{for(var p,f=r()(this.tableData);!(u=(p=f.next()).done);u=!0){var g=p.value;d.push(g)}}catch(t){h=!0,m=t}finally{try{!u&&f.return&&f.return()}finally{if(h)throw m}}var v=n.i(this.checkedList,d,"uniqueId");this.checkedList=v&&v.length>0?v:[]}},doConfirmHandel:function(){var t=this,e=[],a=!0,o=!1,s=void 0;try{for(var i,n=r()(this.checkedList);!(a=(i=n.next()).done);a=!0){var l=i.value;e.push(l.platformCityGoodsId)}}catch(t){o=!0,s=t}finally{try{!a&&n.return&&n.return()}finally{if(o)throw s}}var c={plateformCityGoodsIds:e,platformId:5};this.isDisabled=!0,this.$http.post(m,c).then(function(e){if(setTimeout(function(){t.isDisabled=!1},800),0===e.code)return t.$message.success("导入成功"),t.$emit("importGoodsSuccess"),void(t.isShow=!1);throw new Error(e.msg)}).catch(function(e){t.isDisabled=!1,t.$notify.error({title:"提示",message:e.message})})},defauleSelectFun:function(){var t=this,e=[],a=!0,o=!1,s=void 0;try{for(var i,n=r()(this.tableData);!(a=(i=n.next()).done);a=!0){var l=i.value,c=!0,d=!1,u=void 0;try{for(var h,m=r()(this.checkedList);!(c=(h=m.next()).done);c=!0){var p=h.value;l.uniqueId==p.uniqueId&&e.push(l)}}catch(t){d=!0,u=t}finally{try{!c&&m.return&&m.return()}finally{if(d)throw u}}}}catch(t){o=!0,s=t}finally{try{!a&&n.return&&n.return()}finally{if(o)throw s}}e.length>0?(this.$refs.multipleTable.clearSelection(),setTimeout(function(){e.forEach(function(e){t.$refs.multipleTable.toggleRowSelection(e)})},100)):this.$refs.multipleTable.clearSelection()},doCategorysChangeHandel:function(){this.goodsSelectForDialogInit(),this.doSearchHandel(!0)},goodsSelectForDialogInit:function(){if(this.$refs.GoodsSelectForDialog){var t={queryString:this.searchContent.queryString,categoryIdList:this.searchContent.categoryIdList,saleType:this.searchContent.saleType,platformId:this.searchContent.platformId,platformCityGoodsIds:this.searchContent.platformCityGoodsIds};this.$refs.GoodsSelectForDialog.setDefaultMesg(t)}},DoSelectGoodsHandel:function(t){var e=t.checkedList,a=t.queryString,o=[],s=!0,i=!1,n=void 0;try{for(var l,c=r()(e);!(s=(l=c.next()).done);s=!0){var d=l.value;o.push(d.platformCityGoodsId)}}catch(t){i=!0,n=t}finally{try{!s&&c.return&&c.return()}finally{if(i)throw n}}this.searchContent.platformCityGoodsIds=o,this.searchContent.queryString=a,this.doSearchHandel(!0)}}},f={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-dialog",{attrs:{title:t.title,visible:t.isShow,width:"720px"},on:{"update:visible":function(e){t.isShow=e}}},[a("div",{staticClass:"search-form-wraper c-g-sfw"},[a("el-form",{attrs:{model:t.searchContent,"label-position":"top"}},[a("el-form-item",[a("el-cascader",{staticClass:"search-input",attrs:{placeholder:"请选择分类",options:t.categoryList,"change-on-select":"",size:"small",clearable:"",filterable:"",props:t.cateDefaultProps},on:{change:t.doCategorysChangeHandel},model:{value:t.searchContent.categoryIdList,callback:function(e){t.$set(t.searchContent,"categoryIdList",e)},expression:"searchContent.categoryIdList"}})],1),t._v(" "),a("el-form-item",[a("goods-select-for-dialog",{ref:"GoodsSelectForDialog",on:{DoSelectGoodsHandel:t.DoSelectGoodsHandel}})],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.doSearchHandel(!0)}}},[t._v("搜索")])],1)],1)],1),t._v(" "),a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"multipleTable",staticClass:"fixed-height",staticStyle:{width:"100%"},attrs:{data:t.tableData,"empty-text":"没有查询到您想要的数据",height:"300",size:"small"},on:{select:t.handleSelect,"select-all":t.handleSelectAll}},[a("el-table-column",{attrs:{type:"selection",width:"50"}}),t._v(" "),a("el-table-column",{attrs:{"min-width":"226px",label:"商品信息"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"ll-p-m-w"},[a("div",{staticClass:"ll-img-w"},[e.row.imgUrl&&""!=e.row.imgUrl?a("img",{attrs:{src:e.row.imgUrl,alt:"",onerror:"onerror=null;src='/shop/static/img_error.png'"}}):a("img",{attrs:{src:"/shop/static/img_error.png",alt:""}})]),t._v(" "),a("div",{staticClass:"ll-p-m-c-r"},[a("div",[t._v(t._s(e.row.goodsName||"-"))]),t._v(" "),a("div",{staticClass:"ll-erp-p-no"},[t._v("SKU编码："+t._s(e.row.goodsNo||"--"))]),t._v(" "),a("div",{staticClass:"ll-erp-p-no"},[t._v("商品ID："+t._s(e.row.platformCityGoodsId||"--"))])])])]}}])}),t._v(" "),a("el-table-column",{attrs:{"min-width":"100px",prop:"presalePrice",label:"预售价"}}),t._v(" "),a("el-table-column",{attrs:{"min-width":"180px",label:"预售时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[a("p",[t._v(t._s(e.row.presaleStartDate)+"-"+t._s(e.row.presaleEndDate))]),t._v(" "),a("p",[t._v(t._s(e.row.presaleStartTime)+"-"+t._s(e.row.presaleEndTime))])])]}}])}),t._v(" "),a("el-table-column",{attrs:{"min-width":"100px",prop:"presaleStatus",label:"状态",formatter:t.presaleStatusFormatter}})],1),t._v(" "),a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:t.tableData.length>0,expression:"tableData.length>0"}],staticClass:"tc mt20",attrs:{background:"","current-page":t.pageNum,"page-sizes":[10,50,100,150,200],layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.changeSize,"current-change":t.changeCurrent,"update:currentPage":function(e){t.pageNum=e},"update:current-page":function(e){t.pageNum=e}}})],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"mini"},on:{click:function(e){t.isShow=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary",size:"mini",disabled:t.isDisabled},on:{click:t.doConfirmHandel}},[t._v("导 入")])],1)])],1)},staticRenderFns:[]};var g="/plateform/a/mall/recommend/delRecommend",v="/plateform/a/mall/recommend/recommendList",y="/plateform/a/mall/recommend/recommendSort",S={data:function(){return{loading:!1,pageNum:1,pageSize:10,total:0,searchContent:{queryString:"",platformId:5,recommendType:3,platformCityGoodsIds:[],startCreateTime:"",endCreateTime:""},tableData:[]}},mounted:function(){this.doSearchHandel(!0),this.goodsSelectInit()},components:{"choose-goods":a("VU/8")(p,f,!1,function(t){a("ZyFy")},null,null).exports,"goods-select":d.a},methods:{imortGoods:function(){this.$refs.chooseGoods.setDefault({title:"选择商品"})},presaleStatusFormatter:function(t,e,a,o){return 0===a?"已失效":1===a?"未开始":2===a?"进行中":3===a?"售罄":void 0},changeSize:function(t){this.pageSize=t,this.doSearchHandel()},changeCurrent:function(t){this.pageNum=t,this.doSearchHandel()},doSearchHandel:function(t){var e=this;this.loading=!0,!0===t&&(this.pageNum=1),this.$http.post(v,i()({},this.searchContent,{pageNum:this.pageNum,pageSize:this.pageSize})).then(function(t){if(e.loading=!1,0!==t.code)throw new Error(t.msg);if(t.data&&t.data.result&&t.data.result.length){var a=!0,o=!1,s=void 0;try{for(var i,n=r()(t.data.result);!(a=(i=n.next()).done);a=!0){var l=i.value;l.showUpdate=!1,l.updateSortNum=l.sortNum}}catch(t){o=!0,s=t}finally{try{!a&&n.return&&n.return()}finally{if(o)throw s}}e.tableData=t.data.result}else e.tableData=[];1==e.pageNum&&(e.total=t.data.total)}).catch(function(t){e.loading=!1,e.$notify.error({title:"提示",message:t.message})})},deleteItem:function(t){var e=this,a=[],o=t.id;a.push(o);var r={isDeleted:1,recommendIds:a};this.$confirm("您确定要移除所选商品吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$http.post(g,r).then(function(t){if(0===t.code)return e.$message.success("移除成功"),void e.doSearchHandel();throw new Error(t.msg)}).catch(function(t){e.$notify.error({title:"提示",message:t.message})})}).catch(function(){})},deleteSortNum:function(t,e){var a=this;setTimeout(function(){a.tableData[t].updateSortNum=a.tableData[t].sortNum,a.tableData[t].showUpdate=!1},500)},modifySortNum:function(t,e){1!=e.showUpdate&&(this.tableData[t].showUpdate=!0)},sureUpdataSortNum:function(t){var e=this,a=parseInt(t.updateSortNum);if(a||0==a){0==a?a=0:/^[1-9]*[1-9][0-9]*$/.test(a)||this.$message("序号为数字");var o={recommendId:t.id,sortNum:a};this.$http.post(y,o).then(function(t){if(0===t.code)return e.$message.success("修改成功"),void e.doSearchHandel();throw new Error(t.msg)}).catch(function(t){e.$notify.error({title:"提示",message:t.message})})}else this.$message("请输入序号")},goodsSelectInit:function(){if(this.$refs.GoodsSelect){var t={queryString:this.searchContent.queryString,categoryIdList:this.searchContent.categoryIdList,saleType:this.searchContent.recommendType,platformId:this.searchContent.platformId,platformCityGoodsIds:this.searchContent.platformCityGoodsIds};this.$refs.GoodsSelect.setDefaultMesg(t)}},DoSelectGoodsHandel:function(t){var e=t.checkedList,a=t.queryString,o=[],s=!0,i=!1,n=void 0;try{for(var l,c=r()(e);!(s=(l=c.next()).done);s=!0){var d=l.value;o.push(d.platformCityGoodsId)}}catch(t){i=!0,n=t}finally{try{!s&&c.return&&c.return()}finally{if(i)throw n}}this.searchContent.platformCityGoodsIds=o,this.searchContent.queryString=a,this.doSearchHandel(!0)}}},w={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"handel-search-wraper"},[a("div",{staticClass:"handel-wraper"},[a("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-plus"},on:{click:t.imortGoods}},[t._v("导入商品")])],1),t._v(" "),a("hr",{staticClass:"s-slip"}),t._v(" "),a("div",{staticClass:"search-form-wraper"},[a("el-form",{attrs:{model:t.searchContent,"label-position":"top"}},[a("el-form-item",{attrs:{label:"SKU编码/商品名称"}},[a("goods-select",{ref:"GoodsSelect",on:{DoSelectGoodsHandel:t.DoSelectGoodsHandel}})],1),t._v(" "),a("el-form-item",{attrs:{label:"导入开始时间"}},[a("el-date-picker",{staticClass:"search-input",attrs:{type:"date",placeholder:"导入开始时间",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",size:"small"},on:{change:function(e){return t.doSearchHandel(!0)}},model:{value:t.searchContent.startCreateTime,callback:function(e){t.$set(t.searchContent,"startCreateTime",e)},expression:"searchContent.startCreateTime"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"导入结束时间"}},[a("el-date-picker",{staticClass:"search-input",attrs:{type:"date",placeholder:"导入结束时间",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",size:"small"},on:{change:function(e){return t.doSearchHandel(!0)}},model:{value:t.searchContent.endCreateTime,callback:function(e){t.$set(t.searchContent,"endCreateTime",e)},expression:"searchContent.endCreateTime"}})],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.doSearchHandel(!0)}}},[t._v("搜索")])],1)],1)],1)]),t._v(" "),a("div",{staticClass:"table-wraper"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"fixed-height",staticStyle:{width:"100%"},attrs:{data:t.tableData,"empty-text":"没有查询到您想要的数据",size:"small"}},[a("el-table-column",{attrs:{"min-width":"236px",label:"商品信息"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"p-m-w"},[a("div",{staticClass:"img-w"},[e.row.imgUrl&&""!=e.row.imgUrl?a("img",{attrs:{src:e.row.imgUrl,alt:"",onerror:"onerror=null;src='/shop/static/img_error.png'"}}):a("img",{attrs:{src:"/shop/static/img_error.png",alt:""}})]),t._v(" "),a("div",{staticClass:"p-m-c-r"},[a("div",[t._v(t._s(e.row.goodsName||"--"))]),t._v(" "),a("div",{staticClass:"erp-p-no"},[t._v("SKU编码："+t._s(e.row.goodsNO||"--"))]),t._v(" "),a("div",{staticClass:"erp-p-no"},[t._v("商品ID："+t._s(e.row.recommendGoodsId||"--"))])])])]}}])}),t._v(" "),a("el-table-column",{attrs:{"min-width":"120px",prop:"spec",label:"规格"}}),t._v(" "),a("el-table-column",{attrs:{"min-width":"100px",prop:"price",label:"原价"}}),t._v(" "),a("el-table-column",{attrs:{"min-width":"100px",prop:"presalePrice",label:"预售价"}}),t._v(" "),a("el-table-column",{attrs:{"min-width":"180px",label:"预售时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[a("p",[t._v(t._s(e.row.presaleStartDate)+"-"+t._s(e.row.presaleEndDate))]),t._v(" "),a("p",[t._v(t._s(e.row.presaleStartTime)+"-"+t._s(e.row.presaleEndTime))])])]}}])}),t._v(" "),a("el-table-column",{attrs:{"min-width":"120px",prop:"presaleStatus",label:"状态",formatter:t.presaleStatusFormatter}}),t._v(" "),a("el-table-column",{attrs:{label:"排序","min-width":"160px"},scopedSlots:t._u([{key:"default",fn:function(e){return[0==e.row.showUpdate?a("div",{staticClass:"sort-num"},[a("el-button-group",[a("el-input",{staticStyle:{width:"80px"},attrs:{size:"mini"},on:{focus:function(a){return t.modifySortNum(e.$index,e.row)}},model:{value:e.row.sortNum,callback:function(a){t.$set(e.row,"sortNum",a)},expression:"scope.row.sortNum"}})],1)],1):1==e.row.showUpdate?a("div",{staticClass:"sort-num"},[a("el-button-group",[a("el-input",{staticStyle:{width:"80px"},attrs:{size:"mini"},on:{blur:function(a){return t.deleteSortNum(e.$index,!0)}},model:{value:e.row.updateSortNum,callback:function(a){t.$set(e.row,"updateSortNum",a)},expression:"scope.row.updateSortNum"}})],1),t._v(" "),a("el-button-group",[a("el-button",{staticStyle:{width:"25px"},attrs:{icon:"el-icon-check",size:"mini"},on:{click:function(a){return t.sureUpdataSortNum(e.row)}}}),t._v(" "),a("el-button",{staticStyle:{width:"25px"},attrs:{icon:"el-icon-close",size:"mini"},on:{click:function(a){return t.deleteSortNum(e.$index)}}})],1)],1):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{"min-width":"160px",prop:"createTime",label:"导入时间"}}),t._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"100px"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[a("el-button",{attrs:{size:"mini",icon:"el-icon-delete"},on:{click:function(a){return t.deleteItem(e.row)}}},[t._v("移除")])],1)]}}])})],1),t._v(" "),a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:t.tableData.length>0,expression:"tableData.length>0"}],staticClass:"tc mt20",attrs:{background:"","current-page":t.pageNum,"page-sizes":[10,50,100,150,200],layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.changeSize,"current-change":t.changeCurrent,"update:currentPage":function(e){t.pageNum=e},"update:current-page":function(e){t.pageNum=e}}})],1),t._v(" "),a("choose-goods",{ref:"chooseGoods",on:{importGoodsSuccess:function(e){return t.doSearchHandel(!0)}}})],1)},staticRenderFns:[]};var C=a("VU/8")(S,w,!1,function(t){a("r1do")},null,null);e.default=C.exports},r1do:function(t,e){}});
//# sourceMappingURL=35.1c4ca361f37ff3365bde.js.map