webpackJsonp([138],{"6AId":function(e,t){},uGwZ:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s,i=a("bOdI"),o=a.n(i),r=a("Gu7T"),l=a.n(r),d=a("mvHQ"),c=a.n(d),n=a("BO1k"),p=a.n(n),m=a("Dd8w"),u=a.n(m),f=(a("ssT3"),a("oAV5")),g=a("VZ4h"),h=a("hR2Z"),v=a("enjp"),y=a("cpGA"),k=a("8uth"),b=/^[1-9]*[1-9][0-9]*$/,T=/((^[1-9]\d*)|^0)(\.\d{0,2}){0,1}$/,M="/foundation/qiniu/auth/file",P="/plateform/a/preSale/activity/saveActivity",_="/plateform/a/preSale/activity/updateActivity",C="/plateform/a/preSale/activity/detail",S="/newretail-shop/a/preSale/goods/checkPreGoodsInsert",w={data:function(){return{editType:"",activityId:"",isDisabled:!1,addParamMsg:{platformId:5,DIFFCITY:!0,regionCode:"",regionName:"",activityName:"",startDatetime:"",endDatetime:"",activityType:51,presaleType:2,cycleType:1,shortCycleType:1,longCycleType:3,cutoffTime:"",shortPickUpType:0,longPickUpType:5,pickUpStartDate:"",pickUpEndDate:"",goodsReqList:[],storeNoList:[]},shortCircleOptions:[{label:"每天",value:1},{label:"每2天",value:2}],shortPickUpTypeOptions:[{label:"截单后第2天提",value:0}],longCycleOptions:[{label:"周一",value:1},{label:"周二",value:2},{label:"周三",value:3},{label:"周四",value:4},{label:"周五",value:5},{label:"周六",value:6},{label:"周日",value:7}],pickerOptions:{disabledDate:function(e){return e.getTime()<Date.now()-864e5}},checkedList:[],imageUploadLoading:!1,currentUpFileIdx:-1,activityStoresCheckedList:[],status:0,tempConfig:{platformCityGoodsId:"区域商品id(必填)",goodsNo:"SKU编码(选填)",skuNo:"ERP商品编码(选填)",goodsName:"活动商品名称(可修改，必填)",price:"原价(必填）",preSalePrice:"预售价(必填)",platformCurStock:"区域限售库存(选填，为空时不限)",stock:"门店限售库存(选填，为空时不限)",limitCount:"每人每期限购(选填，为空时不限)",sortNum:"排序(必填)",sfInStockStr:"顺丰仓现货（选填，填是/否，空时为是）"},showTipErrorMsg:!1,hasErrorMsgData:[]}},components:{"excel-add":v.a,"choose-goods":g.a,"choose-store":h.a},beforeRouteEnter:function(e,t,a){"copy"===e.params.type?(document.title="复制预售活动",e.meta.breadcrumbList=[{name:"预售管理",path:""},{name:"预售活动管理",path:"/pre_act"},{name:"复制预售活动",path:""}]):(document.title="编辑预售活动",e.meta.breadcrumbList=[{name:"预售管理",path:""},{name:"预售活动管理",path:"/pre_act"},{name:"编辑预售活动",path:""}]),a()},created:function(){this.activityId=this.$route.params.id,this.editType=this.$route.params.type,this.status=this.$route.query.status?parseInt(this.$route.query.status):0},mounted:function(){this.getDetailMsg()},methods:(s={getDetailMsg:function(){var e=this;f.r(),this.$http.post(C,{activityId:this.activityId,DIFFCITY:!0}).then(function(t){if(f.c(),0!==t.code)throw new Error(t.msg);t.data&&(e.addParamMsg.regionCode=t.data.regionCode,e.addParamMsg.regionName=t.data.regionName,e.addParamMsg.activityName=t.data.activityName,t.data.activityType&&(e.addParamMsg.activityType=t.data.activityType||51),t.data.presaleType&&(e.addParamMsg.presaleType=t.data.presaleType),t.data.cycleType&&(e.addParamMsg.cycleType=t.data.cycleType),t.data.activityStartDate?e.addParamMsg.startDatetime=t.data.activityStartDate:e.addParamMsg.startDatetime="",t.data.activityEndDate?e.addParamMsg.endDatetime=t.data.activityEndDate:e.addParamMsg.endDatetime="",1===parseInt(t.data.presaleType)?e.addParamMsg.pickUpStartDate=t.data.pickUpDate:2===parseInt(t.data.presaleType)&&(1===parseInt(t.data.cycleType)?(e.addParamMsg.shortCycleType=t.data.cutoffDays?parseInt(t.data.cutoffDays):1,e.addParamMsg.shortPickUpType=0):2===parseInt(t.data.cycleType)&&(e.addParamMsg.longCycleType=t.data.cutoffType,e.addParamMsg.longPickUpType=t.data.pickUpType)),e.addParamMsg.cutoffTime=t.data.cutoffTime,t.data.storeNoList&&t.data.storeNoList.length&&(e.activityStoresCheckedList=t.data.storeNoList),e.checkedList=t.data.goodsVoList&&t.data.goodsVoList.length>0?t.data.goodsVoList:[],e.checkedList.forEach(function(t){t.disabled=2===e.status||3===e.status,t.sfInStock=t.sfInStock}))}).catch(function(t){f.c(),e.$notify.error({title:"提示",message:t.message})})},doSaveHandel:function(){var e=this;if(this.addParamMsg.activityName)if(this.addParamMsg.activityName.length>20)this.$message("预售周期名称,限制20个字");else if(this.addParamMsg.startDatetime)if(this.addParamMsg.endDatetime){var t=f.a(this.addParamMsg.startDatetime),a=f.a(this.addParamMsg.endDatetime);if(a<=t)this.$message("结束时间不能早于或等于开始时间");else{if(1===parseInt(this.addParamMsg.presaleType)){if(!this.addParamMsg.pickUpStartDate)return void this.$message("请选择提货日期");if(f.a(this.addParamMsg.pickUpStartDate)<=a)return void this.$message("提货日期不能早于结束时间")}else if(2===parseInt(this.addParamMsg.presaleType)&&!this.addParamMsg.cutoffTime)return void this.$message("请选择截单时间");var s=this.activityStoresCheckedList.map(function(e){return e.erpStoreNo});if(this.addParamMsg.storeNoList=s,0!==this.addParamMsg.storeNoList.length){var i=[],o=!0,r=!1,l=void 0;try{for(var d,c=p()(this.checkedList);!(o=(d=c.next()).done);o=!0){var n=d.value;if(""===n.goodsName)return void this.$message("请输入("+n.goodsName+")的商品名称");if(!n.price)return void this.$message("请输入("+n.goodsName+")的原价");if(!T.test(n.price)||0==n.price)return void this.$message("原价是大于0，小数保留小数点后2位");if(!n.preSalePrice)return void this.$message("请输入("+n.goodsName+")的预售价");if(!T.test(n.preSalePrice)||0==n.preSalePrice)return void this.$message("预售价是大于0，小数保留小数点后2位");if(parseFloat(n.preSalePrice)>parseFloat(n.price))return void this.$message("("+n.goodsName+")的原价必须大于等于预售价");if(0!=n.platformCurStock&&n.platformCurStock){if(!b.test(n.platformCurStock))return void this.$message("门店限售库存格式不正确");if(n.platformCurStock<0)return void this.$message("区域限售库存不能小于0");if(n.platformCurStock>9999)return void this.$message("区域限售库存不能大于9999")}if(0!=n.stock&&n.stock){if(!b.test(n.stock))return void this.$message("门店限售库存格式不正确");if(n.stock<0)return void this.$message("门店限售库存不能小于0")}if(0!=n.limitCount&&n.limitCount){if(!b.test(n.limitCount))return void this.$message("输入限购数量格式不正确");if(n.limitCount<0)return void this.$message("限购数量不能小于0")}if(0!=n.sortNum&&n.sortNum){if(!b.test(n.sortNum))return void this.$message("排序权重为0 — 299的整数，越大越靠前");if(n.sortNum<0||n.sortNum>299)return void this.$message("排序权重为0 — 299的整数，越大越靠前")}var m={preSaleImageUrl:n.preSaleImageUrl,goodsId:n.goodsId,goodsNo:n.goodsNo,skuNo:n.skuNo,goodsName:n.goodsName,preSalePrice:n.preSalePrice,price:n.price,stock:n.stock,platformCurStock:n.platformCurStock,limitCount:n.limitCount,sortNum:n.sortNum,spec:n.spec,platformCityGoodsId:n.platformCityGoodsId,sfInStock:n.sfInStock};i.push(m)}}catch(e){r=!0,l=e}finally{try{!o&&c.return&&c.return()}finally{if(r)throw l}}if(0!==i.length){var g={DIFFCITY:this.addParamMsg.DIFFCITY,regionCode:this.addParamMsg.regionCode,activityName:this.addParamMsg.activityName,presaleType:this.addParamMsg.presaleType,activityType:this.addParamMsg.activityType,startDatetime:this.addParamMsg.startDatetime,endDatetime:this.addParamMsg.endDatetime,storeNoList:this.addParamMsg.storeNoList,goodsReqList:i};2===parseInt(this.addParamMsg.presaleType)?1===parseInt(this.addParamMsg.cycleType)?(g.cycleType=this.addParamMsg.cycleType,g.cutoffType=0,g.cutoffDays=this.addParamMsg.shortCycleType,g.cutoffTime=this.addParamMsg.cutoffTime,g.pickUpType=this.addParamMsg.shortPickUpType):(g.cycleType=this.addParamMsg.cycleType,g.cutoffType=this.addParamMsg.longCycleType,g.cutoffTime=this.addParamMsg.cutoffTime,g.pickUpType=this.addParamMsg.longPickUpType):g.pickUpStartDatetime=this.addParamMsg.pickUpStartDate+" 00:00:00";var h=_,v="";"edit"===this.editType?(g.activityId=this.activityId,h=_,v="编辑成功"):"copy"===this.editType&&(h=P,v="复制成功"),this.isDisabled=!0,this.$http.post(h,u()({},g)).then(function(t){if(setTimeout(function(){e.isDisabled=!1},800),0===t.code)return e.$message.success(v),void e.$router.push("/pre_act");throw new Error(t.msg)}).catch(function(t){e.isDisabled=!1,e.$notify.error({title:"提示",message:t.message})})}else this.$message("请先设置预售商品")}else this.$message("请选择参与门店")}}else this.$message("请选择结束时间");else this.$message("请选择开始时间");else this.$message("请输入预售周期名称")},doCancelHandel:function(){var e=this;this.$confirm("确定取消吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$router.push("/pre_act")}).catch(function(){})},goAddGoodsDialog:function(){if(this.$refs.chooseGoods){var e={title:"选择商品",regionCode:this.addParamMsg.regionCode,checkedList:this.checkedList};this.$refs.chooseGoods.setDefault(e)}},confirmChooseGoods:function(e){this.checkedList=e.checkedList||[]},deleteItem:function(e){var t=e.platformCityGoodsId,a=this.checkedList.filter(function(e){return e.platformCityGoodsId!=t});this.checkedList=JSON.parse(c()(a))},setItemIdx:function(e){this.imageUploadLoading||(this.currentUpFileIdx=e)},emitUpload:function(e){var t=this;this.imageUploadLoading=!0,this.getToken().then(function(a){y.upload(e.file,a.fileName,a.token).subscribe({error:function(){t.imageUploadLoading=!1},complete:function(e){var a="http://retailimg01.benlailife.com/"+e.key;t.imageUploadLoading=!1;var s=[].concat(l()(t.checkedList));s.forEach(function(e){e.goodsId===t.currentUpFileIdx&&(e.preSaleImageUrl=a)}),t.checkedList=s},next:function(e){}})})},imageUploadReg:function(e){var t=-1!==e.type.indexOf("image/"),a="image/jpeg"===e.type||"image/png",s=e.size<=307200;return t&&a&&s||this.$message.error("商品图片建议上传大小不超过300K的710*420像素的jpg或png图片"),t&&a&&s},getToken:function(){var e=this;return this.$http.post(M,{}).then(function(e){if(0==e.code){var t=e.data.token;return{fileName:e.data.key,token:t}}throw new Error(e.msg)}).catch(function(t){e.imageUploadLoading=!1,e.$notify.error({title:"获取七牛token提示",message:t.message})})},platformCurStockHeader:function(){var e=this.$createElement;return e("el-popover",{attrs:{placement:"top-start",width:"260",trigger:"hover"}},[e("div",[e("p",["区域限售库存，即所有门店共享的总预售库存；"]),e("p",["门店限售即每个门店的预售库存，可在门店预售商品中调整门店库存；"]),e("p",["每个商品至少要设置一种限售库存方式，最大可设置9999；"]),e("p",["如果既设了区域限售，又设了门店限售，则先校验区域库存，再校验门店库存；"])]),e("span",{slot:"reference"},["区域限售库存",e("i",{class:"el-icon-question"})])])},limitCountHeader:function(){var e=this.$createElement;return e("el-popover",{attrs:{placement:"top-start",width:"260",trigger:"hover",content:"短周期为每人每天限购数量；长周期为每人每周限购数量；单期预售为每人活动期间限购数量；为空时不限；"}},[e("span",{slot:"reference"},["每人每期限购",e("i",{class:"el-icon-question"})])])},sortNumHeader:function(){var e=this.$createElement;return e("el-popover",{attrs:{placement:"top-start",trigger:"hover",content:"0-299 越大越靠前"}},[e("span",{slot:"reference"},["排序权重",e("i",{class:"el-icon-question"})])])},sfInStockHeader:function(){var e=this.$createElement;return e("el-popover",{attrs:{placement:"top-start",width:"260",trigger:"hover"}},[e("div",[e("p",["1、顺丰标品设为顺丰仓现货时，下单会校验仓库库存；"]),e("p",["2、本来鲜生鲜品无需设置；"])]),e("span",{slot:"reference"},["是否为顺丰仓现货",e("i",{class:"el-icon-question"})])])},onCopySuc:function(){this.$message.success("链接已复制至剪切板，仅限微信公众号中使用")},onCopyError:function(){this.$message.error("复制链接失败,请手动复制")}},o()(s,"platformCurStockHeader",function(){var e=this.$createElement;return e("el-popover",{attrs:{placement:"top-start",width:"260",trigger:"hover"}},[e("div",[e("p",["区域限售库存，即所有门店共享的总预售库存；"]),e("p",["门店限售即每个门店的预售库存，可在门店预售商品中调整门店库存；"]),e("p",["每个商品至少要设置一种限售库存方式，最大可设置9999；"]),e("p",["如果既设了区域限售，又设了门店限售，则先校验区域库存，再校验门店库存；"])]),e("span",{slot:"reference"},["区域限售库存",e("i",{class:"el-icon-question"})])])}),o()(s,"chooseStoreOpen",function(){var e={platformId:this.addParamMsg.platformId,regionCode:this.addParamMsg.regionCode,title:"选择门店",checkedList:this.activityStoresCheckedList};this.$refs.chooseStore.setDefault(e)}),o()(s,"deleteStoreItem",function(e){var t=e.erpStoreNo;this.activityStoresCheckedList=this.activityStoresCheckedList.filter(function(e){return e.erpStoreNo!==t})}),o()(s,"confirmChooseStore",function(e){var t=[];t=e.checkedList&&e.checkedList.length?e.checkedList:[],this.activityStoresCheckedList=t}),o()(s,"doConfirmHandel",function(e){var t=this,a=e.dataList||[];a.forEach(function(e){e.activityType=51}),this.$http.post(S,[].concat(l()(a))).then(function(e){if(t.$refs.excelAdd.closeDisabled(),t.$refs.excelAdd.closeDialog(),0!==e.code)throw new Error(e.msg);if(t.hasErrorMsgData=e.data&&e.data.length?e.data:[],t.hasErrorMsgData.some(function(e){return 1===e.msgType}))t.showTipErrorMsg=!0;else{var a=[].concat(l()(t.checkedList));a.forEach(function(e){t.hasErrorMsgData.forEach(function(t,a){e.goodsId===t.goodsId&&e.goodsNo===t.goodsNo&&e.platformCityGoodsId===t.platformCityGoodsId&&e.skuNo===t.skuNo&&(e.goodsName=t.goodsName,e.spec=t.spec,e.preSaleImageUrl=t.preSaleImageUrl,e.price=t.price,e.preSalePrice=t.preSalePrice,e.platformCurStock=t.platformCurStock,e.stock=t.stock,e.limitCount=t.limitCount,e.sortNum=t.sortNum,e.sfInStock=t.sfInStock)})});var s={};t.checkedList=[].concat(l()(a),l()(t.hasErrorMsgData)).reduceRight(function(e,t){return!s[t.platformCityGoodsId]&&(s[t.platformCityGoodsId]=e.push(t)),e},[])}}).catch(function(e){t.$refs.excelAdd.closeDisabled(),t.$refs.excelAdd.closeDialog(),t.$notify.error({title:"提示",message:e.message})})}),o()(s,"showExcelBatchInsertDialog",function(){if(this.$refs.excelAdd){var e={title:"Excel批量导入",tempConfig:this.tempConfig};this.$refs.excelAdd.setDefaultMsg(e)}}),o()(s,"downLoadErrorMsg",function(){var e=this,t=u()({},this.tempConfig);t.msgTypeStr="验证结果",t.msg="失败原因",this.hasErrorMsgData.forEach(function(e){e.msgTypeStr=1===e.msgType?"验证失败":"验证成功",e.sfInStockStr=e.sfInStock?"是":"否"});var a=f.o(t,!1),s=f.o(t,!0);k.a.ExportJsonToExcel({header:a,filterVal:s,data:this.hasErrorMsgData,filename:"Excel批量导入模板"}),setTimeout(function(){e.$notify.success({title:"温馨提示",message:"Excel批量导入模板下载成功"}),e.isDisabled=!1},500)}),s),beforeRouteLeave:function(e,t,a){e.meta.keepAlive=!0,a()}},I={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"add-form-wraper"},[a("el-form",{ref:"form",attrs:{model:e.addParamMsg,"label-width":"160px"}},[a("el-form-item",{attrs:{label:"选择区域",required:""}},[a("el-input",{staticClass:"add-input",attrs:{disabled:"",size:"small"},model:{value:e.addParamMsg.regionName,callback:function(t){e.$set(e.addParamMsg,"regionName",t)},expression:"addParamMsg.regionName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"预售活动名称",required:""}},[a("el-input",{staticClass:"add-input",attrs:{disabled:2===e.status||3===e.status,size:"small",placeholder:"请输入预售活动名称"},model:{value:e.addParamMsg.activityName,callback:function(t){e.$set(e.addParamMsg,"activityName",t)},expression:"addParamMsg.activityName"}}),e._v(" "),a("span",[e._v("活动名称，限制20个字")])],1),e._v(" "),a("el-form-item",{attrs:{label:"预售类型",required:""}},[a("div",[a("el-radio",{attrs:{disabled:"edit"===e.editType,label:2},model:{value:e.addParamMsg.presaleType,callback:function(t){e.$set(e.addParamMsg,"presaleType",t)},expression:"addParamMsg.presaleType"}},[e._v("周期预售（起止时间周期性提货，适用于今订明取，或每周固定周几提）")])],1),e._v(" "),a("div",[a("el-radio",{attrs:{disabled:"edit"===e.editType,label:1},model:{value:e.addParamMsg.presaleType,callback:function(t){e.$set(e.addParamMsg,"presaleType",t)},expression:"addParamMsg.presaleType"}},[e._v("单期预售（结束后，一次性提货，适用于未上市商品，提前预售）")])],1)]),e._v(" "),2==e.addParamMsg.presaleType?a("el-form-item",{attrs:{label:"周期类型",required:""}},[a("el-radio",{attrs:{disabled:"edit"===e.editType,label:1},model:{value:e.addParamMsg.cycleType,callback:function(t){e.$set(e.addParamMsg,"cycleType",t)},expression:"addParamMsg.cycleType"}},[e._v("短周期（隔1-2日提）")]),e._v(" "),a("el-radio",{attrs:{disabled:"edit"===e.editType,label:2},model:{value:e.addParamMsg.cycleType,callback:function(t){e.$set(e.addParamMsg,"cycleType",t)},expression:"addParamMsg.cycleType"}},[e._v("长周期（固定每周提）")])],1):e._e(),e._v(" "),a("el-form-item",{attrs:{label:"开始时间",required:""}},[a("el-date-picker",{staticClass:"add-input",attrs:{disabled:"edit"===e.editType,size:"small",type:"datetime",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss","picker-options":e.pickerOptions,placeholder:"请输入开始时间"},model:{value:e.addParamMsg.startDatetime,callback:function(t){e.$set(e.addParamMsg,"startDatetime",t)},expression:"addParamMsg.startDatetime"}}),e._v(" "),a("span",[e._v("同一个商品不同周期，起止时间不能有重叠，开始时间添加保存后不可修改")])],1),e._v(" "),a("el-form-item",{attrs:{label:"结束时间",required:""}},[a("el-date-picker",{staticClass:"add-input",attrs:{disabled:"edit"===e.editType,size:"small",type:"datetime",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss","picker-options":e.pickerOptions,placeholder:"请输入结束时间"},model:{value:e.addParamMsg.endDatetime,callback:function(t){e.$set(e.addParamMsg,"endDatetime",t)},expression:"addParamMsg.endDatetime"}}),e._v(" "),a("span",[e._v("周期预售最后一期、单期预售，用户端以结束时间截单，结束时间添加保存后不可修改")])],1),e._v(" "),2==e.addParamMsg.presaleType&&1==e.addParamMsg.cycleType?a("div",[a("el-form-item",{attrs:{label:"截单时间",required:""}},[a("el-select",{staticClass:"add-input-inline",attrs:{placeholder:"截单时间",size:"small",disabled:"edit"===e.editType},model:{value:e.addParamMsg.shortCycleType,callback:function(t){e.$set(e.addParamMsg,"shortCycleType",t)},expression:"addParamMsg.shortCycleType"}},e._l(e.shortCircleOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),e._v(" "),a("el-time-picker",{staticClass:"add-input-inline",attrs:{disabled:"edit"===e.editType,placeholder:"选择时间",format:"HH:mm","value-format":"HH:mm",size:"small"},model:{value:e.addParamMsg.cutoffTime,callback:function(t){e.$set(e.addParamMsg,"cutoffTime",t)},expression:"addParamMsg.cutoffTime"}}),e._v(" "),a("span",[e._v("每天截单即24小时一个周期，每2天截单即48小时一个周期")])],1),e._v(" "),a("el-form-item",{attrs:{label:"提货日期",required:""}},[a("el-select",{staticClass:"add-input",attrs:{placeholder:"提货日期",size:"small",disabled:"edit"===e.editType},model:{value:e.addParamMsg.shortPickUpType,callback:function(t){e.$set(e.addParamMsg,"shortPickUpType",t)},expression:"addParamMsg.shortPickUpType"}},e._l(e.shortPickUpTypeOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),e._v(" "),a("span",[e._v("表示一个周期结束后的第二天提货")])],1)],1):e._e(),e._v(" "),2==e.addParamMsg.presaleType&&2==e.addParamMsg.cycleType?a("div",[a("el-form-item",{attrs:{label:"截单时间",required:""}},[a("el-select",{staticClass:"add-input-inline",attrs:{placeholder:"截单时间",size:"small",disabled:"edit"===e.editType},model:{value:e.addParamMsg.longCycleType,callback:function(t){e.$set(e.addParamMsg,"longCycleType",t)},expression:"addParamMsg.longCycleType"}},e._l(e.longCycleOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),e._v(" "),a("el-time-picker",{staticClass:"add-input-inline",attrs:{disabled:"edit"===e.editType,placeholder:"选择时间",format:"HH:mm","value-format":"HH:mm",size:"small"},model:{value:e.addParamMsg.cutoffTime,callback:function(t){e.$set(e.addParamMsg,"cutoffTime",t)},expression:"addParamMsg.cutoffTime"}}),e._v(" "),a("span",[e._v("用户端在当天截单时间后不展示本期预售商品，后台在截单时间提交订货")])],1),e._v(" "),a("el-form-item",{attrs:{label:"提货日期",required:""}},[a("el-select",{staticClass:"add-input",attrs:{placeholder:"提货日期",size:"small",disabled:"edit"===e.editType},model:{value:e.addParamMsg.longPickUpType,callback:function(t){e.$set(e.addParamMsg,"longPickUpType",t)},expression:"addParamMsg.longPickUpType"}},e._l(e.longCycleOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),e._v(" "),a("span",[e._v("每周五提货，建议给采购预留1天，每周三截单")])],1)],1):e._e(),e._v(" "),1==e.addParamMsg.presaleType?a("el-form-item",{attrs:{label:"提货日期",required:""}},[a("el-date-picker",{staticClass:"add-input",attrs:{disabled:"edit"===e.editType,size:"small",type:"date",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd","picker-options":e.pickerOptions,placeholder:"提货日期"},model:{value:e.addParamMsg.pickUpStartDate,callback:function(t){e.$set(e.addParamMsg,"pickUpStartDate",t)},expression:"addParamMsg.pickUpStartDate"}}),e._v(" "),a("span",[e._v("活动结束后提货，日期需大于活动结束日期")])],1):e._e(),e._v(" "),a("el-form-item",{attrs:{label:"参与门店",required:""}},["copy"===e.editType?a("el-button",{attrs:{size:"small",icon:"el-icon-plus"},on:{click:e.chooseStoreOpen}},[e._v("选择门店")]):e._e(),e._v(" "),e.activityStoresCheckedList.length>0?a("div",{staticClass:"choose-store-table-wrap"},[a("el-table",{staticClass:"fixed-height",attrs:{data:e.activityStoresCheckedList,"empty-text":"暂无选中任何门店","max-height":"300",size:"small"}},[a("el-table-column",{attrs:{"min-width":"220px",label:"门店编码/名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v("\n                "+e._s(t.row.erpStoreNo)+"_"+e._s(t.row.erpStoreName)+"\n              ")])]}}],null,!1,974369925)}),e._v(" "),a("el-table-column",{attrs:{"min-width":"80",prop:"cityName",label:"城市"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"80",prop:"saleTypeName",label:"门店类型"}}),e._v(" "),"copy"===e.editType?a("el-table-column",{attrs:{align:"center",label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-delete"},on:{click:function(a){return e.deleteStoreItem(t.row)}}},[e._v("删除")])]}}],null,!1,3121094832)}):e._e()],1)],1):e._e()],1),e._v(" "),a("el-form-item",{attrs:{label:"设置预售商品",required:""}},[a("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-plus"},on:{click:e.goAddGoodsDialog}},[e._v("添加商品")]),3!==e.status&&2!==e.status?a("el-button",{attrs:{size:"mini",icon:"el-icon-plus"},on:{click:e.showExcelBatchInsertDialog}},[e._v("Excel批量导入")]):e._e(),e._v("    "),a("span",{staticStyle:{color:"red"}},[e._v("*注意：")]),a("span",[e._v("商品图片建议上传大小不超过300K的710*420像素的jpg或png图片")]),e._v(" "),a("el-table",{staticClass:"fixed-height choose-goods-wrap",staticStyle:{width:"100%"},attrs:{data:e.checkedList,"empty-text":"暂无选中任何商品","max-height":"560",size:"small"}},[a("el-table-column",{attrs:{"min-width":"300px",label:"商品信息"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"ll-p-m-w"},[a("div",{staticClass:"mh-up-w",on:{click:function(a){return e.setItemIdx(t.row.goodsId)}}},[a("el-upload",{staticClass:"avatar-uploader-sf-goods-img",attrs:{disabled:t.row.disabled,action:"","show-file-list":!1,"before-upload":e.imageUploadReg,"http-request":e.emitUpload}},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.imageUploadLoading&&e.currentUpFileIdx==t.row.goodsId,expression:"imageUploadLoading && currentUpFileIdx == scope.row.goodsId"}]},[t.row.preSaleImageUrl?a("span",[a("img",{staticClass:"avatar-sf-goods",attrs:{src:t.row.preSaleImageUrl}})]):a("i",{staticClass:"el-icon-plus avatar-uploader-sf-icon"})])])],1),e._v(" "),a("div",{staticClass:"ll-p-m-c-r"},[a("div",[a("el-input",{attrs:{disabled:t.row.disabled,size:"small",placeholder:"输入商品名称"},model:{value:t.row.goodsName,callback:function(a){e.$set(t.row,"goodsName",a)},expression:"scope.row.goodsName"}})],1),e._v(" "),a("div",{staticClass:"ll-erp-p-no"},[e._v("SKU编码："+e._s(t.row.goodsNo||"--"))]),e._v(" "),a("div",{staticClass:"ll-erp-p-no"},[e._v("商品ID："+e._s(t.row.platformCityGoodsId||"--"))]),e._v(" "),a("div",{staticClass:"ll-erp-p-no"},[e._v("商品编码："+e._s(t.row.goodsId||"--"))])])])]}}])}),e._v(" "),a("el-table-column",{attrs:{"min-width":"100px",prop:"spec",label:"规格"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"130px",label:"原价(必填)"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-input",{attrs:{disabled:t.row.disabled,size:"small",placeholder:"输入原价"},model:{value:t.row.price,callback:function(a){e.$set(t.row,"price",a)},expression:"scope.row.price"}})],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{"min-width":"130px",label:"预售价(必填)"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-input",{attrs:{disabled:t.row.disabled,size:"small",placeholder:"输入预售价"},model:{value:t.row.preSalePrice,callback:function(a){e.$set(t.row,"preSalePrice",a)},expression:"scope.row.preSalePrice"}})],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{"min-width":"130px","render-header":e.platformCurStockHeader},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-input",{attrs:{disabled:t.row.disabled,size:"small",placeholder:"区域限售库存"},model:{value:t.row.platformCurStock,callback:function(a){e.$set(t.row,"platformCurStock",a)},expression:"scope.row.platformCurStock"}})],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{"min-width":"130px",label:"门店限售库存"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-input",{attrs:{disabled:t.row.disabled,size:"small",placeholder:"门店限售库存"},model:{value:t.row.stock,callback:function(a){e.$set(t.row,"stock",a)},expression:"scope.row.stock"}})],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{"min-width":"140px","render-header":e.limitCountHeader},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-input",{attrs:{disabled:t.row.disabled,size:"small",placeholder:"每人每期限购"},model:{value:t.row.limitCount,callback:function(a){e.$set(t.row,"limitCount",a)},expression:"scope.row.limitCount"}})],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{"min-width":"140px","render-header":e.sortNumHeader},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-input",{attrs:{disabled:t.row.disabled,size:"small",placeholder:"排序（0-299越大越靠前）"},model:{value:t.row.sortNum,callback:function(a){e.$set(t.row,"sortNum",a)},expression:"scope.row.sortNum"}})],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{"min-width":"190px","render-header":e.sfInStockHeader},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-radio",{attrs:{disabled:t.row.disabled,label:!0},model:{value:t.row.sfInStock,callback:function(a){e.$set(t.row,"sfInStock",a)},expression:"scope.row.sfInStock"}},[e._v("是")]),e._v(" "),a("el-radio",{attrs:{disabled:t.row.disabled,label:!1},model:{value:t.row.sfInStock,callback:function(a){e.$set(t.row,"sfInStock",a)},expression:"scope.row.sfInStock"}},[e._v("否")])],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("el-button",{attrs:{disabled:t.row.disabled,type:"text",size:"mini",icon:"el-icon-delete"},on:{click:function(a){return e.deleteItem(t.row)}}},[e._v("删除")])],1)]}}])})],1),e._v(" "),a("p",[a("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v("预售活动未发布时可以编辑商品，发布后只可添加新商品，不可再编辑已有商品；")]),e._v(" "),a("p",[a("span",{staticStyle:{color:"red"}},[e._v("*")]),e._v("活动进行中时新上门店，请在预售商品中发布至门店；")])],1),e._v(" "),a("hr",{staticClass:"s-slip-tb"}),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small",disabled:e.isDisabled,icon:e.isDisabled?"el-icon-loading":null},on:{click:e.doSaveHandel}},[e._v("保存")]),e._v(" "),a("el-button",{attrs:{size:"small"},on:{click:e.doCancelHandel}},[e._v("取消")])],1)],1),e._v(" "),a("choose-goods",{ref:"chooseGoods",on:{confirmChooseGoods:e.confirmChooseGoods}}),e._v(" "),a("choose-store",{ref:"chooseStore",on:{confirmChooseStore:e.confirmChooseStore}}),e._v(" "),a("excel-add",{ref:"excelAdd",on:{doConfirmHandel:e.doConfirmHandel}}),e._v(" "),a("el-dialog",{attrs:{title:"批量导入失败",visible:e.showTipErrorMsg,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"450px"},on:{"update:visible":function(t){e.showTipErrorMsg=t}}},[a("div",[e._v("\n      部分商品不符合要求，请按要求修改后再重新导入。"),a("el-button",{attrs:{type:"text",size:"mini"},on:{click:e.downLoadErrorMsg}},[e._v("下载查看失败原因")])],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"mini"},on:{click:function(t){e.showTipErrorMsg=!1}}},[e._v("关 闭")])],1)])],1)},staticRenderFns:[]};var $=a("VU/8")(w,I,!1,function(e){a("6AId")},null,null);t.default=$.exports}});
//# sourceMappingURL=138.afbf2345a4552fedfa6c.js.map