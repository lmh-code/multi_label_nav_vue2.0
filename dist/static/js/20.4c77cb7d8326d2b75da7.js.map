{"version":3,"sources":["webpack:///src/components/StoreMgt/Poster/Edit.vue","webpack:///./src/components/StoreMgt/Poster/Edit.vue?8018","webpack:///./src/components/StoreMgt/Poster/Edit.vue","webpack:///src/components/StoreMgt/Poster/Category.vue","webpack:///./src/components/StoreMgt/Poster/Category.vue?a15a","webpack:///./src/components/StoreMgt/Poster/Category.vue"],"names":["fileUrlList","Edit","data","isDisabled","imageUploadLoading","addParamMsg","id","DIFFCITY","regionCode","localStorage","get","regionName","templateType","posterTitle","posterImageUrl","enable","categoryNoList","categoryNamesStr","templateTypeOptions","label","value","enableOptions","categoryList","components","category","created","this","$route","params","getDetailMsg","selectCategoryList","methods","_this2","utils","$http","post","StoreMgt","detail","then","res","code","detailMsg","length","join","Error","msg","catch","e","$notify","error","title","message","getToken","_this3","token","fileName","key","imageUploadReg","file","_this4","_this","isPic","type","indexOf","isJPG","isSizeNum","size","$message","isSize","promise_default","a","resolve","reject","_URL","window","URL","webkitURL","img","Image","src","createObjectURL","onload","width","height","emitUpload","_this5","qiniu_min","subscribe","complete","urlImage","next","doSaveHandel","_this6","saveAndUpdate","extends_default","setTimeout","success","$router","push","showChooseCatDialog","_params","showModel","defaultCheckedKeys","$refs","chooseGoodsDialog","setDefaultMsg","doCancelHandel","_this7","$confirm","confirmButtonText","cancelButtonText","_this8","confirmChooseCategory","checkedKeys","categoryNames","beforeRouteLeave","to","from","meta","keepAlive","Poster_Edit","render","_vm","_h","$createElement","_c","_self","staticClass","ref","attrs","model","label-width","required","placeholder","disabled","callback","$$v","$set","expression","_v","_l","item","trim","action","show-file-list","before-upload","http-request","directives","name","rawName","slot","icon","on","click","idx","_s","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__","Category","props","Array","default","defaultProps","children","tree","setCheckedKeys","concat","toConsumableArray_default","doConfirmHandel","getCheckedKeys","$emit","Poster_Category","close-on-click-modal","close-on-press-escape","visible","update:visible","$event","staticStyle","max-height","overflow-y","show-checkbox","node-key","default-checked-keys"],"mappings":"uOAuEAA,EACA,8BAEAC,GACAC,KADA,WAEA,OACAC,YAAA,EACAC,oBAAA,EACAC,aACAC,GAAA,GACAC,UAAA,EACAC,WAAAC,EAAA,EAAAC,IAAA,kBACAC,WAAA,GACAC,aAAA,EACAC,YAAA,GACAC,eAAA,GACAC,OAAA,EACAC,mBAEAC,iBAAA,GAEAC,sBAEAC,MAAA,OACAC,MAAA,IAGAD,MAAA,OACAC,MAAA,IAGAD,MAAA,OACAC,MAAA,IAGAC,gBACAF,MAAA,KACAC,MAAA,IAGAD,MAAA,KACAC,MAAA,IAIAE,kBAIAC,YACAC,mBAAA,GAEAC,QAjDA,WAkDAC,KAAArB,YAAAC,GAAAoB,KAAAC,OAAAC,OAAAtB,GACAoB,KAAAG,eACAH,KAAAI,sBAEAC,SACAF,aADA,WACA,IAAAG,EAAAN,KACMO,EAAA,IACNP,KAAAQ,MAAAC,KAAAC,EAAA,EAAAC,QAAA/B,GAAAoB,KAAArB,YAAAC,GAAAC,UAAA,IAAA+B,KAAA,SAAAC,GAEA,GADQN,EAAA,IACR,IAAAM,EAAAC,KAAA,CACA,IAAAC,EAAAF,EAAArC,SAUA,OATA8B,EAAA3B,YAAAC,GAAAmC,EAAAnC,GACA0B,EAAA3B,YAAAG,WAAAiC,EAAAjC,YAAA,GACAwB,EAAA3B,YAAAM,WAAA8B,EAAA9B,YAAA,GACAqB,EAAA3B,YAAAW,eAAAyB,EAAAzB,mBACAgB,EAAAf,iBAAAwB,EAAAzB,gBAAAyB,EAAAzB,eAAA0B,OAAAD,EAAAzB,eAAA2B,KAAA,QACAX,EAAA3B,YAAAU,OAAA0B,EAAA1B,QAAA,EACAiB,EAAA3B,YAAAO,aAAA6B,EAAA7B,cAAA,EACAoB,EAAA3B,YAAAQ,YAAA4B,EAAA5B,aAAA,QACAmB,EAAA3B,YAAAS,eAAA2B,EAAA3B,gBAAA,IAGA,UAAA8B,MAAAL,EAAAM,OACAC,MAAA,SAAAC,GACQd,EAAA,IACRD,EAAAgB,QAAAC,OACAC,MAAA,KACAC,QAAAJ,EAAAI,aAQAC,SA/BA,WA+BA,IAAAC,EAAA3B,KACA,OAAAA,KAAAQ,MAAAC,KAAAnC,MAAAsC,KAAA,SAAAC,GACA,MAAAA,EAAAC,KAAA,CACA,IAAAc,EAAAf,EAAArC,KAAAoD,MAEA,OAAAC,SADAhB,EAAArC,KAAAsD,IACAF,SAEA,UAAAV,MAAAL,EAAAM,OACAC,MAAA,SAAAC,GACAM,EAAAjD,oBAAA,EACAiD,EAAAL,QAAAC,OACAC,MAAA,cACAC,QAAAJ,EAAAI,aASAM,eApDA,SAoDAC,GAAA,IAAAC,EAAAjC,KACAkC,EAAAlC,KACAmC,GAAA,IAAAH,EAAAI,KAAAC,QAAA,UACAC,EAAA,eAAAN,EAAAI,MAAA,YACAG,EAAAP,EAAAQ,MAAA,MACA,IAAAL,IAAAG,IAAAC,EAEA,OADAvC,KAAAyC,SAAAlB,MAAA,qEACA,EAEA,IAAAmB,EAAA,IAAAC,EAAAC,EAAA,SAAAC,EAAAC,GACA,IAAAC,EAAAC,OAAAC,KAAAD,OAAAE,UACAC,EAAA,IAAAC,MACAD,EAAAE,IAAAN,EAAAO,gBAAAtB,GACAmB,EAAAI,OAAA,WACA,IAAArB,EAAAvD,YAAAO,aAEA,MAAAiE,EAAAK,OAAA,OAAAL,EAAAM,OAAAZ,IAAAC,IAEA,MAAAK,EAAAK,OAAA,OAAAL,EAAAM,OAAAZ,IAAAC,OAGAlC,KAAA,WACA,OAAAoB,GACA,WAOA,OANA,IAAAE,EAAAvD,YAAAO,aAEA+C,EAAAQ,SAAAlB,MAAA,6CAEAU,EAAAQ,SAAAlB,MAAA,kDAEAoB,EAAAC,EAAAE,WAEA,OAAAX,GAAAG,GAAAC,GAAAG,GAOAgB,WA3FA,SA2FArC,GAAA,IAAAsC,EAAA3D,KACAA,KAAAtB,oBAAA,EACAsB,KAAA0B,WAAAd,KAAA,SAAAC,GAEA+C,EAAA,OAAAvC,EAAAW,KAAAnB,EAAAgB,SAAAhB,EAAAe,OACAiC,WACAtC,MAAA,WACAoC,EAAAlB,SAAAlB,MAAA,cACAoC,EAAAjF,oBAAA,GAEAoF,SAAA,SAAAjD,GAEA,IAAAkD,EAAA,qCAAAlD,EAAAiB,IACA6B,EAAAjF,oBAAA,EAEAiF,EAAAhF,YAAAS,eAAA2E,GAEAC,KAAA,SAAAnD,UAKAoD,aAjHA,WAiHA,IAAAC,EAAAlE,KACAA,KAAArB,YAAAQ,YAGAa,KAAArB,YAAAQ,YAAA6B,OAAA,GACAhB,KAAAyC,SAAA,cAGAzC,KAAArB,YAAAS,gBAIAY,KAAAvB,YAAA,EACAuB,KAAAQ,MAAAC,KAAAC,EAAA,EAAAyD,cAAAC,OAAApE,KAAArB,cAAAiC,KAAA,SAAAC,GAKA,GAHAwD,WAAA,WACAH,EAAAzF,YAAA,GACA,KACA,IAAAoC,EAAAC,KAGA,OAFAoD,EAAAzB,SAAA6B,QAAA,aACAJ,EAAAK,QAAAC,KAAA,WAGA,UAAAtD,MAAAL,EAAAM,OACAC,MAAA,SAAAC,GACA6C,EAAAzF,YAAA,EACAyF,EAAA5C,QAAAC,OACAC,MAAA,KACAC,QAAAJ,EAAAI,aAnBAzB,KAAAyC,SAAA,kEAPAzC,KAAAyC,SAAA,YA8BAgC,oBAjJA,WAkJA,IAAAC,GACAC,WAAA,EACAC,mBAAA5E,KAAArB,YAAAW,gBAEAU,KAAA6E,MAAAC,kBAAAC,cAAAL,IAEAM,eAxJA,WAwJA,IAAAC,EAAAjF,KACAA,KAAAkF,SAAA,mBACAC,kBAAA,KACAC,iBAAA,KACAhD,KAAA,YACAxB,KAAA,WACAqE,EAAAV,QAAAC,KAAA,aACApD,MAAA,eAEAhB,mBAjKA,WAiKA,IAAAiF,EAAArF,KACAA,KAAAQ,MAAAxB,IAAA0B,EAAA,EAAAN,oBAAAQ,KAAA,SAAAC,GACA,OAAAA,EAAAC,KAIA,UAAAI,MAAAL,EAAAM,KAHAkE,EAAAzF,aAAAiB,EAAArC,MAAAqC,EAAArC,KAAAwC,OAAAH,EAAArC,UAIA4C,MAAA,SAAAC,GACAgE,EAAA/D,QAAAC,OACAC,MAAA,KACAC,QAAAJ,EAAAI,aAIA6D,sBA/KA,SA+KApF,GACAF,KAAArB,YAAAW,eAAAY,EAAAqF,gBACAvF,KAAAT,iBAAAW,EAAAsF,eAAA,KAGAC,iBA1OA,SA0OAC,EAAAC,EAAA3B,GACA0B,EAAAE,KAAAC,WAAA,EACA7B,MCnTe8B,GADEC,OAFjB,WAA0B,IAAAC,EAAAhG,KAAaiG,EAAAD,EAAAE,eAA0BC,EAAAH,EAAAI,MAAAD,IAAAF,EAAwB,OAAAE,EAAA,OAAAA,EAAA,OAA2BE,YAAA,oBAA8BF,EAAA,WAAgBG,IAAA,OAAAC,OAAkBC,MAAAR,EAAArH,YAAA8H,cAAA,WAA+CN,EAAA,gBAAqBI,OAAO9G,MAAA,OAAAiH,SAAA,MAA8BP,EAAA,YAAiBE,YAAA,YAAAE,OAA+B/D,KAAA,QAAAmE,YAAA,OAAAC,SAAA,IAAkDJ,OAAQ9G,MAAAsG,EAAArH,YAAA,WAAAkI,SAAA,SAAAC,GAA4Dd,EAAAe,KAAAf,EAAArH,YAAA,aAAAmI,IAA6CE,WAAA,6BAAsC,GAAAhB,EAAAiB,GAAA,KAAAd,EAAA,gBAAqCI,OAAO9G,MAAA,OAAAiH,SAAA,MAA8BP,EAAA,aAAkBE,YAAA,YAAAE,OAA+BI,YAAA,UAAAnE,KAAA,SAAuCgE,OAAQ9G,MAAAsG,EAAArH,YAAA,aAAAkI,SAAA,SAAAC,GAA8Dd,EAAAe,KAAAf,EAAArH,YAAA,eAAAmI,IAA+CE,WAAA,6BAAwChB,EAAAkB,GAAAlB,EAAA,6BAAAmB,GAAiD,OAAAhB,EAAA,aAAuBrE,IAAAqF,EAAAzH,MAAA6G,OAAsB9G,MAAA0H,EAAA1H,MAAAC,MAAAyH,EAAAzH,WAAyC,OAAAsG,EAAAiB,GAAA,KAAAd,EAAA,gBAAwCI,OAAO9G,MAAA,OAAAiH,SAAA,MAA8BP,EAAA,YAAiBE,YAAA,YAAAE,OAA+B/D,KAAA,QAAAmE,YAAA,WAAuCH,OAAQ9G,MAAAsG,EAAArH,YAAA,YAAAkI,SAAA,SAAAC,GAA6Dd,EAAAe,KAAAf,EAAArH,YAAA,+BAAAmI,IAAAM,OAAAN,IAAqFE,WAAA,6BAAuChB,EAAAiB,GAAA,KAAAd,EAAA,QAAAH,EAAAiB,GAAA,qBAAAjB,EAAAiB,GAAA,KAAAd,EAAA,gBAAoFI,OAAO9G,MAAA,OAAAiH,SAAA,MAA8BP,EAAA,aAAkBE,YAAA,0BAAAE,OAA6Cc,OAAA,GAAAC,kBAAA,EAAAC,gBAAAvB,EAAAjE,eAAAyF,eAAAxB,EAAAtC,cAAqGyC,EAAA,OAAYsB,aAAaC,KAAA,UAAAC,QAAA,YAAAjI,MAAAsG,EAAA,mBAAAgB,WAAA,yBAAoGhB,EAAArH,YAAA,eAAAwH,EAAA,OAA6CE,YAAA,iBAAAE,OAAoClD,IAAA2C,EAAArH,YAAAS,kBAAsC+G,EAAA,KAAUE,YAAA,kDAAwDL,EAAAiB,GAAA,KAAAd,EAAA,QAAAH,EAAAiB,GAAA,wEAAAjB,EAAAiB,GAAA,KAAAd,EAAA,gBAA2II,OAAO9G,MAAA,YAAkB0G,EAAA,YAAiBE,YAAA,YAAAE,OAA+B/D,KAAA,QAAAmE,YAAA,UAAsCH,OAAQ9G,MAAAsG,EAAA,iBAAAa,SAAA,SAAAC,GAAsDd,EAAAzG,iBAAAuH,GAAyBE,WAAA,sBAAgCb,EAAA,aAAkBI,OAAOqB,KAAA,SAAAC,KAAA,kBAAwCC,IAAKC,MAAA/B,EAAAvB,qBAAgCmD,KAAA,YAAe,GAAA5B,EAAAiB,GAAA,KAAAd,EAAA,QAAAH,EAAAiB,GAAA,kBAAAjB,EAAAiB,GAAA,KAAAd,EAAA,gBAAqFI,OAAO9G,MAAA,OAAAiH,SAAA,MAA8BP,EAAA,kBAAuBI,OAAO/D,KAAA,SAAegE,OAAQ9G,MAAAsG,EAAArH,YAAA,OAAAkI,SAAA,SAAAC,GAAwDd,EAAAe,KAAAf,EAAArH,YAAA,SAAAmI,IAAyCE,WAAA,uBAAkChB,EAAAkB,GAAAlB,EAAA,uBAAAmB,EAAAa,GAA+C,OAAA7B,EAAA,mBAA6BrE,IAAAkG,EAAAzB,OAAe9G,MAAA0H,EAAAzH,SAAoBsG,EAAAiB,GAAAjB,EAAAiC,GAAAd,EAAA1H,OAAA,oBAA8C,GAAAuG,EAAAiB,GAAA,KAAAd,EAAA,QAAAH,EAAAiB,GAAA,oBAAAjB,EAAAiB,GAAA,KAAAd,EAAA,MAA4EE,YAAA,cAAwBL,EAAAiB,GAAA,KAAAd,EAAA,gBAAAA,EAAA,aAAiDI,OAAOnE,KAAA,UAAAI,KAAA,QAAAoE,SAAAZ,EAAAvH,WAAAoJ,KAAA7B,EAAAvH,WAAA,wBAA2GqJ,IAAKC,MAAA/B,EAAA/B,gBAA0B+B,EAAAiB,GAAA,QAAAjB,EAAAiB,GAAA,KAAAd,EAAA,aAA6CI,OAAO/D,KAAA,SAAesF,IAAKC,MAAA/B,EAAAhB,kBAA4BgB,EAAAiB,GAAA,oBAAAjB,EAAAiB,GAAA,KAAAd,EAAA,YAAwDG,IAAA,oBAAAC,OAA+B3G,aAAAoG,EAAApG,cAAgCkI,IAAKxC,sBAAAU,EAAAV,0BAAmD,IAEj3G4C,oBCCjB,IAcAC,EAdyBC,EAAQ,OAcjCC,CACE9J,EACAuH,GATF,EAVA,SAAAwC,GACEF,EAAQ,SAaV,KAEA,MAUeG,EAAA,QAAAJ,EAAiB,oECChCK,GACAC,OACA7I,cACAwC,KAAAsG,MACAC,QAAA,uBAGAnK,KAPA,WAQA,OACAoK,cACAC,SAAA,oBACApJ,MAAA,gBAEAkF,WAAA,EACAC,wBAGAvE,SACA0E,cADA,SACA7E,GAAA,IAAAgC,EAAAlC,KACAA,KAAA2E,UAAAzE,EAAAyE,UACA3E,KAAA4E,mBAAA1E,EAAA0E,mBACAP,WAAA,WACAnC,EAAA2C,MAAAiE,KAAAC,kBAAAC,OAAAC,IAAA/I,EAAA0E,uBACA,IAEAsE,gBARA,WASAlJ,KAAA2E,WAAA,EAIA,IAAAY,EAAAvF,KAAA6E,MAAAiE,KAAAK,gBAAA,GAEAjJ,GACAsF,cAFAD,EAAAtE,KAAA,KAGAsE,eAEAvF,KAAAoJ,MAAA,wBAAAlJ,MC5DemJ,GADEtD,OAFjB,WAA0B,IAAAC,EAAAhG,KAAaiG,EAAAD,EAAAE,eAA0BC,EAAAH,EAAAI,MAAAD,IAAAF,EAAwB,OAAAE,EAAA,OAAAA,EAAA,aAAiCI,OAAO/E,MAAA,OAAA8H,wBAAA,EAAAC,yBAAA,EAAAC,QAAAxD,EAAArB,UAAAnB,MAAA,SAAkHsE,IAAK2B,iBAAA,SAAAC,GAAkC1D,EAAArB,UAAA+E,MAAuBvD,EAAA,OAAYwD,aAAaC,aAAA,QAAAC,aAAA,UAA0C1D,EAAA,WAAgBG,IAAA,OAAAC,OAAkB/H,KAAAwH,EAAApG,aAAAkK,gBAAA,GAAAC,WAAA,aAAAC,uBAAAhE,EAAApB,mBAAA6D,MAAAzC,EAAA4C,iBAA2I,GAAA5C,EAAAiB,GAAA,KAAAd,EAAA,OAA4BE,YAAA,gBAAAE,OAAmCqB,KAAA,UAAgBA,KAAA,WAAezB,EAAA,aAAkBI,OAAO/D,KAAA,QAAcsF,IAAKC,MAAA,SAAA2B,GAAyB1D,EAAArB,WAAA,MAAwBqB,EAAAiB,GAAA,SAAAjB,EAAAiB,GAAA,KAAAd,EAAA,aAA8CI,OAAOnE,KAAA,UAAAI,KAAA,QAA+BsF,IAAKC,MAAA/B,EAAAkD,mBAA6BlD,EAAAiB,GAAA,oBAEj0BiB,oBCYjBC,EAdyBC,EAAQ,OAcjCC,CACEG,EACAa,GATF,EAEA,KAEA,KAEA,MAUed,EAAA,EAAAJ,EAAiB","file":"static/js/20.4c77cb7d8326d2b75da7.js","sourcesContent":["<style>\n  @import \"../../../../static/style/file_upload.css\";\n</style>\n\n<template>\n  <div>\n    <div class=\"add-form-wraper\">\n      <el-form ref=\"form\" :model=\"addParamMsg\" label-width=\"160px\">\n        <el-form-item label=\"选择区域\" required>\n          <el-input v-model=\"addParamMsg.regionName\" size=\"small\" class=\"add-input\" placeholder=\"选择区域\" disabled>\n          </el-input>\n        </el-form-item>\n        <el-form-item label=\"模板类型\" required>\n          <el-select class=\"add-input\" v-model=\"addParamMsg.templateType\" placeholder=\"请选择模板类型\" size=\"small\">\n            <el-option :label=\"item.label\" :value=\"item.value\" :key=\"item.value\" v-for=\"item in templateTypeOptions\">\n            </el-option>\n          </el-select>\n        </el-form-item>\n        <el-form-item label=\"海报标题\" required>\n          <el-input v-model.trim=\"addParamMsg.posterTitle\" size=\"small\" class=\"add-input\" placeholder=\"请输入海报标题\"></el-input>\n          <span>海报标题，限制20个字</span>\n        </el-form-item>\n        <el-form-item label=\"海报图片\" required>\n          <el-upload\n            class=\"avatar-uploader-3ratio4\"\n            action=\"\"\n            :show-file-list=\"false\"\n            :before-upload=\"imageUploadReg\"\n            :http-request=\"emitUpload\">\n            <div v-loading=\"imageUploadLoading\">\n              <img v-if=\"addParamMsg.posterImageUrl\" :src=\"addParamMsg.posterImageUrl\" class=\"avatar-3ratio4\">\n              <i v-else class=\"el-icon-plus avatar-uploader-3ratio4-icon\"></i>\n            </div>\n          </el-upload>\n          <span>请上传大小不超过500K的jpg或png图片（预售模板和爆款模板满足750*2812像素，秒杀模板满足750*2252像素）</span>\n        </el-form-item>\n        <el-form-item label=\"展示商品配置\">\n          <el-input v-model=\"categoryNamesStr\" size=\"small\" class=\"add-input\" placeholder=\"选择商品分类\">\n            <el-button slot=\"append\" icon=\"el-icon-search\" @click=\"showChooseCatDialog\"></el-button>\n          </el-input>\n          <span>请选择的商品分类</span>\n        </el-form-item>\n        <el-form-item label=\"启用状态\" required>\n          <el-radio-group v-model=\"addParamMsg.enable\" size=\"small\">\n            <el-radio-button :label=\"item.value\" v-for=\"(item, idx) in enableOptions\" :key=\"idx\">{{item.label}}\n            </el-radio-button>\n          </el-radio-group>\n          <span>开启后线上将直接启用</span>\n        </el-form-item>\n\n        <hr class=\"s-slip-tb\">\n        <el-form-item>\n          <el-button type=\"primary\" size=\"small\" @click=\"doSaveHandel\" :disabled=\"isDisabled\" :icon=\"isDisabled ? 'el-icon-loading' : null\">保存</el-button>\n          <el-button size=\"small\" @click=\"doCancelHandel\">取消</el-button>\n        </el-form-item>\n      </el-form>\n    </div>\n    <category \n      ref=\"chooseGoodsDialog\" \n      :categoryList=\"categoryList\"\n      @confirmChooseCategory=\"confirmChooseCategory\"></category>\n  </div>\n</template>\n\n<script>\n  import requestUrl from \"@/api/StoreMgt.js\"\n  import * as utils from '@/utils/utils'\n  import * as qiniu from 'qiniu-js'\n  import config from \"@/utils/config\"\n  import Storage from '@/utils/localStorage'\n  import Category from \"./Category\"\n  const fileUrlList = {\n    getQiNiuToken: '/foundation/qiniu/auth/file'\n  }\n  export default {\n    data() {\n      return {\n        isDisabled: false,\n        imageUploadLoading: false,\n        addParamMsg: {\n          id: '',\n          DIFFCITY: true,\n          regionCode: Storage.get('regionCode') || '', // 区域ID\n          regionName: '',\n          templateType: 1,\n          posterTitle: '',\n          posterImageUrl: '',\n          enable: 0,\n          categoryNoList: []\n        },\n        categoryNamesStr: '', // 分类名称，展示使用\n        // 模板类型 1-预售模板;2-爆款模板;3-秒杀模板\n        templateTypeOptions: [\n          {\n            label: '预售模板',\n            value: 1\n          },\n          {\n            label: '爆款模板',\n            value: 2\n          },\n          {\n            label: '秒杀模板',\n            value: 3\n          }\n        ],\n        enableOptions: [{\n            label: '启用',\n            value: 0\n          },\n          {\n            label: '禁用',\n            value: 1\n          }\n        ],\n        \n        categoryList: []\n\n      }\n    },\n    components: {\n      \"category\": Category\n    },\n    created() {\n      this.addParamMsg.id = this.$route.params.id\n      this.getDetailMsg()\n      this.selectCategoryList()\n    },\n    methods: {\n      getDetailMsg() {\n        utils.showLoading()\n        this.$http.post(requestUrl.detail, {id: this.addParamMsg.id, DIFFCITY: true}).then(res => {\n          utils.clearLoading()\n          if(res.code === 0) {\n            let detailMsg = res.data || {}\n            this.addParamMsg.id = detailMsg.id \n            this.addParamMsg.regionCode = detailMsg.regionCode || ''\n            this.addParamMsg.regionName = detailMsg.regionName || ''\n            this.addParamMsg.categoryNoList = detailMsg.categoryNoList || []\n            this.categoryNamesStr = detailMsg.categoryNoList && detailMsg.categoryNoList.length ? detailMsg.categoryNoList.join(',') : ''\n            this.addParamMsg.enable = detailMsg.enable || 0\n            this.addParamMsg.templateType = detailMsg.templateType || 1\n            this.addParamMsg.posterTitle = detailMsg.posterTitle || ''\n            this.addParamMsg.posterImageUrl = detailMsg.posterImageUrl || ''\n            return\n          }\n          throw new Error(res.msg)\n        }).catch(e => {\n          utils.clearLoading()\n          this.$notify.error({\n            title: '提示',\n            message: e.message\n          })\n        })\n      },\n      /**\n       * [getToken 通过后台封装的接口获取七牛的token]\n       * @return {[type]}            [description]\n       */\n      getToken () {\n        return this.$http.post(fileUrlList.getQiNiuToken, {}).then(res => {\n          if (res.code == 0) {\n            let token = res.data.token\n            let fileName = res.data.key\n            return {fileName, token}\n          }\n          throw new Error(res.msg)\n        }).catch(e => {\n          this.imageUploadLoading = false\n          this.$notify.error({\n            title: '获取七牛token提示',\n            message: e.message\n          })\n        })\n      },\n      /**\n       * [imageUploadReg 上传图片检测]\n       * @param  {[type]} file [description]\n       * @return {[type]}      [description]\n       */\n       imageUploadReg (file) {\n        let _this = this\n        const isPic = file.type.indexOf('image/') !== -1\n        const isJPG = file.type === 'image/jpeg' || 'image/png'\n        const isSizeNum = file.size <= 1 * 500 * 1024\n        if (!isPic || !isJPG || !isSizeNum) {\n          this.$message.error('海报图片为大小不超过500K的jpg或png图片（预售模板和爆款模板满足750*2812像素，秒杀模板满足750*2252像素）')\n          return false\n        }\n        const isSize = new Promise(function(resolve, reject) {\n          let _URL = window.URL || window.webkitURL\n          let img = new Image();\n          img.src = _URL.createObjectURL(file)\n          img.onload = function() {\n            if(_this.addParamMsg.templateType === 3) {\n              // 秒杀\n              img.width === 750 && img.height === 2252 ? resolve() : reject()\n            }else {\n              img.width === 750 && img.height === 2812 ? resolve() : reject()\n            }\n          }\n        }).then(() => {\n          return file\n        }, () => {\n          if(_this.addParamMsg.templateType === 3) {\n            // 秒杀\n            this.$message.error('海报图片为大小不超过500K的jpg或png图片，秒杀模板满足750*2252像素')\n          }else {\n            this.$message.error('海报图片为大小不超过500K的jpg或png图片，预售模板和爆款模板满足750*2812像素')\n          }\n          return Promise.reject()\n        })\n        return isPic && isJPG && isSizeNum && isSize\n      },\n      /**\n       * [emitUpload 上传图片]\n       * @param  {[type]} e [description]\n       * @return {[type]}   [description]\n       */\n      emitUpload(e) {\n        this.imageUploadLoading = true\n        this.getToken().then((res) => {\n          // 开始上传图片\n          let uploader = qiniu.upload(e.file, res.fileName, res.token)\n          uploader.subscribe({\n            error: () => {\n              this.$message.error('图片上传失败，请重试')\n              this.imageUploadLoading = false\n            },\n            complete: (res) => {\n              // 添加内容设置图片地址\n              let urlImage = 'http://retailimg01.benlailife.com/' + res.key\n              this.imageUploadLoading = false\n              // 设置对应的图片地址\n              this.addParamMsg.posterImageUrl = urlImage\n            },\n            next: res => {\n            }\n          })\n        })\n      },\n      doSaveHandel() {\n        if(!this.addParamMsg.posterTitle) {\n          this.$message('请输入海报标题') \n          return\n        }else if(this.addParamMsg.posterTitle.length > 20) {\n          this.$message('海报标题限制20个字') \n          return\n        }\n        if(!this.addParamMsg.posterImageUrl) {\n          this.$message('请上传大小不超过500K的jpg或png图片（预售模板和爆款模板满足750*2812像素，秒杀模板满足750*2252像素）') \n          return\n        }\n        this.isDisabled = true\n        this.$http.post(requestUrl.saveAndUpdate, {...this.addParamMsg}).then(res => {\n          // 保存按钮可再次点击\n          setTimeout(() => {\n            this.isDisabled = false\n          }, 800)\n          if(res.code === 0) {\n            this.$message.success(\"保存成功\")\n            this.$router.push('/poster')\n            return\n          }\n          throw new Error(res.msg)\n        }).catch(e => {\n          this.isDisabled = false\n          this.$notify.error({\n            title: '提示',\n            message: e.message\n          })\n        })\n      },\n      showChooseCatDialog() {\n        let _params = {\n          showModel: true,\n          defaultCheckedKeys: this.addParamMsg.categoryNoList\n        }\n        this.$refs.chooseGoodsDialog.setDefaultMsg(_params)\n      },\n      doCancelHandel() {\n        this.$confirm('确定取消添加商品吗?', '提示', {\n          confirmButtonText: '确定',\n          cancelButtonText: '取消',\n          type: 'warning'\n        }).then(() => {\n          this.$router.push('/poster')\n        }).catch(() => {})\n      },\n      selectCategoryList() {\n        this.$http.get(requestUrl.selectCategoryList).then(res => {\n          if (res.code === 0) {\n            this.categoryList = res.data && res.data.length ? res.data : []\n            return\n          }\n          throw new Error(res.msg)\n        }).catch(e => {\n          this.$notify.error({\n            title: '提示',\n            message: e.message\n          })\n        })\n      },\n      confirmChooseCategory(params) {\n        this.addParamMsg.categoryNoList = params.checkedKeys || []\n        this.categoryNamesStr = params.categoryNames || ''\n      }\n    },\n    beforeRouteLeave(to, from, next) {\n      to.meta.keepAlive = true;\n      next();\n    }\n  }\n</script>\n\n\n// WEBPACK FOOTER //\n// src/components/StoreMgt/Poster/Edit.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('div',{staticClass:\"add-form-wraper\"},[_c('el-form',{ref:\"form\",attrs:{\"model\":_vm.addParamMsg,\"label-width\":\"160px\"}},[_c('el-form-item',{attrs:{\"label\":\"选择区域\",\"required\":\"\"}},[_c('el-input',{staticClass:\"add-input\",attrs:{\"size\":\"small\",\"placeholder\":\"选择区域\",\"disabled\":\"\"},model:{value:(_vm.addParamMsg.regionName),callback:function ($$v) {_vm.$set(_vm.addParamMsg, \"regionName\", $$v)},expression:\"addParamMsg.regionName\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"模板类型\",\"required\":\"\"}},[_c('el-select',{staticClass:\"add-input\",attrs:{\"placeholder\":\"请选择模板类型\",\"size\":\"small\"},model:{value:(_vm.addParamMsg.templateType),callback:function ($$v) {_vm.$set(_vm.addParamMsg, \"templateType\", $$v)},expression:\"addParamMsg.templateType\"}},_vm._l((_vm.templateTypeOptions),function(item){return _c('el-option',{key:item.value,attrs:{\"label\":item.label,\"value\":item.value}})}),1)],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"海报标题\",\"required\":\"\"}},[_c('el-input',{staticClass:\"add-input\",attrs:{\"size\":\"small\",\"placeholder\":\"请输入海报标题\"},model:{value:(_vm.addParamMsg.posterTitle),callback:function ($$v) {_vm.$set(_vm.addParamMsg, \"posterTitle\", (typeof $$v === 'string'? $$v.trim(): $$v))},expression:\"addParamMsg.posterTitle\"}}),_vm._v(\" \"),_c('span',[_vm._v(\"海报标题，限制20个字\")])],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"海报图片\",\"required\":\"\"}},[_c('el-upload',{staticClass:\"avatar-uploader-3ratio4\",attrs:{\"action\":\"\",\"show-file-list\":false,\"before-upload\":_vm.imageUploadReg,\"http-request\":_vm.emitUpload}},[_c('div',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.imageUploadLoading),expression:\"imageUploadLoading\"}]},[(_vm.addParamMsg.posterImageUrl)?_c('img',{staticClass:\"avatar-3ratio4\",attrs:{\"src\":_vm.addParamMsg.posterImageUrl}}):_c('i',{staticClass:\"el-icon-plus avatar-uploader-3ratio4-icon\"})])]),_vm._v(\" \"),_c('span',[_vm._v(\"请上传大小不超过500K的jpg或png图片（预售模板和爆款模板满足750*2812像素，秒杀模板满足750*2252像素）\")])],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"展示商品配置\"}},[_c('el-input',{staticClass:\"add-input\",attrs:{\"size\":\"small\",\"placeholder\":\"选择商品分类\"},model:{value:(_vm.categoryNamesStr),callback:function ($$v) {_vm.categoryNamesStr=$$v},expression:\"categoryNamesStr\"}},[_c('el-button',{attrs:{\"slot\":\"append\",\"icon\":\"el-icon-search\"},on:{\"click\":_vm.showChooseCatDialog},slot:\"append\"})],1),_vm._v(\" \"),_c('span',[_vm._v(\"请选择的商品分类\")])],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"启用状态\",\"required\":\"\"}},[_c('el-radio-group',{attrs:{\"size\":\"small\"},model:{value:(_vm.addParamMsg.enable),callback:function ($$v) {_vm.$set(_vm.addParamMsg, \"enable\", $$v)},expression:\"addParamMsg.enable\"}},_vm._l((_vm.enableOptions),function(item,idx){return _c('el-radio-button',{key:idx,attrs:{\"label\":item.value}},[_vm._v(_vm._s(item.label)+\"\\n          \")])}),1),_vm._v(\" \"),_c('span',[_vm._v(\"开启后线上将直接启用\")])],1),_vm._v(\" \"),_c('hr',{staticClass:\"s-slip-tb\"}),_vm._v(\" \"),_c('el-form-item',[_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"small\",\"disabled\":_vm.isDisabled,\"icon\":_vm.isDisabled ? 'el-icon-loading' : null},on:{\"click\":_vm.doSaveHandel}},[_vm._v(\"保存\")]),_vm._v(\" \"),_c('el-button',{attrs:{\"size\":\"small\"},on:{\"click\":_vm.doCancelHandel}},[_vm._v(\"取消\")])],1)],1)],1),_vm._v(\" \"),_c('category',{ref:\"chooseGoodsDialog\",attrs:{\"categoryList\":_vm.categoryList},on:{\"confirmChooseCategory\":_vm.confirmChooseCategory}})],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-7c7f7d10\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/StoreMgt/Poster/Edit.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-7c7f7d10\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./Edit.vue\")\n}\nvar normalizeComponent = require(\"!../../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./Edit.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./Edit.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-7c7f7d10\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../../node_modules/vue-loader/lib/selector?type=template&index=0!./Edit.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/StoreMgt/Poster/Edit.vue\n// module id = null\n// module chunks = ","<template>\n  <div>\n    <el-dialog \n      title=\"商品分类\" \n      :close-on-click-modal = \"false\"\n      :close-on-press-escape = \"false\"\n      :visible.sync=\"showModel\" \n      width='400px'>\n      <div style=\"max-height: 300px;overflow-y: auto;\">\n        <el-tree\n          ref=\"tree\"\n          :data=\"categoryList\"\n          show-checkbox\n          node-key=\"categoryId\"\n          :default-checked-keys=\"defaultCheckedKeys\"\n          :props=\"defaultProps\">\n        </el-tree>\n      </div>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"showModel = false\" size=\"mini\">取 消</el-button>\n        <el-button type=\"primary\" @click=\"doConfirmHandel\" size=\"mini\">确 定</el-button>\n      </div>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\n  export default {\n    props: {\n      categoryList: {\n        type: Array,\n        default: function() {return []}\n      }\n    },\n    data() {\n      return {\n        defaultProps: {\n          children: 'childCategoryList',\n          label: 'categoryName'\n        },\n        showModel: false,\n        defaultCheckedKeys: []\n      }\n    },\n    methods: {\n      setDefaultMsg(params) {\n        this.showModel = params.showModel\n        this.defaultCheckedKeys = params.defaultCheckedKeys\n        setTimeout(() => {\n          this.$refs.tree.setCheckedKeys([...params.defaultCheckedKeys])\n        }, 0);\n      },\n      doConfirmHandel () {\n        this.showModel = false\n        // let categoryNames = this.$refs.tree.getCheckedNodes(true).map(item => {\n        //   return item.categoryName\n        // }).join(',')\n        let checkedKeys = this.$refs.tree.getCheckedKeys(true)\n        let categoryNames = checkedKeys.join(',')\n        let params = {\n          categoryNames: categoryNames,\n          checkedKeys: checkedKeys\n        }\n        this.$emit(\"confirmChooseCategory\", params)\n      }\n    }\n  }\n</script>\n\n\n// WEBPACK FOOTER //\n// src/components/StoreMgt/Poster/Category.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('el-dialog',{attrs:{\"title\":\"商品分类\",\"close-on-click-modal\":false,\"close-on-press-escape\":false,\"visible\":_vm.showModel,\"width\":\"400px\"},on:{\"update:visible\":function($event){_vm.showModel=$event}}},[_c('div',{staticStyle:{\"max-height\":\"300px\",\"overflow-y\":\"auto\"}},[_c('el-tree',{ref:\"tree\",attrs:{\"data\":_vm.categoryList,\"show-checkbox\":\"\",\"node-key\":\"categoryId\",\"default-checked-keys\":_vm.defaultCheckedKeys,\"props\":_vm.defaultProps}})],1),_vm._v(\" \"),_c('div',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{attrs:{\"size\":\"mini\"},on:{\"click\":function($event){_vm.showModel = false}}},[_vm._v(\"取 消\")]),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"mini\"},on:{\"click\":_vm.doConfirmHandel}},[_vm._v(\"确 定\")])],1)])],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-6e0ab906\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/StoreMgt/Poster/Category.vue\n// module id = null\n// module chunks = ","var normalizeComponent = require(\"!../../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./Category.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./Category.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-6e0ab906\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../../node_modules/vue-loader/lib/selector?type=template&index=0!./Category.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = null\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/StoreMgt/Poster/Category.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}