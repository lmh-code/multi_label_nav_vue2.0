webpackJsonp([71],{K35v:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("BO1k"),n=a.n(i),s=a("lHA8"),l=a.n(s),r=a("c/Tr"),o=a.n(r),c=a("Gu7T"),u=a.n(c),d=a("Dd8w"),p=a.n(d),h="/plateform/a/pricing/faillist",m={data:function(){return{loading:!1,pageNum:1,pageSize:10,total:0,tableData:[],searchContent:{platformId:4,getDate:""}}},methods:{setDefault:function(t){this.doSearchHandel()},changeSize:function(t){this.pageSize=t,this.doSearchHandel()},changeCurrent:function(t){this.pageNum=t,this.doSearchHandel()},doSearchHandel:function(){var t=this;this.loading=!0,this.$http.post(h,p()({},this.searchContent,{pageNum:this.pageNum,pageSize:this.pageSize})).then(function(e){if(t.loading=!1,0===e.code)return e.data&&e.data.result&&e.data.result.length?t.tableData=e.data.result:t.tableData=[],void(1===t.pageNum&&(t.total=e.data.total));throw new Error(e.msg)}).catch(function(e){t.loading=!1,t.$notify.error({title:"提示",message:e.message})})}}},g={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",[a("el-form",{attrs:{model:t.searchContent}},[a("el-form-item",{attrs:{label:"获取日期"}},[a("el-date-picker",{staticClass:"search-date-picker",attrs:{type:"date",placeholder:"请选择日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",size:"small"},on:{change:t.doSearchHandel},model:{value:t.searchContent.getDate,callback:function(e){t.$set(t.searchContent,"getDate",e)},expression:"searchContent.getDate"}})],1)],1)],1),t._v(" "),a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"fixed-height",staticStyle:{width:"100%"},attrs:{data:t.tableData,"empty-text":"没有查询到您想要的数据",height:"280",size:"small"}},[a("el-table-column",{attrs:{"min-width":"100px",prop:"getData",label:"日期"}}),t._v(" "),a("el-table-column",{attrs:{"min-width":"100px",prop:"goodsNo",label:"SKU编码"}}),t._v(" "),a("el-table-column",{attrs:{"min-width":"100px",prop:"erpNumber",label:"ERP编码"}}),t._v(" "),a("el-table-column",{attrs:{"min-width":"178px",prop:"productName",label:"SKU名称"}}),t._v(" "),a("el-table-column",{attrs:{"min-width":"110px",prop:"cityName",label:"区域"}})],1),t._v(" "),a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:t.tableData.length>0,expression:"tableData.length>0"}],staticClass:"tc mt20",attrs:{background:"","current-page":t.pageNum,"page-sizes":[10,50,100,150,200],layout:"total, sizes, prev, pager, next, jumper","pager-count":5,total:t.total},on:{"size-change":t.changeSize,"current-change":t.changeCurrent,"update:currentPage":function(e){t.pageNum=e},"update:current-page":function(e){t.pageNum=e}}})],1)])},staticRenderFns:[]},f=a("VU/8")(m,g,!1,null,null,null).exports,v=a("oAV5"),b="/plateform/a/pricing/recordlist",w="/plateform/a/pricing/updateadjustprice",_="/plateform/a/pricing/auditpricinglog",S="/plateform/a/pricing/batchauditpricinglog",y={data:function(){return{loading:!1,isShowFailList:!1,auditDialogVisible:!1,pageNum:1,pageSize:20,total:0,tableData:[],platformList:[],checkStatusList:[{value:-1,label:"全部"},{value:0,label:"待审核"},{value:1,label:"已审核"}],searchContent:{productName:"",erpNumber:"",platformId:4,checkStatus:0},reg:/^[0-9]+\.[0-9]+$/,reg1:/^[0-9]*$/,auditSelectOne:"",SelectOne:!0,auditIdList:[]}},created:function(){},mounted:function(){this.doSearchHandel(!0)},components:{"fail-list":f},methods:{nullTreating:function(t,e,a){return null==a&&(a="-"),a},checkStatusTreating:function(t,e,a){return 0==a?a="待审核":1!=a&&2!=a||(a="已审核"),a},changeSize:function(t){this.pageSize=t,this.doSearchHandel()},changeCurrent:function(t){this.pageNum=t,this.doSearchHandel(t)},doSearchHandel:function(t){var e=this;null==t&&(this.pageNum=1),this.loading=!0,this.$http.post(b,p()({},this.searchContent,{pageNum:this.pageNum,pageSize:this.pageSize})).then(function(t){if(e.loading=!1,0!==t.code)throw new Error(t.msg);if(t.data&&t.data.result&&t.data.result.length){var a=t.data.result;a.forEach(function(t,e){t.updateAdjustPrice=t.adjustPrice,t.showUpdate=!1}),e.tableData=a,e.auditIdList=[]}else e.tableData=[];1===e.pageNum&&(e.total=t.data.total)}).catch(function(t){e.loading=!1,e.$notify.error({title:"提示",message:t.message})})},handleSelect:function(t,e){var a=[];v.j(this.auditIdList,e.recordId)>-1?this.auditIdList=v.p(this.auditIdList,e.recordId):(a.push(e.recordId),this.auditIdListTemp=[].concat(a,u()(this.auditIdList)),this.auditIdList=o()(new l.a(this.auditIdListTemp)))},handleSelectAll:function(t){if(t.length>0){var e=!0,a=!1,i=void 0;try{for(var s,r=n()(t);!(e=(s=r.next()).done);e=!0){var c=s.value;this.auditIdList.push(c.recordId)}}catch(t){a=!0,i=t}finally{try{!e&&r.return&&r.return()}finally{if(a)throw i}}this.auditIdList=o()(new l.a(this.auditIdList))}else{var d=[],p=!0,h=!1,m=void 0;try{for(var g,f=n()(this.tableData);!(p=(g=f.next()).done);p=!0){var v=g.value;d.push(v.recordId)}}catch(t){h=!0,m=t}finally{try{!p&&f.return&&f.return()}finally{if(h)throw m}}this.auditIdList=o()(new l.a([].concat(u()(this.auditIdList)).filter(function(t){return!new l.a(d).has(t)})))}},getFailList:function(){var t=this;this.isShowFailList=!0,setTimeout(function(){t.$refs.FailList.setDefault()},200)},configPrice:function(){this.$router.push("/ele_price/config")},sureAdjustPrice:function(t){var e=this;null==t.updateAdjustPrice||1!=this.reg.test(t.updateAdjustPrice)&&1!=this.reg1.test(t.updateAdjustPrice)?this.$message("请输入正确的数字"):(this.loading=!0,this.$http.post(w,{adjustPrice:t.updateAdjustPrice,logId:t.recordId}).then(function(t){if(e.loading=!1,0===t.code)return e.$message({message:"调价成功",type:"success"}),void e.doSearchHandel();throw new Error(t.msg)}).catch(function(t){e.loading=!1,e.$notify.error({title:"提示",message:t.message})}))},deleteAdjustPrice:function(t,e){var a=this;e?setTimeout(function(){a.tableData[t].updateAdjustPrice=a.tableData[t].adjustPrice,a.tableData[t].showUpdate=!1},200):(this.tableData[t].updateAdjustPrice=this.tableData[t].adjustPrice,this.tableData[t].showUpdate=!1)},auditOne:function(t){this.SelectOne=!0,this.auditDialogVisible=!0,this.auditSelectOne=t.recordId},auditMore:function(){this.SelectOne=!1,this.auditDialogVisible=!0},sureAudit:function(){var t=this;this.auditDialogVisible=!1,this.loading=!0,1==this.SelectOne?this.$http.post(_,{logId:this.auditSelectOne,status:1}).then(function(e){if(t.loading=!1,0===e.code)return t.$message({message:"审核成功",type:"success"}),void t.doSearchHandel();throw new Error(e.msg)}).catch(function(e){t.loading=!1,t.$notify.error({title:"提示",message:e.message})}):this.$http.post(S,{logIdList:this.auditIdList,status:1}).then(function(e){if(t.loading=!1,0===e.code)return t.$message({message:"批量审核成功",type:"success"}),void t.doSearchHandel();throw new Error(e.msg)}).catch(function(e){t.loading=!1,t.$notify.error({title:"提示",message:e.message})})},modifyAdjustPrice:function(t,e){1!=e.showUpdate&&(this.tableData[t].showUpdate=!0)}}},k={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"handel-search-wraper"},[a("div",{staticClass:"handel-wraper"},[a("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-setting"},on:{click:t.configPrice}},[t._v("配置系统定价")]),t._v(" "),a("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-view"},on:{click:t.getFailList}},[t._v("获取失败查看")])],1),t._v(" "),a("hr",{staticClass:"s-slip"}),t._v(" "),a("div",{staticClass:"search-form-wraper"},[a("el-form",{attrs:{model:t.searchContent,"label-position":"top"}},[a("el-form-item",{attrs:{label:"商品名称"}},[a("el-input",{staticClass:"search-input",attrs:{placeholder:"请输入商品名称",size:"small",clearable:""},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.doSearchHandel(e)}},model:{value:t.searchContent.productName,callback:function(e){t.$set(t.searchContent,"productName","string"==typeof e?e.trim():e)},expression:"searchContent.productName"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"ERP编码"}},[a("el-input",{staticClass:"search-input",attrs:{placeholder:"请输入ERP编码",size:"small",clearable:""},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.doSearchHandel(e)}},model:{value:t.searchContent.erpNumber,callback:function(e){t.$set(t.searchContent,"erpNumber","string"==typeof e?e.trim():e)},expression:"searchContent.erpNumber"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"审核状态"}},[a("el-select",{staticClass:"search-input",attrs:{filterable:"",placeholder:"请选择审核状态",size:"small"},on:{change:t.doSearchHandel},model:{value:t.searchContent.checkStatus,callback:function(e){t.$set(t.searchContent,"checkStatus",e)},expression:"searchContent.checkStatus"}},t._l(t.checkStatusList,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.doSearchHandel}},[t._v("搜索")])],1)],1)],1)]),t._v(" "),a("div",{staticClass:"table-wraper"},[a("div",{staticClass:"sp-handel-w"},[a("el-button",{staticClass:"sup-mini",attrs:{size:"mini",disabled:0===this.auditIdList.length,icon:"el-icon-circle-check-outline"},on:{click:t.auditMore}},[t._v("批量审核")])],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"multipleTable",staticClass:"fixed-height",staticStyle:{width:"100%"},attrs:{data:t.tableData,"empty-text":"没有查询到您想要的数据",size:"small"},on:{select:t.handleSelect,"select-all":t.handleSelectAll}},[a("el-table-column",{attrs:{fixed:"",type:"selection",label:"全选",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{"min-width":"80",prop:"goodsNo",label:"SKU编码"}}),t._v(" "),a("el-table-column",{attrs:{"min-width":"80",prop:"erpNumber",label:"ERP编码"}}),t._v(" "),a("el-table-column",{attrs:{"min-width":"180",prop:"productName",label:"商品名称"}}),t._v(" "),a("el-table-column",{attrs:{"min-width":"90",prop:"cityName",label:"售卖区域"}}),t._v(" "),a("el-table-column",{attrs:{"min-width":"100",prop:"platformName",label:"售卖平台"}}),t._v(" "),a("el-table-column",{attrs:{"min-width":"80",prop:"historyPrice",formatter:t.nullTreating,label:"历史售价"}}),t._v(" "),a("el-table-column",{attrs:{"min-width":"80",prop:"price",label:"当前售价"}}),t._v(" "),a("el-table-column",{attrs:{"min-width":"80",prop:"newPrice",label:"新售价"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-popover",{attrs:{placement:"bottom",width:"310",trigger:"hover"}},[a("div",{staticClass:"new-price"},[a("p",[t._v("新售价 = SKU进货价 /（1 - 平台毛利率）/ 平台折扣率")]),t._v(" "),a("p",[t._v(t._s(e.row.newPrice)+" = "+t._s(e.row.productCost)+" /（1 - "+t._s(e.row.profitRate)+"）/ "+t._s(e.row.discountRate))]),t._v(" "),a("p",[t._v("参考信息")]),t._v(" "),a("p",[t._v("历史进货价  "+t._s(e.row.historyCost))]),t._v(" "),a("p",[t._v(t._s(e.row.productInfo))])]),t._v(" "),a("p",{staticClass:"cursor-pointer",attrs:{slot:"reference"},slot:"reference"},[t._v(t._s(e.row.newPrice))])])]}}])}),t._v(" "),a("el-table-column",{attrs:{"min-width":"160",prop:"adjustPrice",label:"手动调价"},scopedSlots:t._u([{key:"default",fn:function(e){return[0==e.row.showUpdate&&0==e.row.checkStatus?a("div",{staticClass:"adjust-price"},[a("el-button-group",[a("el-input",{staticStyle:{width:"80px"},attrs:{size:"mini"},on:{focus:function(a){return t.modifyAdjustPrice(e.$index,e.row)}},model:{value:e.row.adjustPrice,callback:function(a){t.$set(e.row,"adjustPrice",a)},expression:"scope.row.adjustPrice"}})],1)],1):1==e.row.showUpdate&&0==e.row.checkStatus?a("div",{staticClass:"adjust-price"},[a("el-button-group",[a("el-input",{staticStyle:{width:"80px"},attrs:{size:"mini"},on:{blur:function(a){return t.deleteAdjustPrice(e.$index,!0)}},model:{value:e.row.updateAdjustPrice,callback:function(a){t.$set(e.row,"updateAdjustPrice",a)},expression:"scope.row.updateAdjustPrice"}})],1),t._v(" "),a("el-button-group",[a("el-button",{staticStyle:{width:"25px"},attrs:{icon:"el-icon-check",size:"mini"},on:{click:function(a){return t.sureAdjustPrice(e.row)}}}),t._v(" "),a("el-button",{staticStyle:{width:"25px"},attrs:{icon:"el-icon-close",size:"mini"},on:{click:function(a){return t.deleteAdjustPrice(e.$index)}}})],1)],1):a("div",[t._v(t._s(e.row.adjustPrice))])]}}])}),t._v(" "),a("el-table-column",{attrs:{"min-width":"80",prop:"checkStatus",formatter:t.checkStatusTreating,label:"审核状态"}}),t._v(" "),a("el-table-column",{attrs:{"min-width":"170",prop:"updateTime",label:"变更时间"}}),t._v(" "),a("el-table-column",{attrs:{"min-width":"170",prop:"checkTime",formatter:t.nullTreating,label:"审核时间"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",fixed:"right",label:"操作",width:"110"},scopedSlots:t._u([{key:"default",fn:function(e){return[0==e.row.checkStatus?a("el-button",{attrs:{icon:"el-icon-circle-check-outline",size:"mini"},on:{click:function(a){return t.auditOne(e.row)}}},[t._v("审核")]):t._e()]}}])})],1),t._v(" "),a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:t.tableData.length>0,expression:"tableData.length>0"}],staticClass:"tc mt20",attrs:{background:"","current-page":t.pageNum,"page-sizes":[20,50,100,150,200],layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.changeSize,"current-change":t.changeCurrent,"update:currentPage":function(e){t.pageNum=e},"update:current-page":function(e){t.pageNum=e}}})],1),t._v(" "),a("el-dialog",{attrs:{title:"提示",visible:t.auditDialogVisible,width:"30%"},on:{"update:visible":function(e){t.auditDialogVisible=e}}},[a("span",[t._v("确认审核已选择的商品吗？")]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"mini"},on:{click:function(e){t.auditDialogVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.sureAudit}},[t._v("确 定")])],1)]),t._v(" "),a("el-dialog",{attrs:{title:"获取区域进价成本失败的SKU",visible:t.isShowFailList,width:"740px"},on:{"update:visible":function(e){t.isShowFailList=e}}},[a("fail-list",{ref:"FailList"}),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){t.isShowFailList=!1}}},[t._v("关 闭")])],1)],1)],1)},staticRenderFns:[]};var C=a("VU/8")(y,k,!1,function(t){a("Q0wW")},null,null);e.default=C.exports},Q0wW:function(t,e){}});
//# sourceMappingURL=71.86570fab0319a978f006.js.map