webpackJsonp([120],{"4Cjw":function(t,e){},"53t5":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("BO1k"),i=a.n(n),r=a("Dd8w"),l=a.n(r),o=a("ylbZ"),s=a("ssT3"),c=(a("oAV5"),a("bzuE")),u="/plateform/a/preSale/activity/listPage",p="/plateform/a/preSale/activity/delActivity",d="/plateform/a/preSale/activity/failActivity",h="/plateform/a/preSale/activity/publishActivity",v={data:function(){return{pageSizes:c.a.pageSizes10,loading:!1,pageNum:1,pageSize:10,total:0,cityOptions:[],searchContent:{DIFFCITY:!0,regionCode:s.a.get("regionCode")||"",activitySearchVal:"",presaleType:"",cycleType:"",startDate:"",endDate:"",activityStatus:""},cycleTypeOptions:[{label:"全部",value:""},{label:"短周期",value:1},{label:"长周期",value:2}],presaleTypeOptions:[{label:"全部",value:""},{label:"单期",value:1},{label:"周期",value:2}],statusOptions:[{label:"全部",value:""},{label:"进行中",value:3},{label:"未发布",value:0},{label:"未开始",value:2},{label:"已结束",value:4},{label:"已终止",value:5}],tableData:[]}},mounted:function(){var t=s.a.get("searchContent");this.$route.meta.keepAlive&&t&&(this.pageNum=t.pageNum,this.searchContent=t.searchContent),s.a.remove("searchContent"),this.doSearchHandel()},components:{region:o.a},methods:{RegionChange:function(t){this.searchContent.regionCode=t.regionCode,this.doSearchHandel(!0)},goAddGoodsPage:function(){this.$router.push("/pre_act/add")},activityStatusFormatter:function(t,e,a,n){return 0===a?"未发布":1==a?"已发布":2==a?"未开始[发布中]":3==a?"进行中[发布中]":4==a?11===t.activityType?"已结束[发布中]":"已结束":5==a?"已终止":6==a?"已失效":void 0},changeSize:function(t){this.pageSize=t,this.doSearchHandel()},changeCurrent:function(t){this.pageNum=t,this.doSearchHandel()},doSearchHandel:function(t){var e=this;!0===t&&(this.pageNum=1),this.loading=!0,this.$http.post(u,l()({},this.searchContent,{pageNum:this.pageNum,pageSize:this.pageSize})).then(function(t){if(e.loading=!1,0!==t.code)throw new Error(t.msg);if(t.data){if(t.data.result&&t.data.result.length){var a=!0,n=!1,r=void 0;try{for(var l,o=i()(t.data.result);!(a=(l=o.next()).done);a=!0){var s=l.value;s.redirectUrl="/pre_goods?id="+s.id}}catch(t){n=!0,r=t}finally{try{!a&&o.return&&o.return()}finally{if(n)throw r}}e.tableData=t.data.result}else e.tableData=[];e.total=t.data.total}else e.total=0,e.tableData=[]}).catch(function(t){e.loading=!1,e.$notify.error({title:"提示",message:t.message})})},deleteItem:function(t){var e=this,a=t.id;this.$confirm("您确认删除当前未发布的活动吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$http.post(p,{activityId:a,DIFFCITY:!0}).then(function(t){if(0===t.code)return e.$message.success("删除成功"),void e.doSearchHandel();throw new Error(t.msg)}).catch(function(t){e.$notify.error({title:"提示",message:t.message})})}).catch(function(){})},publishActivityHandel:function(t){var e=this,a=t.id;this.$confirm("您确定要执行发布操作吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$http.post(h,{activityId:a,DIFFCITY:!0}).then(function(t){if(0===t.code)return e.$message.success("发布成功"),void e.doSearchHandel();throw new Error(t.msg)}).catch(function(t){e.$notify.error({title:"提示",message:t.message})})}).catch(function(){})},copyItem:function(t){var e={pageNum:this.pageNum,searchContent:this.searchContent};s.a.set("searchContent",e),this.$router.push("/pre_act/edit/"+t.id+"/copy")},activeOver:function(t){var e=this,a=t.id;this.$confirm("您确定要执行试下操作吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$http.post(d,{activityId:a,DIFFCITY:!0}).then(function(t){if(0===t.code)return e.$message.success("设置失效成功"),void e.doSearchHandel();throw new Error(t.msg)}).catch(function(t){e.$notify.error({title:"提示",message:t.message})})}).catch(function(){})},editItem:function(t){var e={pageNum:this.pageNum,searchContent:this.searchContent};s.a.set("searchContent",e),this.$router.push("/pre_act/edit/"+t.id+"/edit?status="+t.activityStatus)},showItem:function(t){var e={pageNum:this.pageNum,searchContent:this.searchContent};s.a.set("searchContent",e);var a=t.id;this.$router.push("/pre_act/show/"+a)}},beforeRouteLeave:function(t,e,a){e.meta.keepAlive=!1,a()}},m={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"handel-search-wraper"},[a("div",{staticClass:"handel-wraper"},[a("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-plus"},on:{click:t.goAddGoodsPage}},[t._v("添加预售活动")])],1),t._v(" "),a("hr",{staticClass:"s-slip"}),t._v(" "),a("div",{staticClass:"search-form-wraper"},[a("el-form",{attrs:{model:t.searchContent,"label-position":"top"}},[a("region",{staticClass:"region-wrap",attrs:{refresh:!1},on:{RegionChange:t.RegionChange}}),t._v(" "),a("el-form-item",{attrs:{label:"活动ID/名称"}},[a("el-input",{staticClass:"search-input",attrs:{placeholder:"活动ID/名称",size:"small",clearable:""},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.doSearchHandel(!0)}},model:{value:t.searchContent.activitySearchVal,callback:function(e){t.$set(t.searchContent,"activitySearchVal","string"==typeof e?e.trim():e)},expression:"searchContent.activitySearchVal"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"SKU编码/商品名称"}},[a("el-input",{staticClass:"search-input",attrs:{placeholder:"SKU编码/商品名称",size:"small",clearable:""},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.doSearchHandel(!0)}},model:{value:t.searchContent.goodsInfo,callback:function(e){t.$set(t.searchContent,"goodsInfo","string"==typeof e?e.trim():e)},expression:"searchContent.goodsInfo"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"预售类型"}},[a("el-select",{staticClass:"search-input",attrs:{filterable:"",placeholder:"请选择预售类型",size:"small",clearable:""},on:{change:function(e){return t.doSearchHandel(!0)}},model:{value:t.searchContent.presaleType,callback:function(e){t.$set(t.searchContent,"presaleType",e)},expression:"searchContent.presaleType"}},t._l(t.presaleTypeOptions,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"周期类型"}},[a("el-select",{staticClass:"search-input",attrs:{filterable:"",placeholder:"请选择周期类型",size:"small",clearable:""},on:{change:function(e){return t.doSearchHandel(!0)}},model:{value:t.searchContent.cycleType,callback:function(e){t.$set(t.searchContent,"cycleType",e)},expression:"searchContent.cycleType"}},t._l(t.cycleTypeOptions,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"开始时间"}},[a("el-date-picker",{staticClass:"search-input",attrs:{type:"datetime",placeholder:"请选择开始时间",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss",size:"small"},on:{change:function(e){return t.doSearchHandel(!0)}},model:{value:t.searchContent.startDate,callback:function(e){t.$set(t.searchContent,"startDate",e)},expression:"searchContent.startDate"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"结束时间"}},[a("el-date-picker",{staticClass:"search-input",attrs:{type:"datetime",placeholder:"请选择结束时间",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss",size:"small"},on:{change:function(e){return t.doSearchHandel(!0)}},model:{value:t.searchContent.endDate,callback:function(e){t.$set(t.searchContent,"endDate",e)},expression:"searchContent.endDate"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"状态"}},[a("el-select",{staticClass:"search-input",attrs:{filterable:"",placeholder:"请选择状态",clearable:"",size:"small"},on:{change:function(e){return t.doSearchHandel(!0)}},model:{value:t.searchContent.activityStatus,callback:function(e){t.$set(t.searchContent,"activityStatus",e)},expression:"searchContent.activityStatus"}},t._l(t.statusOptions,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.doSearchHandel(!0)}}},[t._v("搜索")])],1)],1)],1)]),t._v(" "),a("div",{staticClass:"table-wraper"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.tableData,"empty-text":"没有查询到您想要的数据",size:"small"}},[a("el-table-column",{attrs:{"min-width":"70px",prop:"id",label:"活动ID"}}),t._v(" "),a("el-table-column",{attrs:{"min-width":"120px",prop:"activityName",label:"预售活动名称"}}),t._v(" "),a("el-table-column",{attrs:{"min-width":"90px",prop:"presaleTypeName",label:"预售类型"}}),t._v(" "),a("el-table-column",{attrs:{"min-width":"90px",prop:"regionName",label:"活动区域"}}),t._v(" "),a("el-table-column",{attrs:{"min-width":"90px",prop:"cycleTypeName",label:"周期类型"}}),t._v(" "),a("el-table-column",{attrs:{"min-width":"210px",label:"有效期"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.activityStartDate&&e.row.activityEndDate?a("div",{staticClass:"date-wrap-inline"},[a("div",[a("p",[t._v(t._s(e.row.activityStartDate.substr(0,10)))]),t._v(" "),a("p",[t._v(t._s(e.row.activityStartDate.substr(11,8)))])]),t._v(" "),a("div",[t._v(" - ")]),t._v(" "),a("div",[a("p",[t._v(t._s(e.row.activityEndDate.substr(0,10)))]),t._v(" "),a("p",[t._v(t._s(e.row.activityEndDate.substr(11,8)))])])]):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{"min-width":"130px",label:"截单时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[t._v("\n            "+t._s(e.row.cutoffTypeName)+" "+t._s(e.row.cutoffTime)+"\n          ")])]}}])}),t._v(" "),a("el-table-column",{attrs:{"min-width":"110px",prop:"pickUpDate",label:"提货日期"}}),t._v(" "),a("el-table-column",{attrs:{"min-width":"100px",label:"预售商品数"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("p",{staticClass:"order-id"},[a("router-link",{attrs:{to:e.row.redirectUrl,target:"_blank"}},[t._v(t._s(e.row.goodsNum))])],1)]}}])}),t._v(" "),a("el-table-column",{attrs:{"min-width":"120px",prop:"activityStatus",label:"状态",formatter:t.activityStatusFormatter}}),t._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"140"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[a("div",[0===e.row.activityStatus?a("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-delete"},on:{click:function(a){return t.deleteItem(e.row)}}},[t._v("删除")]):a("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-view"},on:{click:function(a){return t.showItem(e.row)}}},[t._v("查看")]),t._v(" "),a("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-document-copy"},on:{click:function(a){return t.copyItem(e.row)}}},[t._v("复制")])],1),t._v(" "),a("div",[0===e.row.activityStatus||2===e.row.activityStatus||3===e.row.activityStatus?a("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-edit"},on:{click:function(a){return t.editItem(e.row)}}},[t._v("编辑")]):t._e(),t._v(" "),0===e.row.activityStatus?a("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-upload2"},on:{click:function(a){return t.publishActivityHandel(e.row)}}},[t._v("发布")]):t._e(),t._v(" "),3===e.row.activityStatus||2===e.row.activityStatus?a("el-button",{attrs:{size:"mini",icon:"el-icon-warning",type:"text"},on:{click:function(a){return t.activeOver(e.row)}}},[t._v("终止")]):t._e()],1)])]}}])})],1),t._v(" "),t.total>0?a("el-pagination",{staticClass:"tc mt20",attrs:{background:"","current-page":t.pageNum,"page-sizes":t.pageSizes,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.changeSize,"current-change":t.changeCurrent,"update:currentPage":function(e){t.pageNum=e},"update:current-page":function(e){t.pageNum=e}}}):t._e()],1)])},staticRenderFns:[]};var f=a("VU/8")(v,m,!1,function(t){a("4Cjw")},null,null);e.default=f.exports}});
//# sourceMappingURL=120.da1b63fbd0a679fb733c.js.map