webpackJsonp([19],{D9Cj:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("Gu7T"),s=a.n(i),n=a("Dd8w"),o=a.n(n),l=a("pytL"),r=a("t0/o"),c={timeOptions:[{label:"审核日期",value:0},{label:"制单日期",value:1}],paperStatusOptions:[{label:"全部",value:""},{label:"已审核",value:2}],paperTypeOptions:[{label:"全部",value:""},{label:"直送退货单",value:9},{label:"代发退货单",value:25}],checkingStatusOptions:[{label:"全部",value:""},{label:"未对账",value:0},{label:"供应商已对账",value:2},{label:"已完成对账",value:6},{label:"已结算",value:14}],checkingTypeOptions:[{label:"全部",value:""},{label:"购销",value:1},{label:"代营",value:9},{label:"联营",value:2},{label:"代销",value:4}],exportConfig:{paperNo:"退货单号",storeName:"门店",vendorName:"供应商",totalQty:"退货数量",totalAmount:"含税金额",totalNetAmount:"未税金额",status:"单据状态",typeName:"单据类型",tradeModeValue:"结算方式",reconciliationFlagName:"对账状态",createTime:"制单时间",confirmTime:"审核时间"}},d=(a("ssT3"),a("Zdr1")),u=a("WorT"),p=a("oAV5"),h=a("8uth"),m={mixins:[u.a],components:{"choose-store":d.a},data:function(){return{loading:!1,userPermission:[],moduleId:"/refundMgt",timeOptions:c.timeOptions,paperStatusOptions:c.paperStatusOptions,paperTypeOptions:c.paperTypeOptions,checkingStatusOptions:c.checkingStatusOptions,checkingTypeOptions:c.checkingTypeOptions,timeType:0,startDatetime:Object(p.b)("yyyy-MM-dd",Date.parse(new Date)-6048e5),endDatetime:Object(p.b)("yyyy-MM-dd",Date.parse(new Date)),startCreateDatetime:Object(p.b)("yyyy-MM-dd",Date.parse(new Date)-6048e5),endCreateDatetime:Object(p.b)("yyyy-MM-dd",Date.parse(new Date)),vendorNo:"",searchContent:{storeNames:"",listGoodsNo:"",listVendor:[]},productList:[],pageNum:1,pageSize:10,total:0,tableData:[],checkedList:[],columns:[{title:"退货单号",dataIndex:"paperNo",minWidth:160,ellipsis:!0},{title:"门店/仓库",dataIndex:"storeName",minWidth:120,ellipsis:!0},{title:"供应商",dataIndex:"vendorName",minWidth:100,ellipsis:!0},{title:"退货数量",dataIndex:"totalQty",minWidth:80,ellipsis:!0},{title:"含税金额",dataIndex:"totalAmount",minWidth:130,ellipsis:!0},{title:"单据状态",dataIndex:"statusName",minWidth:100,ellipsis:!0},{title:"单据类型",dataIndex:"typeName",minWidth:100,ellipsis:!0},{title:"结算方式",dataIndex:"tradeModeName",minWidth:80,ellipsis:!0},{title:"制单时间",dataIndex:"createTime",minWidth:100,ellipsis:!0},{title:"审核时间",dataIndex:"authDatetime",minWidth:100,ellipsis:!0},{fixed:"right",width:80,operation:[{label:"查看",icon:"el-icon-view",clickFunc:this.goDetailPage}]}],exportLoading:!1,checkedStoreList:[],regionOptions:[],exportConfig:c.exportConfig,sumAmount:0}},created:function(){this.getAreas(),this.doSearchHandle(!0),this.userPermission=this.$store.state.common.userPermissionMap[this.moduleId]},methods:{vendorSelectChange:function(e){this.pageNum=1,this.searchContent.listVendor=e?[e]:[],this.getProductByVendor(e)},storeSelectHandel:function(){var e={regionOptions:this.regionOptions,vendorNos:this.vendors,defaultChecked:this.checkedStoreList};this.$refs.chooseStore.setDefault(e)},doSearchHandle:function(e){var t=this;e&&(this.pageNum=1);var a=o()({},this.searchContent,{pageNum:this.pageNum,pageSize:this.pageSize});0===this.timeType?(a.startConfirmtime=this.startDatetime?this.startDatetime+" 00:00:00":"",a.endConfirmtime=this.endDatetime?this.endDatetime+" 23:59:59":""):1===this.timeType&&(a.startCreateTime=this.startCreateDatetime?this.startCreateDatetime+" 00:00:00":"",a.endCreateTime=this.endCreateDatetime?this.endCreateDatetime+" 23:59:59":""),this.loading=!0,this.$http.post(l.a.refundList,a).then(function(e){t.loading=!1,e&&0===e.code?(t.tableData=e.data&&e.data.result?e.data.result:[],t.total=e.data&&e.data.total,t.sumAmount=e&&e.data&&e.data.sumAmount?e.data.sumAmount:0):t.$tip.notify(e.msg,"error")}).catch(function(e){t.loading=!1,t.$tip.notify(e.message,"error")})},getProductByVendor:function(e){var t=this,a={vendorNo:e};if(!e)return this.productList=[],void(this.searchContent.listGoodsNo="");this.$http.post(l.a.queryVendorGoodsList,a).then(function(e){if(e&&0===e.code){var a=e.data&&e.data.result||[];a=a.map(function(e){return e.label=e.goodsNo+"-"+e.name,e}),t.productList=a}else t.$tip.notify(e.msg,"error")}).catch(function(e){t.$tip.notify(e.message,"error")})},selectionChangeHandel:function(e){var t=e.selection;this.checkedList=[].concat(s()(t))},doExortHandel:function(){if(this.checkedList&&this.checkedList.length){this.checkedList.map(function(e){return e.paperNo}).join(",");this.exportLoading=!0;var e=Object(p.i)(this.exportConfig,!1),t=Object(p.i)(this.exportConfig,!0);h.a.ExportJsonToExcel({header:e,filterVal:t,data:this.checkedList,filename:"仓库退货单"+Object(p.b)("yyyy-MM-dd",new Date)}),this.exportLoading=!1}else this.$tip.notify("请选择可导出数据","warning")},goDetailPage:function(e){this.$router.push("/refundMgt/"+e.paperNo+"/"+e.storeNo)},getAreas:function(){var e=this;this.$http.get(r.a.areaStoreGroupList).then(function(t){t&&0===t.code?e.regionOptions=t.data||[]:console.log(t.msg,"error")}).catch(function(e){console.log(e.message,"error")})},getSummaries:function(e){var t=this,a=e.columns,i=e.data,s=[];return a.forEach(function(e,a){if(0!==a){i.map(function(t){return Number(t[e.property])});"totalAmount"===e.property&&(s[a]=t.sumAmount+" 元")}else s[a]="合计"}),s},confirmHandle:function(e){this.checkedStoreList=e,this.searchContent.listStoreNo=e.map(function(e){return e.storeNo}),this.searchContent.storeNames=e.map(function(e){return e.storeName}).join(",")},changeSize:function(e){this.pageSize=e,this.doSearchHandle()},changeCurrent:function(e){this.pageNum=e,this.doSearchHandle()}}},f={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"handel-search-wraper"},[a("div",{staticClass:"search-form-wraper"},[a("el-form",{attrs:{model:e.searchContent,"label-position":"top"}},[a("el-form-item",{attrs:{label:"门店/仓库"}},[a("el-input",{staticClass:"search-input",attrs:{size:"small",placeholder:"门店/仓库",readonly:"",clearable:""},model:{value:e.searchContent.storeNames,callback:function(t){e.$set(e.searchContent,"storeNames","string"==typeof t?t.trim():t)},expression:"searchContent.storeNames"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.storeSelectHandel},slot:"append"})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"供应商"}},[a("el-select",{staticClass:"search-input",attrs:{placeholder:"选择供应商","collapse-tags":"",clearable:"",size:"small"},on:{change:e.vendorSelectChange},model:{value:e.vendorNo,callback:function(t){e.vendorNo=t},expression:"vendorNo"}},e._l(e.vendors,function(e){return a("el-option",{key:e.vendorNo,attrs:{label:e.vendorName,value:e.vendorNo}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"退货单号"}},[a("el-input",{staticClass:"search-input",attrs:{size:"small",placeholder:"请输入收货单号",clearable:""},model:{value:e.searchContent.paperNo,callback:function(t){e.$set(e.searchContent,"paperNo","string"==typeof t?t.trim():t)},expression:"searchContent.paperNo"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"商品"}},[a("el-select",{staticClass:"search-input",attrs:{filterable:"",placeholder:"请选择商品","collapse-tags":"",clearable:"",size:"small"},model:{value:e.searchContent.listGoodsNo,callback:function(t){e.$set(e.searchContent,"listGoodsNo",t)},expression:"searchContent.listGoodsNo"}},e._l(e.productList,function(e){return a("el-option",{key:e.goodsNo,attrs:{label:e.label,value:e.goodsNo}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"时间类型"}},[a("el-select",{staticClass:"search-input",attrs:{placeholder:"时间类型","collapse-tags":"",clearable:"",size:"small"},model:{value:e.timeType,callback:function(t){e.timeType=t},expression:"timeType"}},e._l(e.timeOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),0===e.timeType?a("el-form-item",{attrs:{label:"开始日期"}},[a("el-date-picker",{staticClass:"search-input",attrs:{clearable:"",type:"date",placeholder:"开始日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",size:"small"},model:{value:e.startDatetime,callback:function(t){e.startDatetime=t},expression:"startDatetime"}})],1):e._e(),e._v(" "),0===e.timeType?a("el-form-item",{attrs:{label:"结束日期"}},[a("el-date-picker",{staticClass:"search-input",attrs:{clearable:"",type:"date",placeholder:"结束日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",size:"small"},model:{value:e.endDatetime,callback:function(t){e.endDatetime=t},expression:"endDatetime"}})],1):e._e(),e._v(" "),1===e.timeType?a("el-form-item",{attrs:{label:"开始日期"}},[a("el-date-picker",{staticClass:"search-input",attrs:{clearable:"",type:"date",placeholder:"开始日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",size:"small"},model:{value:e.startCreateDatetime,callback:function(t){e.startCreateDatetime=t},expression:"startCreateDatetime"}})],1):e._e(),e._v(" "),1===e.timeType?a("el-form-item",{attrs:{label:"结束日期"}},[a("el-date-picker",{staticClass:"search-input",attrs:{clearable:"",type:"date",placeholder:"结束日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",size:"small"},model:{value:e.endCreateDatetime,callback:function(t){e.endCreateDatetime=t},expression:"endCreateDatetime"}})],1):e._e(),e._v(" "),a("el-form-item",{attrs:{label:"单据状态"}},[a("el-select",{staticClass:"search-input",attrs:{placeholder:"选择单据状态","collapse-tags":"",clearable:"",size:"small"},model:{value:e.searchContent.tag,callback:function(t){e.$set(e.searchContent,"tag",t)},expression:"searchContent.tag"}},e._l(e.paperStatusOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"单据类型"}},[a("el-select",{staticClass:"search-input",attrs:{placeholder:"单据类型","collapse-tags":"",clearable:"",size:"small"},model:{value:e.searchContent.orderType,callback:function(t){e.$set(e.searchContent,"orderType",t)},expression:"searchContent.orderType"}},e._l(e.paperTypeOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"结算方式"}},[a("el-select",{staticClass:"search-input",attrs:{placeholder:"结算方式","collapse-tags":"",clearable:"",size:"small"},model:{value:e.searchContent.tradeModeId,callback:function(t){e.$set(e.searchContent,"tradeModeId",t)},expression:"searchContent.tradeModeId"}},e._l(e.checkingTypeOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"mini",loading:e.loading},on:{click:function(t){return e.doSearchHandle(!0)}}},[e._v("搜索")])],1),e._v(" "),e.userPermission&&e.userPermission.includes("导出")?a("el-form-item",[a("el-button",{attrs:{disabled:0===e.checkedList.length,size:"mini",loading:e.exportLoading},on:{click:e.doExortHandel}},[e._v("导出")])],1):e._e()],1),e._v(" "),a("choose-store",{ref:"chooseStore",on:{confirm:e.confirmHandle}}),e._v(" "),a("div",{staticClass:"table-wraper"},[a("bl-table",{attrs:{loading:e.loading,border:!1,selection:!0,dataSource:e.tableData,columns:e.columns,getSummaries:e.getSummaries,showSummary:!(!e.tableData||!e.tableData.length)},on:{"selection-change":e.selectionChangeHandel}}),e._v(" "),a("bl-pagination",{attrs:{showPagination:e.tableData.length>0,pageNum:e.pageNum,total:e.total},on:{"size-change":e.changeSize,"current-change":e.changeCurrent}})],1)],1)])},staticRenderFns:[]},g=a("VU/8")(m,f,!1,null,null,null);t.default=g.exports},Zdr1:function(e,t,a){"use strict";var i=a("Dd8w"),s=a.n(i),n=a("Gu7T"),o=a.n(n),l=a("pytL"),r={data:function(){return{title:"选择门店",visible:!1,loading:!1,pageNum:1,pageSize:10,total:0,regionOptions:[],searchContent:{storeNo:"",storeName:"",regionCode:""},tableData:[],columns:[{title:"门店编码",dataIndex:"storeNo",minWidth:100},{title:"门店名称",dataIndex:"storeName",minWidth:130}],vendorNos:[],defaultChecked:[],checkedList:[]}},methods:{setDefault:function(e){this.visible=!0,this.regionOptions=e.regionOptions||[],this.vendorNos=e.vendorNos||[],this.defaultChecked=e.defaultChecked||[],this.doSearchHandle()},doSearchHandle:function(){var e=this;this.loading=!0,this.checkedList=[].concat(o()(this.defaultChecked)),this.$http.post(l.a.queryStoreBySv,s()({},this.searchContent,{pageNum:this.pageNum,pageSize:this.pageSize})).then(function(t){if(e.loading=!1,0===t.code)return e.tableData=t.data&&t.data.result&&t.data.result.length?t.data.result:[],void(e.total=t.data&&t.data.total);throw new Error(t.msg)}).catch(function(t){e.loading=!1,e.$tip.notify(t.message||"","error","系统提示")})},selectionChangeHandel:function(e){var t=e.selection;this.checkedList=[].concat(o()(t))},confirm:function(){this.visible=!1,this.$emit("confirm",this.checkedList)},changeSize:function(e){this.pageSize=e,this.doSearchHandle()},changeCurrent:function(e){this.pageNum=e,this.doSearchHandle()}}},c={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{"close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1,title:e.title,visible:e.visible,width:"800px"},on:{"update:visible":function(t){e.visible=t}}},[a("div",{staticClass:"search-form-wraper c-g-sfw"},[a("el-form",{attrs:{model:e.searchContent,"label-position":"top"},nativeOn:{submit:function(e){e.preventDefault()}}},[a("el-form-item",[a("el-select",{staticClass:"search-input",attrs:{placeholder:"选择区域","collapse-tags":"",size:"small"},model:{value:e.searchContent.regionCode,callback:function(t){e.$set(e.searchContent,"regionCode",t)},expression:"searchContent.regionCode"}},e._l(e.regionOptions,function(e){return a("el-option",{key:e.storeGroupNo,attrs:{label:e.storeGroupName,value:e.storeGroupNo}})}),1)],1),e._v(" "),a("el-form-item",[a("el-input",{staticClass:"search-input",attrs:{placeholder:"输入分店编码",size:"small",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.doSearchHandle(t)}},model:{value:e.searchContent.storeNo,callback:function(t){e.$set(e.searchContent,"storeNo","string"==typeof t?t.trim():t)},expression:"searchContent.storeNo"}})],1),e._v(" "),a("el-form-item",[a("el-input",{staticClass:"search-input",attrs:{placeholder:"输入分店名称",size:"small",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.doSearchHandle(t)}},model:{value:e.searchContent.storeName,callback:function(t){e.$set(e.searchContent,"storeName","string"==typeof t?t.trim():t)},expression:"searchContent.storeName"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.doSearchHandle}},[e._v("搜索")])],1)],1)],1),e._v(" "),a("div",[a("bl-table",{attrs:{loading:e.loading,border:!1,selection:!0,dataSource:e.tableData,columns:e.columns,maxHeight:330,defaultChecked:e.defaultChecked,uniqueStr:"id"},on:{"selection-change":e.selectionChangeHandel}}),e._v(" "),a("bl-pagination",{attrs:{showPagination:e.tableData.length>0,pageNum:e.pageNum,total:e.total},on:{"size-change":e.changeSize,"current-change":e.changeCurrent}})],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"mini"},on:{click:function(t){e.visible=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.confirm}},[e._v("确定")])],1)])},staticRenderFns:[]},d=a("VU/8")(r,c,!1,null,null,null);t.a=d.exports}});
//# sourceMappingURL=19.2173fe5190304d79cf6b.1615898974438.js.map